$(function(){$.ajax({type:"GET",url:"/category.json?categoryType=scene",dataType:"json",success:function(j){if(typeof(j.rows)!="undefined"){var a="<ul>";var d=j.rows.length;for(var k=0;k<d;k++){a+="<li>"+j.rows[k].categoryName+"</li>"}a+="</ul>";$(".leftBox .tab").append(a);var f=$(".leftBox .tab ul").width();$(".leftBox .tab ul li").css("width",(f-35)/d);$(".leftBox .tab ul li").eq(0).addClass("current");$(window).resize(function(){var i=$(".leftBox .tab ul").width();$(".leftBox .tab ul li").css("width",(i-35)/d)});if($("#Pagination").data("twbs-pagination")){$("#Pagination").twbsPagination("destroy")}for(var k=0;k<d;k++){var l='<div class="tabContent" style="display:none;">';var h=0;if(typeof(j.rows[k].subCategoryMap)!="undefined"){l+="<ul>";for(var b in j.rows[k].subCategoryMap){l+='<li><a href="#">'+b+"</a></li>";h++}l+="</ul>"}l+="</div>";$(".leftBox .tabCont").append(l);if($("#Pagination").data("twbs-pagination")){$("#Pagination").twbsPagination("destroy")}var o=$(".leftBox .tabCont .tabContent").eq(0).children("ul").children("li").eq(0).children("a").html();getCont(o);if(h){var p=$(".leftBox").width();$(".leftBox .tabCont .tabContent").eq(k).find("ul li").css("width",p*0.9/h);$(".leftBox .tabCont .tabContent").eq(k).find("ul li").eq(0).addClass("currentTabCont");$(".leftBox .tabCont .tabContent").eq(k).find("ul li").click(function(){$(this).addClass("currentTabCont");$(this).siblings().removeClass("currentTabCont");var i=$(this).find("a").html();$("#Pagination").empty();$("#Pagination").removeData("twbs-pagination");if($("#Pagination").data("twbs-pagination")){$("#Pagination").twbsPagination("destroy")}getCont(i)})}}$(window).resize(function(){var i=$(".leftBox").width();$(".leftBox .tabCont .tabContent ul li").css("width",i*0.95/4);$(".leftBox .tabCont .tabContent li").css("min-width",58)});$(".leftBox .tabCont .tabContent").css("display","none");$(".leftBox .tabCont .tabContent").eq(0).css("display","block");$(".leftBox .tab ul li").mouseover(function(){$(".leftBox .tab ul li").removeClass("active");$(this).addClass("active")});$(".leftBox .tab ul li").mouseout(function(){$(this).removeClass("active")});$(".leftBox .tab ul li").click(function(){$(".leftBox .tab ul li").removeClass("current");$(this).addClass("current");$(".leftBox .tabCont .tabContent").css("display","none");$(".leftBox .tabCont .tabContent").eq($(this).index()).css("display","block");var i=$(".leftBox .tabCont .tabContent").eq($(this).index()).children("ul").children("li").eq(0).children("a").html();if($("#Pagination").data("twbs-pagination")){$("#Pagination").twbsPagination("destroy")}getCont(i)})}},})});function getCont(a){var d=0;$.ajax({type:"GET",url:"/scene.json?tags="+a,dataType:"json",async:false,success:function(f){$("#total").val(f.total);d=f.total}});function b(h,f){$.ajax({type:"GET",url:"/scene.json?tags="+f+"&rows=9&page="+h,dataType:"json",async:false,beforeSend:function(i){$(".leftBox .body").empty().append('<img src="/theme/basic/images/loading.gif" class="loading"/>')},success:function(n){var m="";if(typeof(n.sceneList)!="undefined"){var i=n.sceneList.length;for(var l=0;l<i;l++){if(n.sceneList[l].coverUrl==undefined){m+='<div class="cont">'+n.sceneList[l].title+"</div>"}else{coverUrl="/static/documentFile/open/"+n.sceneList[l].coverUrl;m+='<image class="cont" src='+coverUrl+" title="+n.sceneList[l].title+"["+n.sceneList[l].sceneId+"]/>"}m+='<input type="hidden" value="">'}}$(".leftBox .body").empty().append(m);if(m){for(var l=0;l<i;l++){$(".cont").eq(l).val()}}var j=$(".leftBox").height();$(".leftBox .body .cont").css("height",(j-160)*0.33);$(".leftBox .body").css("height",j-140);if(typeof(n.sceneList)!="undefined"){var i=n.sceneList.length;$(".leftBox .body .cont").click(function(){var o=$(".leftBox .body .cont").index(this);if($("#nr").children().children().hasClass("editBg")||$(".editArea").has("li").length){swal({title:"您确定要覆盖原有数据么？",showCancelButton:true,cancelButtonText:"取消",closeOnConfirm:true,confirmButtonText:"确定",confirmButtonColor:"#428bca"},function(){$(".animModal").empty(),$(".animModal").hide(),$(".styleModal").hide(),$(".musicToggle").hide(),$("#audio_btn").hide(),changePhoneCont(n,o,0,0,""),closeBgToggle(),changePagination()})}else{$(".animModal").empty();$(".animModal").hide();$(".styleModal").hide();changePhoneCont(n,o,0,0,"");changePagination()}})}},})}$("#Pagination").twbsPagination({totalPages:parseInt(parseInt($("#total").val())/9)+1,visiblePages:3,first:"首页",prev:"上一页",next:"下一页",last:"尾页",onPageClick:function(f,h){b(h,a)}})}function changePhoneCont(T,I,R,P,O,M){var n="";if(P==0){if(T.sceneList[I].materialList!=undefined){var S=T.sceneList[I].materialList.length;$(".editArea").css("background","");$(".bgToggle").hide();$(".musicToggle").hide();for(G=0;G<S;G++){var q="";n+=addContByType(T.sceneList[I].materialList[G].materialType,q);if(T.sceneList[I].materialList[G].materialType=="background-image"){$(".editArea").css("background","url(/static/documentFile/open/"+T.sceneList[I].background+") top center no-repeat");$(".editArea").css("background",q+" top center 99.5% 100% no-repeat");$(".editArea").css("backgroundSize","99.5% 100%");$(".bgToggle").show()}}$(".editArea").empty().append('<div class="phoneContBg" style="position:absolute;width:100%;height:100%;z-index:1;opacity:0;"></div>').append(n);for(G=0;G<S;G++){if(T.sceneList[I].materialList[G].materialType=="image"){$(".editArea").children("li").eq(G).find(".elementBox").attr("src","/static/documentFile/open/"+T.sceneList[I].materialList[G].content);$("#nr .editWrapper .editArea").children("li").eq(G).attr("style",T.sceneList[I].materialList[G].css);$("#nr .editWrapper .editArea").children("li").eq(G).find(".elementBox").attr("style",T.sceneList[I].materialList[G].cssExt);$("#nr .editWrapper .editArea").children("li").eq(G).find("img").css("width","100%").css("height","100%");$(".editArea").children("li").eq(G).find(".materialId").html(T.sceneList[I].materialList[G].materialModelId)}else{if(T.sceneList[I].materialList[G].materialType=="music"){$(".editArea").children("li").eq(G).find("audio").attr("src","/static/documentFile/open/"+T.sceneList[I].materialList[G].content);$(".editArea").children("li").eq(G).find(".materialId").html(T.sceneList[I].materialList[G].materialModelId);$(".musicToggle").show();$("#audio_btn").show();if($(".editArea").children("li").eq(G).find("audio").attr("autoplay")=="autoplay"){$("#audio_btn").removeClass("off").addClass("play_yinfu");$("#yinfu").addClass("rotateMusic")}}else{if(T.sceneList[I].materialList[G].materialType=="video"){$(".editArea").children("li").eq(G).find("source").attr("src","/static/documentFile/open/"+T.sceneList[I].materialList[G].content);$(".editArea").children("li").eq(G).find(".materialId").html(T.sceneList[I].materialList[G].materialModelId)}else{if(T.sceneList[I].materialList[G].materialType=="collection"){var E=T.sceneList[I].materialList[G].content.split(",").length;var A="";for(var K=0;K<E;K++){A+='<li style="position:relative;"><a href=""><img src=""  data-description="" /></a></li>'}$(".editArea").children("li").eq(G).find(".html5zoo-slides").append(A);$("#nr .editWrapper .editArea").children("li").eq(G).attr("style",T.sceneList[I].materialList[G].css);$("#nr .editWrapper .editArea").children("li").eq(G).find(".elementBox").attr("style",T.sceneList[I].materialList[G].cssExt);$(".editArea").children("li").eq(G).find(".materialId").html(T.sceneList[I].materialList[G].materialModelId);$(".editArea").children("li").eq(G).append("");for(var K=0;K<E;K++){$(".editArea").children("li").eq(G).find(".html5zoo-slides li").eq(K).find("img").attr("src","/static/documentFile/open/"+T.sceneList[I].materialList[G].content.split(",")[K])}variousSlide($(".editArea").children("li").eq(G).attr("id"))}else{if(T.sceneList[I].materialList[G].materialType=="background-image"){$(".editArea").children("li").eq(G).find(".materialId").html(T.sceneList[I].materialList[G].materialModelId)}else{if(T.sceneList[I].materialList[G].materialType=="text"){$("#nr .editWrapper .editArea").children("li").eq(G).find(".elementBox").html(T.sceneList[I].materialList[G].content);$("#nr .editWrapper .editArea").children("li").eq(G).attr("style",T.sceneList[I].materialList[G].css);$("#nr .editWrapper .editArea").children("li").eq(G).find(".elementBox").attr("style",T.sceneList[I].materialList[G].cssExt);var L=$("#nr .editWrapper .editArea").children("li").eq(G).height();var x=$("#nr .editWrapper .editArea").children("li").eq(G).width();$("#nr .editWrapper .editArea").children("li").eq(G).find(".elementBox").css({"width":x,"height":L})}else{if(T.sceneList[I].materialList[G].materialType=="button"){$("#nr .editWrapper .editArea").children("li").eq(G).find("button").html(T.sceneList[I].materialList[G].content);$("#nr .editWrapper .editArea").children("li").eq(G).attr("style",T.sceneList[I].materialList[G].css);$("#nr .editWrapper .editArea").children("li").eq(G).find(".elementBox").attr("style",T.sceneList[I].materialList[G].cssExt);var L=$("#nr .editWrapper .editArea").children("li").eq(G).height();var x=$("#nr .editWrapper .editArea").children("li").eq(G).width();$("#nr .editWrapper .editArea").children("li").eq(G).find(".elementBox").css({"width":x,"height":L})}else{if(T.sceneList[I].materialList[G].materialType=="input"){var H=JSON.parse(T.sceneList[I].materialList[G].content);$("#nr .editWrapper .editArea").children("li").eq(G).find("input").attr("type",H.type);$("#nr .editWrapper .editArea").children("li").eq(G).find("input").attr("placeholder",H.placeholder);$("#nr .editWrapper .editArea").children("li").eq(G).attr("style",T.sceneList[I].materialList[G].css);$("#nr .editWrapper .editArea").children("li").eq(G).find(".elementBox").attr("style",T.sceneList[I].materialList[G].cssExt);var L=$("#nr .editWrapper .editArea").children("li").eq(G).height();var x=$("#nr .editWrapper .editArea").children("li").eq(G).width();$("#nr .editWrapper .editArea").children("li").eq(G).find(".elementBox").css({"width":x,"height":L})}else{}}}}}}}}}}else{$(".editArea").empty().append('<div class="phoneContBg" style="position:absolute;width:100%;height:100%;z-index:1;opacity:0;"></div>');$(".bgToggle").hide();$(".musicToggle").hide();$(".animModal").empty()}if(T.sceneList[I].materialList!=undefined){var S=T.sceneList[I].materialList.length;var C=writeAnimModal();for(var G=0;G<S;G++){rotate($("#nr .editWrapper .editArea").children("li").eq(G).find(".bar-rotate"));draggable($("#nr .editWrapper .editArea").children("li").eq(G).find(".draggable").get(0));resizeW($("#nr .editWrapper .editArea").children("li").eq(G).find(".bar-w").children(".bar-radius"));resizeE($("#nr .editWrapper .editArea").children("li").eq(G).find(".bar-e").children(".bar-radius"));resizeN($("#nr .editWrapper .editArea").children("li").eq(G).find(".bar-n").children(".bar-radius"));resizeS($("#nr .editWrapper .editArea").children("li").eq(G).find(".bar-s").children(".bar-radius"));$(".animModal").append(C);if(T.sceneList[I].materialList[G].animation!=undefined){R=JSON.parse(T.sceneList[I].materialList[G].animation).length}if(R>0){var r="";for(var J=0;J<R;J++){var v=J+1;r+="<li>动画-"+v+"</li>"}$(".animModal .animModalDrag").eq(G).find(".animTab").empty().append(r);var p="";for(var J=0;J<R;J++){var N=JSON.parse(T.sceneList[I].materialList[G].animation);p+="<li>";p+='<form action="" style="margin:auto 0;">';p+='<div class="form-item"><label for="time">动画持续:</label><input type="text" class="time" name="time" value="'+N[J].animationDuration+'" placeholder="请输入动画时间"/></div>';p+='<div class="form-item"><label for="delay">动画延迟:</label><input type="text" class="delay" name="delay" value="'+N[J].animationDelay+'" placeholder="请输入延迟时间"/></div>';p+='<div class="form-item"><label for="times">动画次数:</label><input type="text" class="times" name="times" value="'+N[J].animationIterationCount+'" placeholder="请输入动画次数"/></div>';p+='<div class="form-item"><label for="method">是否循环:</label><label><input name="animCircle" type="radio" value="infinite" />是 </label> <label><input name="animCircle" type="radio" value=""/>否 </label></div>';p+='<div class="form-item"><label for="method">动画方式:</label><label><input name="animMethod" type="radio" value="fadeIn" />淡入 </label> <label><input name="animMethod" type="radio" value="fadeInRight" />从右移入 </label> <label><input name="animMethod" type="radio" value="fadeInLeft" />从左移入 </label><label><input name="animMethod" type="radio" value="fadeInUp" />从下移入 </label><label><input name="animMethod" type="radio" value="fadeInDown" />从上移入 </label><label><input name="animMethod" type="radio" value="zoomIn" />中心放大</label><label><input name="animMethod" type="radio" value="wobble" />摇摆 </label><label style=""><input name="animMethod" type="radio" value="rotateIn" />旋转 </label><label><input name="animMethod" type="radio" value="swing" />悬摆 </label><label><input name="animMethod" type="radio" value="flipOutY" />翻转消失 </label><label><input name="animMethod" type="radio" value="fadeOut" />淡出 </label> <label><input name="animMethod" type="radio" value="none" />无 </label> </div>';p+="</form>";p+="</li>"}$(".animModal .animModalDrag").eq(G).find(".animCont").empty().append(p);for(var J=0;J<R;J++){if(N[J].animationIterationCount=="infinite"){$(".animModal .animModalDrag").eq(G).find(".animCont li").eq(J).find("input[name=animCircle]").eq(0).get(0).checked=true}else{$(".animModal .animModalDrag").eq(G).find(".animCont li").eq(J).find("input[name=animCircle]").eq(1).get(0).checked=true}var P=$(".animModal .animModalDrag").eq(G).find(".animCont li").eq(J).find("input[name=animMethod]").length;if(N[J].animationName!=undefined){for(var U=0;U<P;U++){if($(".animModal .animModalDrag").eq(G).find(".animCont").eq(J).find("input[name=animMethod]").eq(U).val()==N[J].animationName){$(".animModal .animModalDrag").eq(G).find(".animCont").eq(J).find("input[name=animMethod]").eq(U)[0].checked=true}}}}}draggable($(".animModal .modalHeader"))}}}else{var q="";n+=addContByType(R,q);if(R=="background-image"){var G=$("#nr .editWrapper .editArea").children("li").length;var u=true;for(var K=0;K<G;K++){if($(".editArea").children("li").eq(K).hasClass("background")){$(".editArea").css("background","url("+O+") top center no-repeat");$(".editArea").css("backgroundSize","99.5% 100%");$(".background .materialId").html(M);u=false}}if(u){$(".editArea").append(n);$(".editArea").css("background","url("+O+") top center no-repeat");$(".background .materialId").html(M);$(".editArea").css("backgroundSize","99.5% 100%");$(".bgToggle").show()}}else{if(R=="text"){$(".editArea").append(n);var G=$("#nr .editWrapper .editArea").children("li").length;$("#nr .editWrapper .editArea").children("li").eq(G-1).css({"width":80+"%","height":50,"left":10+"%","top":5+"%",});var L=$("#nr .editWrapper .editArea").children("li").eq(G-1).height();var x=$("#nr .editWrapper .editArea").children("li").eq(G-1).width();$("#nr .editWrapper .editArea").children("li").eq(G-1).find(".elementBox").css({"width":x,"height":L})}else{if(R=="image"){$(".editArea").append(n);var G=$("#nr .editWrapper .editArea").children("li").length;$("#nr .editWrapper .editArea").children("li").eq(G-1).find(".elementBox").attr("src",O);$(".materialId").html(M)}else{if(R=="video"){$(".editArea").append(n);var G=$("#nr .editWrapper .editArea").children("li").length;$("#nr .editWrapper .editArea").children("li").eq(G-1).find(".elementBox").children("source").attr("src",O);$("#nr .editWrapper .editArea").children("li").eq(G-1).find(".materialId").html(M)}else{if(R=="music"){var G=$("#nr .editWrapper .editArea").children("li").length;var Q=true;for(var K=0;K<G;K++){if($(".editArea").children("li").eq(K).hasClass("music")){$(".editArea").children("li").eq(K).find("audio").attr("src",O);$(".music .materialId").html(M);Q=false}}if(Q){$(".editArea").append(n);var G=$("#nr .editWrapper .editArea").children("li").length;$(".editArea").children("li").eq(G-1).find("audio").attr("src",O);$(".music .materialId").html(M);$(".musicToggle").show()}$("#audio_btn").show();if($(".editArea").children("li").eq(G-1).find("audio").attr("autoplay")=="autoplay"){$("#audio_btn").removeClass("off").addClass("play_yinfu");$("#yinfu").addClass("rotateMusic")}}else{if(R=="collection"){var G=$("#nr .editWrapper .editArea").children("li").length;var D=true;for(var K=0;K<G;K++){if($(".editArea").children("li").eq(K).hasClass("collection")){swal("对不起，一个页面只能创建一个图集！图集右键可以更改图片切换方式或删除原有图集！");D=false}}if(D){$(".editArea").append(n);var E=O.split(",").length;var A="";$(".collection .materialId").html(M);for(var K=0;K<E;K++){A+='<li style="position:relative;"><a href=""><img src=""  data-description="" /></a></li>'}$(".editArea").children("li").eq(G).find(".html5zoo-slides").append(A);$(".editArea").children("li").eq(G).append("");for(var K=0;K<E;K++){$(".editArea").children("li").eq(G).find(".html5zoo-slides li").eq(K).find("img").attr("src","/static/documentFile/open/"+O.split(",")[K])}variousSlide($(".editArea").children("li").eq(G).attr("id"))}}else{if(R=="input"){var o=O.parent().siblings().find("input[name='inputType']:checked").val();var s=O.parent().siblings().find(".inputName").val();if(o==undefined){$(".inputmsg").show()}else{if($(".inputModalType").html()=="-1"){$(".editArea").append(n);var G=$("#nr .editWrapper .editArea").children("li").length;$("#nr .editWrapper .editArea").children("li").eq(G-1).find("input").attr("type",o);$("#nr .editWrapper .editArea").children("li").eq(G-1).find("input").attr("placeholder",s);$("#nr .editWrapper .editArea").children("li").eq(G-1).css({"width":80+"%","height":50,"left":10+"%","top":5+"%",});var L=$("#nr .editWrapper .editArea").children("li").eq(G-1).height();var x=$("#nr .editWrapper .editArea").children("li").eq(G-1).width();$("#nr .editWrapper .editArea").children("li").eq(G-1).find(".elementBox").css({"width":x,"height":L});$(".inputModal").fadeOut(1000)}else{$("#nr .editWrapper .editArea").children("li").eq($(".inputModalType").html()).find("input").attr("type",o);$("#nr .editWrapper .editArea").children("li").eq($(".inputModalType").html()).find("input").attr("placeholder",s);$(".inputModal").fadeOut(1000);O.parent().siblings().find(".inputName").val("");O.parent().siblings().find("input[name='inputType']:checked").removeAttr("checked")}}}else{if(R=="button"){var V=O.parent().siblings().find(".buttonName").val();if(V==""){$(".buttonmsg").show()}else{if($(".buttonModalType").html()=="-1"){$(".editArea").append(n);var G=$("#nr .editWrapper .editArea").children("li").length;$("#nr .editWrapper .editArea").children("li").eq(G-1).find("button").html(V);$("#nr .editWrapper .editArea").children("li").eq(G-1).css({"width":"80%","height":50,"left":"10%","top":"5%",});var L=$("#nr .editWrapper .editArea").children("li").eq(G-1).height();var x=$("#nr .editWrapper .editArea").children("li").eq(G-1).width();$("#nr .editWrapper .editArea").children("li").eq(G-1).find(".elementBox").css({"width":x,"height":L});$(".buttonModal").fadeOut(1000)}else{$("#nr .editWrapper .editArea").children("li").eq($(".buttonModalType").html()).find("button").html(V);$(".buttonModal").fadeOut(1000)}}}}}}}}}}var G=$("#nr .editWrapper .editArea").children("li").length;for(var K=0;K<G;K++){rotate($("#nr .editWrapper .editArea").children("li").eq(K).find(".bar-rotate"));draggable($("#nr .editWrapper .editArea").children("li").eq(K).find(".draggable").get(0));resizeW($("#nr .editWrapper .editArea").children("li").eq(K).find(".bar-w").children(".bar-radius"));resizeE($("#nr .editWrapper .editArea").children("li").eq(K).find(".bar-e").children(".bar-radius"));resizeN($("#nr .editWrapper .editArea").children("li").eq(K).find(".bar-n").children(".bar-radius"));resizeS($("#nr .editWrapper .editArea").children("li").eq(K).find(".bar-s").children(".bar-radius"))}var C=writeAnimModal();$(".animModal").append(C);draggable($(".animModal .modalHeader"))}if($("#nr .editWrapper .editArea").children("li").length>0){var y=writeToolbar();$(".btn-toolbar").empty().append(y);$(".btn-toolbar").css("position","absolute");$(".btn-toolbar").css("z-index","99");var z=writePopMenu();$("#popMenu").empty().append(z);$("#popMenu").css("position","absolute");$("#popMenu").css("z-index","99");var F=writeStyleModal();$(".styleModal").empty().append(F);draggable($(".styleModal .modalHeader").get(0))}$("body").on("click","#nr .editWrapper .editArea li",function(){$(".bar").css("display","none");$(".bar").children(".bar-radius").css("display","none");$(this).find(".bar").css("display","block");$(this).find(".bar").children(".bar-radius").css("display","block");$("#popMenu").css("display","none")});$(".style").click(function(){var b=$(this).parent().find(".popIndex").html();var a={};if(parseFloat($(".editArea").children("li").eq(b).find(".elementBox").css("borderWidth"))==0||isNaN(parseFloat($(".editArea").children("li").eq(b).find(".elementBox").css("borderWidth")))){borderWidth=""}else{borderWidth=parseFloat($(".editArea").children("li").eq(b).find(".elementBox").css("borderWidth"))}if(parseFloat($(".editArea").children("li").eq(b).find(".elementBox").css("borderRadius"))==0||isNaN(parseFloat($(".editArea").children("li").eq(b).find(".elementBox").css("borderRadius")))){borderRadius=""}else{borderRadius=parseFloat($(".editArea").children("li").eq(b).find(".elementBox").css("borderRadius"))}a={borderWidth:borderWidth,borderStyle:$(".editArea").children("li").eq(b).find(".elementBox").css("borderStyle"),borderColor:$(".editArea").children("li").eq(b).find(".elementBox").css("borderColor"),borderRadius:borderRadius,backgroundColor:$(".editArea").children("li").eq(b).find(".elementBox").css("backgroundColor"),opacity:$(".editArea").children("li").eq(b).find(".elementBox").css("opacity"),};$(".styleModal").find("#opacity").val(a.opacity);$(".styleModal").find("#borderSize").val(a.borderWidth);$(".styleModal").find("#borderRadius").val(a.borderRadius);$(".styleModal").find("#borderColor").val(a.borderColor);$(".styleModal").find("#color").val(a.backgroundColor);$(".styleModal").find("#color").css("backgroundColor",a.backgroundColor);$(".styleModal").find("#borderColor").css("backgroundColor",a.borderColor);var f=$(".styleModal").find("input[name='borderStyle']");for(var d=0;d<f;d++){if($(".styleModal").find("input[name='borderStyle']").eq(d)==a.borderStyle){$(".styleModal").find("input[name='borderStyle']").eq(d)[0].checked=true}}$(".styleModal").fadeIn(1000);$(".dragIndex").html($(this).parent().find(".popIndex").html());$("#popMenu").hide();$(".animModal").hide();$(".bar").children(".bar-radius").css("display","none");$(".bar").css("display","none");$(".styleModal .submit").click(function(){$(".styleModal").fadeOut(1000)});$(".styleModal .modalFooter .cancel").click(function(){$(".editArea").children("li").eq(b).find(".elementBox").css("borderWidth",a.borderWidth),$(".editArea").children("li").eq(b).find(".elementBox").css("borderStyle",a.borderStyle),$(".editArea").children("li").eq(b).find(".elementBox").css("borderColor",a.borderColor),$(".editArea").children("li").eq(b).find(".elementBox").css("borderRadius",a.borderRadius),$(".editArea").children("li").eq(b).find(".elementBox").css("backgroundColor",a.backgroundColor),$(".editArea").children("li").eq(b).find(".elementBox").css("opacity",a.opacity),$(".styleModal").fadeOut(1000)});$(".styleModal .close").click(function(){$(".editArea").children("li").eq(b).find(".elementBox").css("borderWidth",a.borderWidth),$(".editArea").children("li").eq(b).find(".elementBox").css("borderStyle",a.borderStyle),$(".editArea").children("li").eq(b).find(".elementBox").css("borderColor",a.borderColor),$(".editArea").children("li").eq(b).find(".elementBox").css("borderRadius",a.borderRadius),$(".editArea").children("li").eq(b).find(".elementBox").css("backgroundColor",a.backgroundColor),$(".editArea").children("li").eq(b).find(".elementBox").css("opacity",a.opacity),$(".styleModal").fadeOut(1000)});if($("#picker").length>0){$("#picker").farbtastic(function(i){$("#color").val(i);$("#color").css("backgroundColor",i);$(".editArea").children("li").eq(b).find(".elementBox").css("backgroundColor",i);var h=rgbToHsl(i.colorRgb().split(",")[0],i.colorRgb().split(",")[1],i.colorRgb().split(",")[2])[2]>0.5?"#000":"#fff";$("#color").css("color",h)})}if($("#picker2").length>0){$("#picker2").farbtastic(function(i){$("#borderColor").val(i);$("#borderColor").css("backgroundColor",i);$(".editArea").children("li").eq(b).find(".elementBox").css("borderColor",i);var h=rgbToHsl(i.colorRgb().split(",")[0],i.colorRgb().split(",")[1],i.colorRgb().split(",")[2])[2]>0.5?"#000":"#fff";$("#borderColor").css("color",h)})}});$(".anim").click(function(){var b=$(this).parent().find(".popIndex").html();$(".animModal").fadeIn();$(".animModalDrag").css("display","none");$(".animModalDrag").eq(b).find(".animIndex").html(b);$(".animModalDrag").eq(b).fadeIn(1000);$("#popMenu").hide();$(".styleModal").hide();$(".bar").children(".bar-radius").css("display","none");$(".bar").css("display","none");var f=new Array();var a=$(".animModalDrag").eq(b).find(".animCont").length;for(var d=0;d<a;d++){if($(".animModalDrag").eq(b).find(".animCont").eq(d).find("input[name='animCircle']:checked").val()=="infinite"){animationIterationCount="infinite"}else{animationIterationCount=$(".animModalDrag").eq(b).find(".animCont").eq(d).find(".times").val()}f[d]={animationDuration:$(".animModalDrag").eq(b).find(".animCont").eq(d).find(".time").val(),animationDelay:$(".animModalDrag").eq(b).find(".animCont").eq(d).find(".delay").val(),animationName:$(".animModalDrag").eq(b).find(".animCont").eq(d).find("input[name='animMethod']:checked").val(),animationIterationCount:animationIterationCount,}}$("body").on("click",".animModal .modalFooter .cancel",function(){var w="";for(var k=0;k<a;k++){var h=k+1;w+="<li>动画-"+h+"</li>"}$(".animModal .animModalDrag").eq(G).find(".animTab").empty().append(w);var m="";for(var k=0;k<a;k++){m+="<li>";m+='<form action="" style="margin:auto 0;">';m+='<div class="form-item"><label for="time">动画持续:</label><input type="text" class="time" name="time" value="" placeholder="请输入动画时间"/></div>';m+='<div class="form-item"><label for="delay">动画延迟:</label><input type="text" class="delay" name="delay" value="" placeholder="请输入延迟时间"/></div>';m+='<div class="form-item"><label for="times">动画次数:</label><input type="text" class="times" name="times" value="" placeholder="请输入动画次数"/></div>';m+='<div class="form-item"><label for="method">是否循环:</label><label><input name="animCircle" type="radio" value="infinite" />是 </label> <label><input name="animCircle" type="radio" value="" />否 </label></div>';m+='<div class="form-item"><label for="method">动画方式:</label><label><input name="animMethod" type="radio" value="fadeIn" />淡入 </label> <label><input name="animMethod" type="radio" value="fadeInRight" />从右移入 </label> <label><input name="animMethod" type="radio" value="fadeInLeft" />从左移入 </label><label><input name="animMethod" type="radio" value="fadeInUp" />从下移入 </label><label><input name="animMethod" type="radio" value="fadeInDown" />从上移入 </label><label><input name="animMethod" type="radio" value="zoomIn" />中心放大</label><label><input name="animMethod" type="radio" value="wobble" />摇摆 </label><label style=""><input name="animMethod" type="radio" value="rotateIn" />旋转 </label><label><input name="animMethod" type="radio" value="swing" />悬摆 </label><label><input name="animMethod" type="radio" value="flipOutY" />翻转消失 </label><label><input name="animMethod" type="radio" value="fadeOut" />淡出 </label> <label><input name="animMethod" type="radio" value="none" />无 </label> </div>';m+="</form>";m+="</li>"}$(".animModal .animModalDrag").eq(b).find(".animCont").empty().append(m);for(var l=0;l<a;l++){$(".animModalDrag").eq(b).find(".animCont").eq(l).find(".time").val(f[l].animationDuration);$(".animModalDrag").eq(b).find(".animCont").eq(l).find(".delay").val(f[l].animationDelay);var W=$(".animModalDrag").eq(b).find(".animCont").eq(l).find("input[name='animMethod']").length;for(var k=0;k<W;k++){if($(".animModalDrag").eq(b).find(".animCont").eq(l).find("input[name='animMethod']").eq(k).val()==f[l].animationName){$(".animModalDrag").eq(b).find(".animCont").eq(l).find("input[name='animMethod']").eq(k)[0].checked=true}}if(f[l].animationIterationCount=="infinite"){$(".animModalDrag").eq(b).find(".animCont").eq(l).find("input[name='animCircle']").eq(0)[0].checked=true;$(".animModalDrag").eq(b).find(".animCont").eq(l).find(".times").val("")}else{$(".animModalDrag").eq(b).find(".animCont").eq(l).find(".times").val(f[l].animationIterationCount)}}$(".animModal").fadeOut(1000)});$("body").on("click",".animModal .modalFooter .submit",function(){$(".animModal").fadeOut(1000)});$("body").on("click",".animModal .close",function(){var w="";for(var k=0;k<a;k++){var h=k+1;w+="<li>动画-"+h+"</li>"}$(".animModal .animModalDrag").eq(G).find(".animTab").empty().append(w);var m="";for(var k=0;k<a;k++){m+="<li>";m+='<form action="" style="margin:auto 0;">';m+='<div class="form-item"><label for="time">动画持续:</label><input type="text" class="time" name="time" value="" placeholder="请输入动画时间"/></div>';m+='<div class="form-item"><label for="delay">动画延迟:</label><input type="text" class="delay" name="delay" value="" placeholder="请输入延迟时间"/></div>';m+='<div class="form-item"><label for="times">动画次数:</label><input type="text" class="times" name="times" value="" placeholder="请输入动画次数"/></div>';m+='<div class="form-item"><label for="method">是否循环:</label><label><input name="animCircle" type="radio" value="infinite" />是 </label> <label><input name="animCircle" type="radio" value=""  />否 </label></div>';m+='<div class="form-item"><label for="method">动画方式:</label><label><input name="animMethod" type="radio" value="fadeIn" />淡入 </label> <label><input name="animMethod" type="radio" value="fadeInRight" />从右移入 </label> <label><input name="animMethod" type="radio" value="fadeInLeft" />从左移入 </label><label><input name="animMethod" type="radio" value="fadeInUp" />从下移入 </label><label><input name="animMethod" type="radio" value="fadeInDown" />从上移入 </label><label><input name="animMethod" type="radio" value="zoomIn" />中心放大</label><label><input name="animMethod" type="radio" value="wobble" />摇摆 </label><label style=""><input name="animMethod" type="radio" value="rotateIn" />旋转 </label><label><input name="animMethod" type="radio" value="swing" />悬摆 </label><label><input name="animMethod" type="radio" value="flipOutY" />翻转消失 </label><label><input name="animMethod" type="radio" value="fadeOut" />淡出 </label> <label><input name="animMethod" type="radio" value="none" />无 </label> </div>';m+="</form>";m+="</li>"}$(".animModal .animModalDrag").eq(b).find(".animCont").empty().append(m);for(var l=0;l<a;l++){$(".animModalDrag").eq(b).find(".animCont").eq(l).find(".time").val(f[l].animationDuration);$(".animModalDrag").eq(b).find(".animCont").eq(l).find(".delay").val(f[l].animationDelay);var W=$(".animModalDrag").eq(b).find(".animCont").eq(l).find("input[name='animMethod']").length;for(var k=0;k<W;k++){if($(".animModalDrag").eq(b).find(".animCont").eq(l).find("input[name='animMethod']").eq(k).val()==f[l].animationName){$(".animModalDrag").eq(b).find(".animCont").eq(l).find("input[name='animMethod']").eq(k)[0].checked=true}}if(f[l].animationIterationCount=="infinite"){$(".animModalDrag").eq(b).find(".animCont").eq(l).find("input[name='animCircle']").eq(0)[0].checked=true;$(".animModalDrag").eq(b).find(".animCont").eq(l).find(".times").val("")}else{$(".animModalDrag").eq(b).find(".animCont").eq(l).find(".times").val(f[l].animationIterationCount)}}$(".animModal").fadeOut(1000)})});var B;$(".copy").click(function(){var b=$(this).parent().find(".popIndex").html();$("#nr .editWrapper .editArea").children("li").eq(b).clone(false).appendTo("#nr .editWrapper .editArea");$("#popMenu").hide();$(".animModalDrag").eq(b).clone(false).appendTo(".animModal");draggable($(".animModal .modalHeader"));B=$("#nr .editWrapper .editArea").children("li").length;var d=parseInt($("#nr .editWrapper .editArea").children("li").eq(B-1).css("top"));var a=parseInt($("#nr .editWrapper .editArea").children("li").eq(B-1).height());$("#nr .editWrapper .editArea").children("li").eq(B-1).css("top",d+a+5);rotate($("#nr .editWrapper .editArea").children("li").eq(B-1).find(".bar-rotate"));$(".animIndex").eq(B-1).html(B-1);draggable($("#nr .editWrapper .editArea").children("li").eq(B-1).children(".draggable").get(0));resizeW($("#nr .editWrapper .editArea").children("li").eq(B-1).find(".bar-w").children(".bar-radius"));resizeE($("#nr .editWrapper .editArea").children("li").eq(B-1).find(".bar-e").children(".bar-radius"));resizeN($("#nr .editWrapper .editArea").children("li").eq(B-1).find(".bar-n").children(".bar-radius"));resizeS($("#nr .editWrapper .editArea").children("li").eq(B-1).find(".bar-s").children(".bar-radius"))});$(".delete").click(function(){var a=$(this).parent().find(".popIndex").html();swal({title:"您确定要删除选中元素么？",showCancelButton:true,cancelButtonText:"取消",closeOnConfirm:true,confirmButtonText:"确定",confirmButtonColor:"#428bca",},function(){$("#nr .editWrapper .editArea").children("li").eq(a).remove(),$(".animModalDrag").eq(a).remove(),$("#popMenu").hide()});$("#popMenu").hide()});$("#color").on("input",function(){var a=$(".dragIndex").html();$("#nr .editWrapper .editArea").children("li").eq(a).find(".elementBox").css("background",$("#color").val());$("#color").css("background",$("#color").val())});$("#borderColor").on("input",function(){var a=$(".dragIndex").html();$("#nr .editWrapper .editArea").children("li").eq(a).find(".elementBox").css("borderColor",$("#borderColor").val());$("#borderColor").css("background",$("#borderColor").val())});$("input[name='borderStyle']").click(function(){var a=$(".dragIndex").html();$("#nr .editWrapper .editArea").children("li").eq(a).find(".elementBox").css("borderStyle",$(this).val());var b=parseInt($("#nr .editWrapper .editArea").children("li").eq(a).height());$("#nr .editWrapper .editArea").children("li").eq(a).find(".elementBox").css("height",b)});$("body").on("click","input[name='animMethod']",function(){var a=$(this).parents(".animModalDrag").index();$("#nr .editWrapper .editArea").children("li").eq(a).find(".elementBox").css("animation",""),$("#nr .editWrapper .editArea").children("li").eq(a).get(0).offsetWidth=$("#nr .editWrapper .editArea").children("li").eq(a).get(0).offsetWidth,$("#nr .editWrapper .editArea").children("li").eq(a).css("animation",$(this).val()+" "+$(this).parent().parent().siblings().find(".time").val()+"s ease "+$(this).parent().parent().siblings().find(".delay").val()+"s "+($(this).parent().parent().siblings().find(".times").val()?$(this).parent().parent().siblings().find(".times").val():""));if($(this).parent().parent().siblings().find("input[name='animCircle']:checked").val()=="infinite"){$("#nr .editWrapper .editArea").children("li").eq(a).css("animation-iteration-count","infinite")}});$("body").on("click",".seeAnim",function(){var f=$(this).parents(".animModalDrag").index();var b=$(this).siblings(".animCont").children("li").length;var d=$(this).siblings(".animCont").children("li");function h(a){if(a<b){S=d.eq(a).children().children("div");$("#nr .editWrapper .editArea").children("li").eq(f).find(".elementBox").css("animation",""),$("#nr .editWrapper .editArea").children("li").eq(f).get(0).offsetWidth=$("#nr .editWrapper .editArea").children("li").eq(f).get(0).offsetWidth,$("#nr .editWrapper .editArea").children("li").eq(f).find(".elementBox").css("animation",S.eq(4).find("input[name='animMethod']:checked").val()+" "+S.eq(0).find(".time").val()+"s ease "+S.eq(1).find(".delay").val()+"s "+S.eq(2).find(".times").val()).css("animation-fill-mode","backwards");if(S.eq(3).find("input[name='animCircle']:checked").val()=="infinite"){$("#nr .editWrapper .editArea").children("li").eq(f).find(".elementBox").css("animation-iteration-count","infinite")}$("#nr .editWrapper .editArea").children("li").eq(f).find(".elementBox").one("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",function(){a++,h(a)})}}h(0)});$(".addAnim").click(function(){$(this).siblings(".animTab").find("li").removeClass("current");$(this).siblings(".animCont").find("li").hide();var a=$(this).siblings(".animTab").find("li").length+1;$(this).siblings(".animTab").append('<li class="current">动画-'+a+"</li>");var b="<li>";b+='<form action="" style="margin:auto 0;">';b+='<div class="form-item"><label for="time">动画持续:</label><input type="text" class="time" name="time" value="" placeholder="请输入动画时间"/></div>';b+='<div class="form-item"><label for="delay">动画延迟:</label><input type="text" class="delay" name="delay" value="" placeholder="请输入延迟时间"/></div>';b+='<div class="form-item"><label for="times">动画次数:</label><input type="text" class="times" name="times" value="" placeholder="请输入动画次数"/></div>';b+='<div class="form-item"><label for="method">是否循环:</label><label><input name="animCircle" type="radio" value="infinite" />是 </label> <label><input name="animCircle" type="radio" value=""/>否 </label></div>';b+='<div class="form-item"><label for="method">动画方式:</label><label><input name="animMethod" type="radio" value="fadeIn" />淡入 </label> <label><input name="animMethod" type="radio" value="fadeInRight" />从右移入 </label> <label><input name="animMethod" type="radio" value="fadeInLeft" />从左移入 </label><label><input name="animMethod" type="radio" value="fadeInUp" />从下移入 </label><label><input name="animMethod" type="radio" value="fadeInDown" />从上移入 </label><label><input name="animMethod" type="radio" value="zoomIn" />中心放大</label><label><input name="animMethod" type="radio" value="wobble" />摇摆 </label><label style=""><input name="animMethod" type="radio" value="rotateIn" />旋转 </label><label><input name="animMethod" type="radio" value="swing" />悬摆 </label><label><input name="animMethod" type="radio" value="flipOutY" />翻转消失 </label><label><input name="animMethod" type="radio" value="fadeOut" />淡出 </label> <label><input name="animMethod" type="radio" value="none" />无 </label> </div>';b+="</form>";b+="</li>";$(this).siblings(".animCont").append(b)});$("body").on("click",".animTab li",function(){$(".animTab li").removeClass("current");$(".animCont li").css("display","none");var a=$(this).parent().parent().siblings(".animIndex").html();var b=$(".animModalDrag").eq(a).find(".modalBody .animTab li").index(this);$(this).addClass("current");$(".animModalDrag").eq(a).find(".modalBody .animCont li").eq(b).css("display","block")});$(".bgColor").click(function(){$("#picker").toggleClass("block");$("#picker2").removeClass("block");var a=$(".dragIndex").html();$("#nr .editWrapper .editArea").children("li").eq(a).find(".elementBox").css("background",$("#color").val())});$(".borderColorBtn").click(function(){$("#picker").removeClass("block");$("#picker2").toggleClass("block");var a=$(".dragIndex").html();$("#nr .editWrapper .editArea").children("li").eq(a).find(".elementBox").css("borderColor",$("#borderColor").val())});$("#borderSize").on("input",function(){var a=$(".dragIndex").html();$("#nr .editWrapper .editArea").children("li").eq(a).find(".elementBox").css("borderWidth",$("#borderSize").val());var b=parseInt($("#nr .editWrapper .editArea").children("li").eq(a).height());$("#nr .editWrapper .editArea").children("li").eq(a).find(".elementBox").css("height",b)});$("#borderRadius").on("input",function(){var a=$(".dragIndex").html();$("#nr .editWrapper .editArea").children("li").eq(a).find(".elementBox").css("borderRadius",$("#borderRadius").val()+"px");var b=parseInt($("#nr .editWrapper .editArea").children("li").eq(a).height());$("#nr .editWrapper .editArea").children("li").eq(a).find(".elementBox").css("height",b)});$("#opacity").on("input",function(){var a=$(".dragIndex").html();$("#nr .editWrapper .editArea").children("li").eq(a).find(".elementBox").css("opacity",$("#opacity").val())});$("#nr .editWrapper .editArea").children("li").resize(function(){if(window.getSelection){window.getSelection().removeAllRanges()}else{if(document.selection){document.selection.empty()}}});$("body").on("click","#nr .editWrapper .editArea li",function(){var a=$(this).index()-1;$(".dragIndex").html(a);$(".animModalDrag").css("display","none");$(".animModalDrag").eq(a).css("display","block");$(".inputModalType").html(a);$(".buttonModalType").html(a)});$("body").on("click","#popMenu .edit",function(){var f=$(this).parent().children(".popIndex").html();if($("#nr .editWrapper .editArea").children("li").eq(f).hasClass("text")){$("#nr .editWrapper .editArea").children("li").eq(f).children(".draggable").children(".elementBox").attr("contenteditable","true");$("#nr .editWrapper .editArea").children("li").eq(f).children(".draggable").children(".elementBox").attr("id","editor");$("#nr .editWrapper .editArea").children("li").eq(f).children(".draggable").children(".elementBox").css("cursor","text");if(typeof userSelect==="string"){return document.documentElement.style[userSelect]="text"}document.unselectable="off";document.onselectstart=null;e=parseInt($("#nr .editWrapper .editArea").children("li").eq(f).css("top"));O=$(".editArea").width();M=parseInt($(".editArea").offset().left);$(".btn-toolbar").css("display","block");$(".btn-toolbar").css("top",e-90);$(".btn-toolbar").css("background","#fff");$(".btn-toolbar").css("box-shadow","+0 1px 2px rgba(0,0,0,.5)+");$(".btn-toolbar").css("left",0);$(".btn-toolbar").css("width",O);$("#nr .editWrapper .editArea").children("li").eq(f).children().children(".elementBox").wysiwyg();var l=$("#nr .editWrapper .editArea").children("li").eq(f).find(".elementBox").height();var a=$("#nr .editWrapper .editArea").children("li").eq(f).find(".elementBox").width();$("#nr .editWrapper .editArea").children("li").eq(f).css({"width":a,"height":l});$("#nr .editWrapper .editArea").children("li").eq(f).children().children(".elementBox").focus();$("#popMenu").css("display","none")}else{if($("#nr .editWrapper .editArea").children("li").eq(f).hasClass("input")){var k=$("#nr .editWrapper .editArea").children("li").eq(f).find("input").attr("type");var m=$("#nr .editWrapper .editArea").children("li").eq(f).find("input").attr("placeholder");$(".inputModal .inputModalType").html(f);for(var d=0;d<2;d++){if($(".inputModal").find("input[name='inputType']").eq(d).val()==k){$(".inputModal").find("input[name='inputType']").eq(d)[0].checked=true}}$(".inputModal").find(".inputName").val(m);$(".inputmsg").hide();$(".inputModal").fadeIn(1000);draggable($(".inputModal .modalHeader"));$("#popMenu").css("display","none")}else{if($("#nr .editWrapper .editArea").children("li").eq(f).hasClass("button")){var b=$("#nr .editWrapper .editArea").children("li").eq(f).find("button").html();$(".buttonModal .buttonModalType").html(f);$(".buttonModal").find(".buttonName").val(b);$(".buttonmsg").hide();$(".buttonModal").fadeIn(1000);draggable($(".buttonModal .modalHeader"));$("#popMenu").css("display","none")}else{if($("#nr .editWrapper .editArea").children("li").eq(f).attr("ctype")=="collection"){$(".collectionModal .collectionModalType").html(f);$(".collectionModal").fadeIn(1000);draggable($(".collectionModal .modalHeader"));$("#popMenu").css("display","none")}}}}});$("body").on("mousedown","#nr .editWrapper .editArea li",function(b){if(b.which==null&&(b.charCode!=null||b.keyCode!=null)){b.which=b.charCode!=null?b.charCode:b.keyCode}G=$(".editWrapper").offset().left;t=$(".editWrapper").offset().top;if(b.which==3){if($(this).children(".draggable").children(".elementBox").attr("contenteditable")!="true"){$("#popMenu").css("display","block");$("#popMenu").css("top",b.pageY-t);$("#popMenu").css("left",b.pageX-G);if($(this).attr("ctype")=="image"){$("#popMenu .edit").hide()}else{$("#popMenu .edit").show()}if($(this).attr("ctype")=="collection"){$("#popMenu .copy").hide()}else{$("#popMenu .copy").show()}var a=$(this).index()-1;$("#popMenu .popIndex").html(a)}$(this).bind("contextmenu",function(d){if($(this).children(".draggable").children(".elementBox").attr("contenteditable")!="true"){return false}else{return true}})}});$(window).resize(function(){O=$(".editArea").width();$(".btn-toolbar").css("width",O)});$("#nr .editWrapper .editArea .phoneContBg").click(function(){$("#nr .editWrapper .editArea li .bar").css("display","none");$(".btn-toolbar").css("display","none");$("#nr .editWrapper .editArea li .bar .bar-radius").css("display","none");$(".elementBox").attr("contenteditable","false");$(".elementBox").attr("id","");$("#popMenu").css("display","none")})}function draggable(d){var b=false;var i,h;var j,f;$(d).mousedown(function(a){if(a.which==1){if($(d).children(".elementBox").attr("contenteditable")!="true"||$(d).children(".elementBox").attr("ctype")=="image"){b=true;if(window.getSelection){window.getSelection().removeAllRanges()}else{if(document.selection){document.selection.empty()}}document.onselectstart=function(){return false}}if($(d).siblings(".bar").length&&$(d).siblings().children(".bar-radius").length!=0){$(".bar").hide();$(".bar").children(".bar-radius").hide();$(d).siblings(".bar").css("display","block");$(d).siblings().children(".bar-radius").css("display","block");i=a.pageX-parseInt($(d).parent().position().left);h=a.pageY-parseInt($(d).parent().position().top)}else{i=a.pageX-$(d).parent().parent().offset().left+$("body").scrollLeft();h=a.pageY-$(d).parent().parent().offset().top+$("body").scrollTop();j=$("body").scrollLeft();f=$("body").scrollTop()}}});$(document).mousemove(function(n){if(b){var q=n.pageX-i;var o=n.pageY-h;if($(d).siblings(".bar").length&&$(d).siblings().children(".bar-radius").length!=0){var r=$(".editArea").width();var l=$(".editArea").height();$(d).children(".elementBox").attr("contenteditable","false");var m=$(d).parent().width();var p=$(d).parent().height();if(q<0){q=0}else{if(q>r-m){q=r-m}}if(o<0){o=0}else{if(o>l-p){o=l-p}}$(d).parent().css({"top":o,"left":q});if($(d).parent().find("img")[0]!=undefined){length=$(d).parent().find("img").length;for(var k=0;k<length;k++){$(d).parent().find("img")[k].ondragstart=imgdragstart}}}else{if($(d).parent().parent().hasClass("ModalIframe")){var a=$(".ModalIframe").width();var r=$(window).width();var l=$(window).height();var m=$(d).parent().parent().width();var p=$(d).parent().parent().height();if(q<0){q=0}else{if(q>r-m-2){q=r-m-2}}if(o<52){o=52}else{if(o>l-p-36){o=l-p-36}}q=q+0.4*r;$(document).scrollLeft(j);$(document).scrollTop(f);$(d).parent().parent().css({"top":o,"left":q})}else{if($(d).hasClass("modalHeader")){var a=$(".Modal").width();var r=$(window).width();var l=$(window).height();var m=$(d).parent().parent().width();var p=$(d).parent().parent().height();if(q<0){q=0}else{if(q>r-m){q=r-m}}if(o<50){o=50}else{if(o>l-p-36){o=l-p-36}}q=q+0.1*r;$(document).scrollLeft(j);$(document).scrollTop(f);$(d).parent().parent().css({"top":o,"left":q})}}}$("ul").css("cursor","move");$(d).css("cursor","move")}}).mouseup(function(){b=false;$("ul").css("cursor","auto")})}function rotate(b){var h=false;var f,d;b.mousedown(function(a){h=true;if(window.getSelection){window.getSelection().removeAllRanges()}else{if(document.selection){document.selection.empty()}}document.onselectstart=function(){return false};$(".elementBox").attr("contenteditable","false");$(".btn-toolbar").css("display","none");b.parent().siblings(".draggable").find(".elementBox").attr("id","");f=parseInt(b.parent().css("left"))+$(".editArea").offset().left+b.parent().width()/2;d=parseInt(b.parent().css("top"))+$(".editArea").offset().top+b.parent().height()/2;$("ul").css("cursor",'url(/theme/basic/images/rotateLeft.cur),"defaut"');$(".draggable").css("cursor",'url(/theme/basic/images/rotateLeft.cur),"defaut"')});$(document).mousemove(function(k){if(h){var a=k.pageX;var l=k.pageY;var i=(a-f)/(l-d);c=a-f;g=l-d;var j=Math.atan(Math.abs(i))*360/(2*Math.PI);c>0&&0>g?j=360+j:c>0&&g>0?j=180-j:0>c&&g>0?j=180+j:0>c&&0>g&&(j=360-j),j>360&&(j-=360);b.parent().css({"transform":"rotateZ("+j+"deg)"});b.parent().find(".rotateDeg").html(j)}}).mouseup(function(){h=false;$("ul").css("cursor","auto");$(".draggable").css("cursor","auto")})}function resizeW(f){var k=false;var i;var b;var d;var j;f.mousedown(function(a){k=true;if(window.getSelection){window.getSelection().removeAllRanges()}else{if(document.selection){document.selection.empty()}}document.onselectstart=function(){return false};i=f.parent().parent().find(".elementBox").width();j=f.parent().parent().find(".elementBox").height();if($(f).parent().parent().find("div[class^='html5zoo-swipe-box']").find("img")[0]!=undefined){i=f.parent().parent().find("div[class^='html5zoo-swipe-box']").find("img").eq(0).width();j=f.parent().parent().find("div[class^='html5zoo-swipe-box']").find("img").eq(0).height()}b=parseFloat(f.parent().parent().position().left);d=$(".editArea").width();$(this).parent().parent().find(".bar").css("display","block");$(this).parent().parent().find(".bar").children(".bar-radius").css("display","block");$(".elementBox").attr("contenteditable","false");$(".elementBox").attr("readOnly","true");$(".btn-toolbar").css("display","none");f.parent().siblings(".draggable").find(".elementBox").attr("id","");f.parent().siblings(".draggable").find(".elementBox").css("cursor","move");$("ul").css("cursor","w-resize")});$(document).mousemove(function(m){if(k){if(window.getSelection){window.getSelection().removeAllRanges()}else{if(document.selection){document.selection.empty()}}document.onselectstart=function(){return false};var a=m.pageX-$(".editArea").offset().left;var l=i+b-a;f.parent().parent().css("width",l);f.parent().parent().find(".draggable").css("width",l);f.parent().parent().find(".elementBox").css("width",l);f.parent().parent().css("height",j);f.parent().parent().find(".draggable").css("height",j);f.parent().parent().find(".elementBox").css("height",j);if(f.parent().parent().find("div[class^='html5zoo-swipe-box']").find("img")[0]!=undefined){length=f.parent().parent().find("div[class^='html5zoo-swipe-box']").find("img").length;for(var h=0;h<length;h++){f.parent().parent().find("div[class^='html5zoo-swipe-box']").find("img").eq(h).css("width",l)}f.parent().parent().find("div[class^='html5zoo-img']").find("img").css("width",l);f.parent().parent().find("div[class^='html5zoo-img']").find("img").css("height",j)}f.parent().parent().css("min-width",30);f.parent().parent().find(".elementBox").css("min-width",30);if(l<=30){f.parent().parent().css("width",30);f.parent().parent().find(".elementBox").css("width",30);f.parent().parent().css("left",i+b-30)}else{a>0?f.parent().parent().css("left",a):(f.parent().parent().css("left",0),f.parent().parent().css("width",i+b),f.parent().parent().find(".draggable").css("width",i+b),f.parent().parent().find(".elementBox").css("width",i+b))}$("ul").css("cursor","w-resize")}}).mouseup(function(){k=false;$("ul").css("cursor","auto");$(".elementBox").removeAttr("readOnly")})}function resizeE(f){var i=false;var b;var d;var j;f.mousedown(function(a){i=true;if(window.getSelection){window.getSelection().removeAllRanges()}else{if(document.selection){document.selection.empty()}}document.onselectstart=function(){return false};b=parseFloat(f.parent().parent().position().left);j=f.parent().parent().find(".elementBox").height();if($(f).parent().parent().find("div[class^='html5zoo-swipe-box']").find("img")[0]!=undefined){}d=$(".editArea").width();$(this).parent().parent().find(".bar").css("display","block");$(this).parent().parent().find(".bar").children(".bar-radius").css("display","block");$(".elementBox").attr("contenteditable","false");$(".elementBox").attr("readOnly","true");$(".btn-toolbar").css("display","none");f.parent().siblings(".draggable").find(".elementBox").attr("id","");f.parent().siblings(".draggable").find(".elementBox").css("cursor","move");$("ul").css("cursor","e-resize")});$(document).mousemove(function(l){if(i){if(window.getSelection){window.getSelection().removeAllRanges()}else{if(document.selection){document.selection.empty()}}document.onselectstart=function(){return false};var a=l.pageX-$(".editArea").offset().left;var k=a-b;f.parent().parent().css("width",k);f.parent().parent().find(".elementBox").css("width",k);f.parent().parent().find(".draggable").css("width",k);f.parent().parent().css("height",j);f.parent().parent().find(".draggable").css("height",j);f.parent().parent().find(".elementBox").css("height",j);if(f.parent().parent().find("div[class^='html5zoo-swipe-box']").find("img")[0]!=undefined){length=f.parent().parent().find("div[class^='html5zoo-swipe-box']").find("img").length;for(var h=0;h<length;h++){f.parent().parent().find("div[class^='html5zoo-swipe-box']").find("img").eq(h).css("width",k);f.parent().parent().find("div[class^='html5zoo-swipe-box']").find("img").eq(h).css("height",j)}f.parent().parent().find("div[class^='html5zoo-img']").find("img").css("width",k);f.parent().parent().find("div[class^='html5zoo-img']").find("img").css("height",j)}f.parent().parent().css("min-width",30);f.parent().parent().find(".elementBox").css("min-width",30);f.parent().parent().css("max-width",d-b);if(k<=30){f.parent().parent().css("width",30);f.parent().parent().find(".elementBox").css("width",30)}else{if(a>=d){f.parent().parent().css("width",d-b);f.parent().parent().find(".elementBox").css("width",d-b)}}$("ul").css("cursor","e-resize")}}).mouseup(function(){i=false;$("ul").css("cursor","auto");$(".elementBox").removeAttr("readOnly")})}function load(){window.document.designMode="On"}function resizeN(d){var j=false;var i;var k;var f;var b;d.mousedown(function(a){j=true;if(window.getSelection){window.getSelection().removeAllRanges()}else{if(document.selection){document.selection.empty()}}document.onselectstart=function(){return false};i=d.parent().parent().height();k=parseFloat(d.parent().parent().position().top);f=$(".editArea").height();b=d.parent().parent().find(".elementBox").width();if($(d).parent().parent().find("div[class^='html5zoo-swipe-box']").find("img")[0]!=undefined){b=d.parent().parent().find("div[class^='html5zoo-swipe-box']").find("img").eq(0).width();i=d.parent().parent().find("div[class^='html5zoo-swipe-box']").find("img").eq(0).height()}$(this).parent().parent().find(".bar").css("display","block");$(this).parent().parent().find(".bar").children(".bar-radius").css("display","block");$(".elementBox").attr("contenteditable","false");$(".elementBox").attr("readOnly","true");$(".btn-toolbar").css("display","none");d.parent().siblings(".draggable").find(".elementBox").attr("id","");d.parent().siblings(".draggable").find(".elementBox").css("cursor","move");$("ul").css("cursor","n-resize")});$(document).mousemove(function(n){if(j){if(window.getSelection){window.getSelection().removeAllRanges()}else{if(document.selection){document.selection.empty()}}document.onselectstart=function(){return false};var a=n.pageY-$(".editArea").offset().top;var m=i+k-a;var l=2*parseInt(d.parent().parent().find(".elementBox").css("borderWidth"));d.parent().parent().css("height",m);d.parent().parent().find(".elementBox").css("height",m);if(d.parent().parent().find("div[class^='html5zoo-swipe-box']").find("img")[0]!=undefined){length=d.parent().parent().find("div[class^='html5zoo-swipe-box']").find("img").length;for(var h=0;h<length;h++){d.parent().parent().find("div[class^='html5zoo-swipe-box']").find("img").eq(h).css("height",m);d.parent().parent().find("div[class^='html5zoo-swipe-box']").find("img").eq(h).css("width",b)}d.parent().parent().find("div[class^='html5zoo-img']").find("img").css("height",m);d.parent().parent().find("div[class^='html5zoo-swipe-box']").find("img").css("width",b)}d.parent().parent().find(".elementBox").css("min-height",30);d.parent().parent().css("min-height",30);d.parent().parent().css("max-height",i+k);if(m<=30){d.parent().parent().find(".elementBox").css("height",30).css("display","block");d.parent().parent().css("height",30);d.parent().parent().css("top",i+k-30)}else{a>0?d.parent().parent().css("top",a):(d.parent().parent().css("top",0),d.parent().parent().css("height",i+k),d.parent().parent().find(".elementBox").css("height",i+k))}$("ul").css("cursor","n-resize")}}).mouseup(function(){j=false;$("ul").css("cursor","auto");$(".elementBox").removeAttr("readOnly")})}function resizeS(f){var d=false;var j;var i;var b;f.mousedown(function(a){d=true;if(window.getSelection){window.getSelection().removeAllRanges()}else{if(document.selection){document.selection.empty()}}document.onselectstart=function(){return false};j=parseFloat(f.parent().parent().position().top);i=$(".editArea").height();b=f.parent().parent().find(".elementBox").width();if($(f).parent().parent().find("div[class^='html5zoo-swipe-box']").find("img")[0]!=undefined){b=f.parent().parent().find("div[class^='html5zoo-swipe-box']").find("img").eq(0).width()}$(this).parent().parent().find(".bar").css("display","block");$(this).parent().parent().find(".bar").children(".bar-radius").css("display","block");$(".elementBox").attr("contenteditable","false");$(".elementBox").attr("readOnly","true");$(".btn-toolbar").css("display","none");f.parent().siblings(".draggable").find(".elementBox").attr("id","");f.parent().siblings(".draggable").find(".elementBox").css("cursor","move");$("ul").css("cursor","s-resize")});$(document).mousemove(function(m){if(d){if(window.getSelection){window.getSelection().removeAllRanges()}else{if(document.selection){document.selection.empty()}}document.onselectstart=function(){return false};var a=m.pageY-$(".editArea").offset().top;var l=a-j;var k=2*parseInt(f.parent().parent().find(".elementBox").css("borderWidth"));f.parent().parent().css("top",j);f.parent().parent().css("height",l);if(f.parent().parent().find("div[class^='html5zoo-swipe-box']").find("img")[0]!=undefined){length=f.parent().parent().find("div[class^='html5zoo-swipe-box']").find("img").length;for(var h=0;h<length;h++){f.parent().parent().find("div[class^='html5zoo-swipe-box']").find("img").eq(h).css("height",l);f.parent().parent().find("div[class^='html5zoo-swipe-box']").find("img").eq(h).css("width",b)}f.parent().parent().find("div[class^='html5zoo-img']").find("img").css("height",l);f.parent().parent().find("div[class^='html5zoo-swipe-box']").find("img").css("width",b)}f.parent().parent().find(".elementBox").css("height",l);f.parent().parent().find(".elementBox").css("min-height",30);f.parent().parent().css("min-height",30);f.parent().parent().css("max-height",i-j);$("ul").css("cursor","s-resize");if(l<=30){f.parent().parent().find(".elementBox").css("height",30).css("display","block");f.parent().parent().css("height",30)}else{if(i-j<l){f.parent().parent().find(".elementBox").css("height",i-j).css("display","block");f.parent().parent().css("height",i-j)}}}}).mouseup(function(){d=false;$("ul").css("cursor","auto");$(".elementBox").removeAttr("readOnly")})}function writeTxt(){var a="";a+='<li class="rotate resize text" ctype="text" title="拖拽模式右击鼠标出现功能菜单，点击编辑可以进入编辑模式(编辑模式使用工具栏编辑时须选中文字)，点击页面空白处重回拖拽模式">';a+='<span class="rotateDeg" style="display:none;"></span>';a+='<span class="materialId" style="display:none;"></span>';a+='<div class="bar bar-rotate bar-radius" style="display:none;"  ></div>';a+='<div class="bar bar-line" style="display:none;"  ></div>';a+='<div class="draggable" style="width:100%;height:100%;">';a+='<div class="elementBox" id="elementBox" style="outline:0;height:100%;width:100%;box-sizing:border-box;" onload="load()">';a+="请输入</div>";a+="</div>";a+='<div class="bar bar-n" style="display:none;" ><div class="bar-radius" style="display:none;" ></div></div>';a+='<div class="bar bar-s"  style="display:none;" ><div class="bar-radius" style="display:none;" ></div></div>';a+='<div class="bar bar-e"  style="display:none;" ><div class="bar-radius" style="display:none;" ></div></div>';a+='<div class="bar bar-w" style="display:none;" ><div class="bar-radius" style="display:none;" ></div></div>';a+='<div class="bar bar-ne bar-radius" style="display:none;"  ></div>';a+='<div class="bar bar-nw bar-radius" style="display:none;" ></div>';a+='<div class="bar bar-se bar-radius"  style="display:none;" ></div>';a+='<div class="bar bar-sw bar-radius"  style="display:none;" ></div>';a+="</li>";return a}function writeBg(){var a="";a+='<li class="background" style="display:none;" ctype="background-image">';a+='<span class="materialId" style="display:none;"></span>';a+="</li>";return a}function writeMusic(){var a="";a+='<li class="music" style="display:none;" ctype="music">';a+='<span class="materialId" style="display:none;"></span>';a+='<audio id="music" class="musicAudio" src="" loop="loop"></audio>';a+="</li>";return a}function writeVideo(){var a="";a+='<li class="video" style="" ctype="video" >';a+='<span class="rotateDeg" style="display:none;"></span>';a+='<span class="materialId" style="display:none;"></span>';a+='<div class="bar bar-rotate bar-radius" style="display:none;"  ></div>';a+='<div class="bar bar-line" style="display:none;"  ></div>';a+='<div class="draggable" style="width:100%;height:100%;">';a+='<video id="my-video" class="video-js elementBox" controls preload="auto" width="100%"   poster="" data-setup="{}" style="margin-left:1.2px;">';a+='<source src="" >';a+="</video>";a+="</div>";a+='<div class="bar bar-n" style="display:none;" ><div class="bar-radius" style="display:none;" ></div></div>';a+='<div class="bar bar-s"  style="display:none;" ><div class="bar-radius" style="display:none;" ></div></div>';a+='<div class="bar bar-e"  style="display:none;" ><div class="bar-radius" style="display:none;" ></div></div>';a+='<div class="bar bar-w" style="display:none;" ><div class="bar-radius" style="display:none;" ></div></div>';a+='<div class="bar bar-ne bar-radius" style="display:none;"  ></div>';a+='<div class="bar bar-nw bar-radius" style="display:none;" ></div>';a+='<div class="bar bar-se bar-radius"  style="display:none;" ></div>';a+='<div class="bar bar-sw bar-radius"  style="display:none;" ></div>';a+="</li>";return a}function writePic(){var a="";a+='<li class="rotate resize picture"  style="display:block;" ctype="image" >';a+='<span class="rotateDeg" style="display:none;"></span>';a+='<span class="materialId" style="display:none;"></span>';a+='<div class="bar bar-rotate bar-radius" style="display:none;"  ></div>';a+='<div class="bar bar-line" style="display:none;"  ></div>';a+='<div class="draggable" style="width:100%;height:100%;">';a+='<img class="elementBox" id="elementBox" style="display:block;outline:0;" src=""/>';a+="</div>";a+='<div class="bar bar-n" style="display:none;" ><div class="bar-radius" style="display:none;" ></div></div>';a+='<div class="bar bar-s"  style="display:none;" ><div class="bar-radius" style="display:none;" ></div></div>';a+='<div class="bar bar-e"  style="display:none;" ><div class="bar-radius" style="display:none;" ></div></div>';a+='<div class="bar bar-w" style="display:none;" ><div class="bar-radius" style="display:none;" ></div></div>';a+='<div class="bar bar-ne bar-radius" style="display:none;"  ></div>';a+='<div class="bar bar-nw bar-radius" style="display:none;" ></div>';a+='<div class="bar bar-se bar-radius"  style="display:none;" ></div>';a+='<div class="bar bar-sw bar-radius"  style="display:none;" ></div>';a+="</li>";return a}function writeCollection(){var a="";a+='<li class="rotate resize "  id="slide" style="display:block;" ctype="collection" >';a+='<span class="rotateDeg" style="display:none;"></span>';a+='<span class="materialId" style="display:none;"></span>';a+='<div class="bar bar-rotate bar-radius" style="display:none;"  ></div>';a+='<div class="bar bar-line" style="display:none;"  ></div>';a+='<div class="draggable" style="width:100%;height:100%;">';a+='<div class="elementBox" style="margin:0px auto;">';a+='<div id="html5zoo-1" style="display:block;position:relative;margin:0px auto 60px;">';a+='<ul class="html5zoo-slides" style="display:none;">';a+="</ul>";a+="</div>";a+="</div>";a+="</div>";a+='<div class="bar bar-n" style="display:none;" ><div class="bar-radius" style="display:none;" ></div></div>';a+='<div class="bar bar-s"  style="display:none;" ><div class="bar-radius" style="display:none;" ></div></div>';a+='<div class="bar bar-e"  style="display:none;" ><div class="bar-radius" style="display:none;" ></div></div>';a+='<div class="bar bar-w" style="display:none;" ><div class="bar-radius" style="display:none;" ></div></div>';a+='<div class="bar bar-ne bar-radius" style="display:none;"  ></div>';a+='<div class="bar bar-nw bar-radius" style="display:none;" ></div>';a+='<div class="bar bar-se bar-radius"  style="display:none;" ></div>';a+='<div class="bar bar-sw bar-radius"  style="display:none;" ></div>';a+="</li>";return a}function writeInput(){var a="";a+='<li class="rotate resize input" ctype="input" title="拖拽模式右击鼠标出现功能菜单，点击编辑可以进入编辑模式(编辑模式使用工具栏编辑时须选中文字)，点击页面空白处重回拖拽模式">';a+='<span class="rotateDeg" style="display:none;"></span>';a+='<span class="materialId" style="display:none;"></span>';a+='<div class="bar bar-rotate bar-radius" style="display:none;"  ></div>';a+='<div class="bar bar-line" style="display:none;"  ></div>';a+='<div class="draggable" style="width:100%;height:100%;">';a+='<div class="elementBox" id="elementBox" style="display:block;height:100%;width:100%;outline:0;" >';a+='<input style="display:block;outline:0;height:100%;background:transparent;width:100%;border:none;resize:none;padding-left:10px;"  value=""/>';a+="</div>";a+="</div>";a+='<div class="bar bar-n" style="display:none;" ><div class="bar-radius" style="display:none;" ></div></div>';a+='<div class="bar bar-s"  style="display:none;" ><div class="bar-radius" style="display:none;" ></div></div>';a+='<div class="bar bar-e"  style="display:none;" ><div class="bar-radius" style="display:none;" ></div></div>';a+='<div class="bar bar-w" style="display:none;" ><div class="bar-radius" style="display:none;" ></div></div>';a+='<div class="bar bar-ne bar-radius" style="display:none;"  ></div>';a+='<div class="bar bar-nw bar-radius" style="display:none;" ></div>';a+='<div class="bar bar-se bar-radius"  style="display:none;" ></div>';a+='<div class="bar bar-sw bar-radius"  style="display:none;" ></div>';a+="</li>";return a}function writeButton(){var a="";a+='<li class="rotate resize button" ctype="button" title="拖拽模式右击鼠标出现功能菜单，点击编辑可以进入编辑模式(编辑模式使用工具栏编辑时须选中文字)，点击页面空白处重回拖拽模式">';a+='<span class="rotateDeg" style="display:none;"></span>';a+='<span class="materialId" style="display:none;"></span>';a+='<div class="bar bar-rotate bar-radius" style="display:none;"  ></div>';a+='<div class="bar bar-line" style="display:none;"  ></div>';a+='<div class="draggable" style="width:100%;height:100%;">';a+='<div class="elementBox" id="elementBox" style="display:block;height:100%;width:100%;outline:0;background:#f1f1f1;">';a+='<button style="display:block;outline:0;height:100%;background:transparent;width:100%;border:none;text-align:center"></button>';a+="</div>";a+="</div>";a+='<div class="bar bar-n" style="display:none;" ><div class="bar-radius" style="display:none;" ></div></div>';a+='<div class="bar bar-s"  style="display:none;" ><div class="bar-radius" style="display:none;" ></div></div>';a+='<div class="bar bar-e"  style="display:none;" ><div class="bar-radius" style="display:none;" ></div></div>';a+='<div class="bar bar-w" style="display:none;" ><div class="bar-radius" style="display:none;" ></div></div>';a+='<div class="bar bar-ne bar-radius" style="display:none;"  ></div>';a+='<div class="bar bar-nw bar-radius" style="display:none;" ></div>';a+='<div class="bar bar-se bar-radius"  style="display:none;" ></div>';a+='<div class="bar bar-sw bar-radius"  style="display:none;" ></div>';a+="</li>";return a}function writeToolbar(){var f=["#000000","#7e2412","#ff5400","#225801","#0c529e","#333333","#b61b52","#f4711f","#3bbc1e","#23a3d3","#888888","#d34141","#f7951e","#29b16a","#97daf3","#cccccc","#ec7c7c","#fdea02","#79c450","#563679","#ffffff","#ffcccc","#d9ef7f","#c3f649"];var d="";d+='<div class="btn-group">';d+='<a class="btn dropdown-toggle" data-toggle="dropdown" title="文字颜色"><i class="glyphicon glyphicon-font color-btn"></i><b class="caret"></b></a>';d+='<ul class="dropdown-menu color-menu">';for(var b=0;b<f.length;b++){d+='<li><a dropdown-toggle class="btn" data-edit="foreColor '+f[b]+'" style="background-color: '+f[b]+'"></a></li>'}d+="</ul>";d+="</div>";d+='<div class="btn-group">';d+='<a class="btn dropdown-toggle" data-toggle="dropdown" title="字体大小"><i class="icon-text-height"></i>&nbsp;<b class="caret"></b></a>';d+='<ul class="dropdown-menu">';d+='<li><a data-edit="fontSize 5"><font size="5">Huge</font></a></li>';d+='<li><a data-edit="fontSize 3"><font size="3">Normal</font></a></li>';d+='<li><a data-edit="fontSize 1"><font size="1">Small</font></a></li>';d+="</ul>";d+=" </div>";d+=' <div class="btn-group">';d+=' <a class="btn" data-edit="bold" title="加粗(Ctrl/Cmd+B)"><i class="icon-bold"></i></a>';d+="</div>";d+=' <div class="btn-group">';d+=' <a class="btn" data-edit="italic" title="斜体(Ctrl/Cmd+I)"><i class="icon-italic"></i></a>';d+="</div>";d+=' <div class="btn-group">';d+='<a class="btn" data-edit="underline" title="下划线(Ctrl/Cmd+U)"><i class="icon-underline"></i></a>';d+="</div>";d+='<div class="btn-group">';d+=' <a class="btn" data-edit="justifyleft" title="左对齐(Ctrl/Cmd+L)"><i class="icon-align-left"></i></a>';d+='<a class="btn" data-edit="justifycenter" title="居中(Ctrl/Cmd+E)"><i class="icon-align-center"></i></a>';d+='<a class="btn" data-edit="justifyright" title="右对齐(Ctrl/Cmd+R)"><i class="icon-align-right"></i></a>';d+="</div>";d+='<div class="btn-group">';d+='<a class="btn dropdown-toggle" data-toggle="dropdown" title="Hyperlink"><i class="icon-link"></i></a>';d+='<div class="dropdown-menu input-append" style="overflow:hidden;text-align:center;">';d+='<input class="span2" placeholder="URL" type="text" data-edit="createLink" style="width:90%;" />';d+='<button class="btn" type="button" style="float:right;margin-right:5px;">增加</button>';d+="</div>";d+='<a class="btn" data-edit="unlink" title="Remove Hyperlink"><i class="icon-cut"></i></a>';d+="</div>";return d}function writePopMenu(){var a="";a+='<li class="edit" role="presentation"><a role="menuitem" tabindex="-1"><div class="glyphicon glyphicon-edit" style="color: #08a1ef;"></div>&nbsp;&nbsp;编辑</a></li>';a+='<li class="style" role="presentation"><a role="menuitem" "tabindex="-1"><div class="fa fa-pencil" style="color: #08a1ef;"></div>&nbsp;&nbsp;样式</a></li>';a+='<li class="anim" role="presentation"><a role="menuitem" tabindex="-1"><div class="fa fa-video-camera" style="color: #08a1ef;"></div>&nbsp;&nbsp;动画</a></li>';a+='<li class="copy" role="presentation"><a role="menuitem" tabindex="-1"><div class="fa fa-copy" style="color: #08a1ef;"></div>&nbsp;&nbsp;复制</a></li>';a+='<li class="delete" role="presentation"><a role="menuitem" tabindex="-1"><div class="glyphicon glyphicon-trash" style="color: #08a1ef;"></div>&nbsp;&nbsp;删除</a></li>';a+='<div class="popIndex" style="display:none;"></div>';return a}function writeStyleModal(){var a="";a+='<div class="modalDrag">';a+='<div class=dragIndex style="display:none;"></div>';a+='<div class="modalHeader">';a+='<a class="close" >×</a>';a+="<span>样式</span>";a+="</div>";a+='<div class="modalBody">';a+='<form action="" style="margin:auto 0;">';a+='<div class="form-item"><label for="opacity">&nbsp;&nbsp;&nbsp;&nbsp;透明度:</label><input type="text" id="opacity" name="opacity" value="" placeholder="请输入0-1的透明度值"/></div>';a+='<div class="form-item"><label for="borderSize">边框尺寸:</label><input type="text" id="borderSize" name="borderSize" value="" placeholder="请输入0-20的边框值（单位px）"/></div>';a+='<div class="form-item"><label for="borderRadius">边框弧度:</label><input type="text" id="borderRadius" name="borderRadius" value="" placeholder="请输入一定量的圆角边框值（单位px）"/></div>';a+='<div class="form-item"><label for="borderStyle">边框类型:</label><label><input name="borderStyle" type="radio" value="solid" />实心 </label> <label><input name="borderStyle" type="radio" value="dashed" />虚线 </label> <label><input name="borderStyle" type="radio" value="dotted" />点线</label><label><input name="borderStyle" type="radio" value="none" />空 </label> </div>';a+='<div class="form-item"><label for="borderColor">边框颜色:</label><input type="text" id="borderColor" name="borderColor" value="#222" /><div class="chooseBtn borderColorBtn">取色</div></div>';a+='<div id="picker2" class="hidePicker"></div>';a+='<div class="form-item"><label for="color">背景颜色:</label><input type="text" id="color" name="color" value="#fff" /><div class="chooseBtn bgColor">取色</div></div>';a+='<div id="picker" class="hidePicker"></div>';a+="<p>注：字体颜色在双击元素后编辑模式的工具栏里调。</p>";a+="</form>";a+="</div>";a+='<div class="modalFooter">';a+='<a href=javascript:void(0); class="btn submit">确定</a>';a+='<a href=javascript:void(0); class="btn cancel">取消</a>';a+="</div>";a+="</div>";return a}function writeAnimModal(){var a="";a+='<div class="modalDrag animModalDrag" style="display:none;">';a+='<div class=animIndex style="display:none;"></div>';a+='<div class="modalHeader">';a+='<a class="close" >×</a>';a+="<span>动画</span>";a+="</div>";a+='<div class="modalBody">';a+='<ul class="animTab">';a+='<li class="current">动画-1</li>';a+="</ul>";a+='<ul class="animCont">';a+="<li>";a+='<form action="" style="margin:auto 0;">';a+='<div class="form-item"><label for="time">动画持续:</label><input type="text" class="time" name="time" value="" placeholder="请输入动画时间"/></div>';a+='<div class="form-item"><label for="delay">动画延迟:</label><input type="text" class="delay" name="delay" value="" placeholder="请输入延迟时间"/></div>';a+='<div class="form-item"><label for="times">动画次数:</label><input type="text" class="times" name="times" value="" placeholder="请输入动画次数"/></div>';a+='<div class="form-item"><label for="method">是否循环:</label><label><input name="animCircle" type="radio" value="infinite" />是 </label> <label><input name="animCircle" type="radio" value=""  />否 </label></div>';a+='<div class="form-item"><label for="method">动画方式:</label><label><input name="animMethod" type="radio" value="fadeIn" />淡入 </label> <label><input name="animMethod" type="radio" value="fadeInRight" />从右移入 </label> <label><input name="animMethod" type="radio" value="fadeInLeft" />从左移入 </label><label><input name="animMethod" type="radio" value="fadeInUp" />从下移入 </label><label><input name="animMethod" type="radio" value="fadeInDown" />从上移入 </label><label><input name="animMethod" type="radio" value="zoomIn" />中心放大</label><label><input name="animMethod" type="radio" value="wobble" />摇摆 </label><label style=""><input name="animMethod" type="radio" value="rotateIn" />旋转 </label><label><input name="animMethod" type="radio" value="swing" />悬摆 </label><label><input name="animMethod" type="radio" value="flipOutY" />翻转消失 </label><label><input name="animMethod" type="radio" value="fadeOut" />淡出 </label> <label><input name="animMethod" type="radio" value="none" />无 </label> </div>';a+="</form>";a+="</li>";a+="</ul>";a+='<a href=javascript:void(0); class="btn seeAnim">预览动画</a>';a+='<a href=javascript:void(0); class="btn addAnim">增加动画</a>';a+='<div style="clear:both"></div>';a+='<p align="justify">注：请先选好动画参数，点击相应动画方式（预览当前元素当前动画）或预览动画（预览当前元素全部动画）。</p>';a+="</div>";a+='<div class="modalFooter">';a+='<a href=javascript:void(0); class="btn submit">确定</a>';a+='<a href=javascript:void(0); class="btn cancel">取消</a>';a+="</div>";a+="</div>";return a}function addContByType(f,d){var h="";switch(f){case"text":h+=writeTxt();break;case"background-image":h+=writeBg();break;case"music":h+=writeMusic();break;case"image":h+=writePic();break;case"input":h+=writeInput();break;case"button":h+=writeButton();break;case"video":h+=writeVideo();break;case"collection":h+=writeCollection();break;default:}return h}function hasPercent(d){var a=/%+/;var b;if(a.test(d)){b=true}else{b=false}return b}function hasRem(a){var d="rem";var b;if(a.indexOf(d)>0){b=true}else{b=false}return b}function closeBgToggle(){var a=$(".editWrapper .editArea").length;var d=0;for(var b=0;b<a;b++){if($(".editWrapper .editArea").eq(b).css("backgroundImage")!="none"){d++}}if(d>0){$(".bgToggle").css("display","block")}else{$(".bgToggle").hide()}}function changePagination(){var a=$(".pagin li").length;if(a==0){a++}var b="";for(var d=0;d<a;d++){var f=d+1;b+="<li>第"+f+"页</li>"}$(".rightBody .pagin").empty().append(b);$(".pagin").children("li").eq(a-1).addClass("currentPage")}function addPage(){var a=$(".pagin li").length+1;paginationHtml="<li>第"+a+"页</li>";$(".rightBody .pagin").append(paginationHtml);$(".rightBody .pagin li").removeClass("currentPage");$(".rightBody .pagin li").eq(a-1).addClass("currentPage")}function removePage(){var a=$(".pagin li").length;var d=$(".pagin .currentPage").index();var b="";for(var f=0;f<a-1;f++){var h=f+1;b+="<li>第"+h+"页</li>"}$(".rightBody .pagin").empty().append(b);$(".pagin").children("li").eq(d-1).addClass("currentPage")}$("a").bind("focus",function(){if(this.blur){this.blur()}});function rgbToHsl(a,k,n){a/=255,k/=255,n/=255;var o=Math.max(a,k,n),i=Math.min(a,k,n);var j,p,f=(o+i)/2;if(o==i){j=p=0}else{var m=o-i;p=f>0.5?m/(2-o-i):m/(o+i);switch(o){case a:j=(k-n)/m+(k<n?6:0);break;case k:j=(n-a)/m+2;break;case n:j=(a-k)/m+4;break}j/=6}return[j,p,f]}function zero_fill_hex(a,d){var b=a.toString(16);while(b.length<d){b="0"+b}return b}function rgb2hex(b){if(b.charAt(0)=="#"){return b}var d=b.split(/\D+/);var a=Number(d[1])*65536+Number(d[2])*256+Number(d[3]);if(b!="rgb(0, 0, 0, 0)"){return"#"+zero_fill_hex(a,6)}else{return"transparent"}}function removeSpace(f){if(f==""||f==undefined){return f}f=f.split(" ");var a=f.length;var d="";for(var b=0;b<a;b++){d+=f[b]}return d}function html_encode(b){var a="";if(b.length==0){return""}a=b.replace(/&/g,"&gt;");a=a.replace(/</g,"&lt;");a=a.replace(/>/g,"&gt;");a=a.replace(/ /g,"&nbsp;");a=a.replace(/\'/g,"&#39;");a=a.replace(/\"/g,"&quot;");a=a.replace(/\n/g,"<br>");return a}function html_decode(b){var a="";if(b.length==0){return""}a=b.replace(/&gt;/g,"&");a=a.replace(/&lt;/g,"<");a=a.replace(/&gt;/g,">");a=a.replace(/&nbsp;/g," ");a=a.replace(/&#39;/g,"'");a=a.replace(/&quot;/g,'"');a=a.replace(/<br>/g,"\n");return a}var base64EncodeChars="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";var base64DecodeChars=new Array(-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,-1,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,-1,-1,-1,-1,-1);function base64encode(k){var d,h,a;var j,f,b;a=k.length;h=0;d="";while(h<a){j=k.charCodeAt(h++)&255;if(h==a){d+=base64EncodeChars.charAt(j>>2);d+=base64EncodeChars.charAt((j&3)<<4);d+="==";break}f=k.charCodeAt(h++);if(h==a){d+=base64EncodeChars.charAt(j>>2);d+=base64EncodeChars.charAt(((j&3)<<4)|((f&240)>>4));d+=base64EncodeChars.charAt((f&15)<<2);d+="=";break}b=k.charCodeAt(h++);d+=base64EncodeChars.charAt(j>>2);d+=base64EncodeChars.charAt(((j&3)<<4)|((f&240)>>4));d+=base64EncodeChars.charAt(((f&15)<<2)|((b&192)>>6));d+=base64EncodeChars.charAt(b&63)}return d}function base64decode(l){var k,j,f,b;var h,a,d;a=l.length;h=0;d="";while(h<a){do{k=base64DecodeChars[l.charCodeAt(h++)&255]}while(h<a&&k==-1);if(k==-1){break}do{j=base64DecodeChars[l.charCodeAt(h++)&255]}while(h<a&&j==-1);if(j==-1){break}d+=String.fromCharCode((k<<2)|((j&48)>>4));do{f=l.charCodeAt(h++)&255;if(f==61){return d}f=base64DecodeChars[f]}while(h<a&&f==-1);if(f==-1){break}d+=String.fromCharCode(((j&15)<<4)|((f&60)>>2));do{b=l.charCodeAt(h++)&255;if(b==61){return d}b=base64DecodeChars[b]}while(h<a&&b==-1);if(b==-1){break}d+=String.fromCharCode(((f&3)<<6)|b)}return d}function utf16to8(f){var b,d,a,h;b="";a=f.length;for(d=0;d<a;d++){h=f.charCodeAt(d);if((h>=1)&&(h<=127)){b+=f.charAt(d)}else{if(h>2047){b+=String.fromCharCode(224|((h>>12)&15));b+=String.fromCharCode(128|((h>>6)&63));b+=String.fromCharCode(128|((h>>0)&63))}else{b+=String.fromCharCode(192|((h>>6)&31));b+=String.fromCharCode(128|((h>>0)&63))}}}return b}function utf8to16(j){var b,f,a,k;var h,d;b="";a=j.length;f=0;while(f<a){k=j.charCodeAt(f++);switch(k>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:b+=j.charAt(f-1);break;case 12:case 13:h=j.charCodeAt(f++);b+=String.fromCharCode(((k&31)<<6)|(h&63));break;case 14:h=j.charCodeAt(f++);d=j.charCodeAt(f++);b+=String.fromCharCode(((k&15)<<12)|((h&63)<<6)|((d&63)<<0));break}}return b}function imgdragstart(){return false};