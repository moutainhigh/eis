$(function(){$.ajax({type:"GET",url:"/category.json?categoryType=scene",dataType:"json",success:function(k){if(typeof(k.rows)!="undefined"){var a="<ul>";var f=k.rows.length;for(var l=0;l<f;l++){a+="<li>"+k.rows[l].categoryName+"</li>"}a+="</ul>";$(".leftBox .tab").append(a);var h=$(".leftBox .tab ul").width();$(".leftBox .tab ul li").css("width",(h-35)/f);$(".leftBox .tab ul li").eq(0).addClass("current");$(window).resize(function(){var i=$(".leftBox .tab ul").width();$(".leftBox .tab ul li").css("width",(i-35)/f)});for(var l=0;l<f;l++){var o='<div class="tabContent" style="display:none;">';var j=0;if(typeof(k.rows[l].subCategoryMap)!="undefined"){o+="<ul>";for(var d in k.rows[l].subCategoryMap){o+='<li><a href="#">'+d+"</a></li>";j++}o+="</ul>"}o+="</div>";$(".leftBox .tabCont").append(o);if($("#Pagination").data("twbs-pagination")){$("#Pagination").twbsPagination("destroy")}var p=$(".leftBox .tabCont .tabContent").eq(0).children("ul").children("li").eq(0).children("a").html();getCont(p);if(j){var q=$(".leftBox").width();$(".leftBox .tabCont .tabContent").eq(l).find("ul li").css("width",q*0.9/j);$(".leftBox .tabCont .tabContent").eq(l).find("ul li").eq(0).addClass("currentTabCont");$(".leftBox .tabCont .tabContent").eq(l).find("ul li").click(function(){$(this).addClass("currentTabCont");$(this).siblings().removeClass("currentTabCont");var i=$(this).find("a").html();if($("#Pagination").data("twbs-pagination")){$("#Pagination").twbsPagination("destroy")}getCont(i)})}}$(window).resize(function(){var i=$(".leftBox").width();$(".leftBox .tabCont .tabContent ul li").css("width",i*0.95/4);$(".leftBox .tabCont .tabContent li").css("min-width",58)});$(".leftBox .tabCont .tabContent").css("display","none");$(".leftBox .tabCont .tabContent").eq(0).css("display","block");$(".leftBox .tab ul li").mouseover(function(){$(".leftBox .tab ul li").removeClass("active");$(this).addClass("active")});$(".leftBox .tab ul li").mouseout(function(){$(this).removeClass("active")});$(".leftBox .tab ul li").click(function(){$(".leftBox .tab ul li").removeClass("current");$(this).addClass("current");$(".leftBox .tabCont .tabContent").css("display","none");$(".leftBox .tabCont .tabContent").eq($(this).index()).css("display","block");var i=$(".leftBox .tabCont .tabContent").eq($(this).index()).children("ul").children("li").eq(0).children("a").html();if($("#Pagination").data("twbs-pagination")){$("#Pagination").twbsPagination("destroy")}getCont(i)})}},})});function getCont(a){var f=0;$.ajax({type:"GET",url:"/scene.json?tags="+a,dataType:"json",async:false,success:function(h){$("#total").val(h.total);f=h.total}});function d(i,h){$.ajax({type:"GET",url:"/scene.json?tags="+h+"&rows=9&page="+i,dataType:"json",async:false,beforeSend:function(j){$(".leftBox .body").empty().append('<img src="/theme/basic/images/loading.gif" class="loading"/>')},success:function(o){var n="";if(typeof(o.sceneList)!="undefined"){var j=o.sceneList.length;for(var m=0;m<j;m++){if(o.sceneList[m].coverUrl==undefined){n+='<div class="cont">'+o.sceneList[m].title+"</div>"}else{coverUrl="/static/documentFile/open/"+o.sceneList[m].coverUrl;n+='<image class="cont" src='+coverUrl+" title="+o.sceneList[m].title+"["+o.sceneList[m].sceneId+"]/>"}n+='<input type="hidden" value="">'}}$(".leftBox .body").empty().append(n);if(n){for(var m=0;m<j;m++){$(".cont").eq(m).val()}}var l=$(".leftBox").height();$(".leftBox .body .cont").css("height",(l-160)*0.33);$(".leftBox .body").css("height",l-140);if(typeof(o.sceneList)!="undefined"){var j=o.sceneList.length;$(".leftBox .body .cont").click(function(){var p=$(".leftBox .body .cont").index(this);if($("#nr").children().children().hasClass("editBg")||$(".editArea").has("li").length){swal({title:"您确定要覆盖原有数据么？",showCancelButton:true,cancelButtonText:"取消",closeOnConfirm:true,confirmButtonText:"确定",confirmButtonColor:"#428bca"},function(){$(".animModal").empty(),$(".animModal").hide(),$(".styleModal").hide(),$(".musicToggle").hide(),$("#audio_btn").hide(),changePhoneCont(o,p,0,0,""),closeBgToggle(),$(".rightBody .pagin li").eq(0).addClass("currentPage")})}else{$(".animModal").empty();$(".animModal").hide();$(".styleModal").hide();changePhoneCont(o,p,0,0,"");$(".rightBody .pagin li").eq(0).addClass("currentPage")}})}},})}$("#Pagination").twbsPagination({totalPages:parseInt(parseInt($("#total").val())/9)+1,visiblePages:3,first:"首页",prev:"上一页",next:"下一页",last:"尾页",onPageClick:function(h,i){d(i,a)}})}function changePhoneCont(T,I,R,P,O,M){var n="";if(P==0){if(T.sceneList[I].materialList!=undefined){var S=T.sceneList[I].materialList.length;for(G=0;G<S;G++){var q="";n+=addContByType(T.sceneList[I].materialList[G].materialType,q);if(T.sceneList[I].materialList[G].materialType=="background-image"){$(".editArea").css("background","url(/static/documentFile/open/"+T.sceneList[I].background+") top center no-repeat");$(".editArea").css("background",q+" top center 99.5% 100% no-repeat");$(".editArea").css("backgroundSize","99.5% 100%");$(".bgToggle").show()}}$(".editArea").empty().append('<div class="phoneContBg" style="position:absolute;width:100%;height:100%;z-index:1;opacity:0;"></div>').append(n);
for(G=0;G<S;G++){if(T.sceneList[I].materialList[G].materialType=="image"){$(".editArea").children("li").eq(G).find(".elementBox").attr("src","/static/documentFile/open/"+T.sceneList[I].materialList[G].content);$("#nr .editWrapper .editArea").children("li").eq(G).attr("style",T.sceneList[I].materialList[G].css);$("#nr .editWrapper .editArea").children("li").eq(G).find(".elementBox").attr("style",T.sceneList[I].materialList[G].cssExt);$(".editArea").children("li").eq(G).find(".materialId").html(T.sceneList[I].materialList[G].materialModelId);$("#nr .editWrapper .editArea").children("li").eq(G).find("img").css("width","100%").css("height","100%")}else{if(T.sceneList[I].materialList[G].materialType=="music"){$(".editArea").children("li").eq(G).find("audio").attr("src","/static/documentFile/open/"+T.sceneList[I].materialList[G].content);$(".editArea").children("li").eq(G).find(".materialId").html(T.sceneList[I].materialList[G].materialModelId);$(".musicToggle").show();$("#audio_btn").show();if($(".editArea").children("li").eq(G).find("audio").attr("autoplay")=="autoplay"){$("#audio_btn").removeClass("off").addClass("play_yinfu");$("#yinfu").addClass("rotateMusic")}}else{if(T.sceneList[I].materialList[G].materialType=="video"){$(".editArea").children("li").eq(G).find("source").attr("src","/static/documentFile/open/"+T.sceneList[I].materialList[G].content);$(".editArea").children("li").eq(G).find(".materialId").html(T.sceneList[I].materialList[G].materialModelId)}else{if(T.sceneList[I].materialList[G].materialType=="collection"){var E=T.sceneList[I].materialList[G].content.split(",").length;var A="";for(var K=0;K<E;K++){A+='<li style="position:relative;"><a href=""><img src=""  data-description="" /></a></li>'}$(".editArea").children("li").eq(G).find(".html5zoo-slides").append(A);$("#nr .editWrapper .editArea").children("li").eq(G).attr("style",T.sceneList[I].materialList[G].css);$("#nr .editWrapper .editArea").children("li").eq(G).find(".elementBox").attr("style",T.sceneList[I].materialList[G].cssExt);$(".editArea").children("li").eq(G).find(".materialId").html(T.sceneList[I].materialList[G].materialModelId);$(".editArea").children("li").eq(G).append("");for(var K=0;K<E;K++){$(".editArea").children("li").eq(G).find(".html5zoo-slides li").eq(K).find("img").attr("src","/static/documentFile/open/"+T.sceneList[I].materialList[G].content.split(",")[K])}variousSlide($(".editArea").children("li").eq(G).attr("id"))}else{if(T.sceneList[I].materialList[G].materialType=="background-image"){$(".editArea").children("li").eq(G).find(".materialId").html(T.sceneList[I].materialList[G].materialModelId)}else{if(T.sceneList[I].materialList[G].materialType=="text"){$("#nr .editWrapper .editArea").children("li").eq(G).find(".elementBox").html(T.sceneList[I].materialList[G].content);$("#nr .editWrapper .editArea").children("li").eq(G).attr("style",T.sceneList[I].materialList[G].css);$("#nr .editWrapper .editArea").children("li").eq(G).find(".elementBox").attr("style",T.sceneList[I].materialList[G].cssExt);var L=$("#nr .editWrapper .editArea").children("li").eq(G).height();var x=$("#nr .editWrapper .editArea").children("li").eq(G).width();$("#nr .editWrapper .editArea").children("li").eq(G).find(".elementBox").css({"width":x,"height":L})}else{if(T.sceneList[I].materialList[G].materialType=="button"){$("#nr .editWrapper .editArea").children("li").eq(G).find("button").html(T.sceneList[I].materialList[G].content);$("#nr .editWrapper .editArea").children("li").eq(G).attr("style",T.sceneList[I].materialList[G].css);$("#nr .editWrapper .editArea").children("li").eq(G).find(".elementBox").attr("style",T.sceneList[I].materialList[G].cssExt);var L=$("#nr .editWrapper .editArea").children("li").eq(G).height();var x=$("#nr .editWrapper .editArea").children("li").eq(G).width();$("#nr .editWrapper .editArea").children("li").eq(G).find(".elementBox").css({"width":x,"height":L})}else{if(T.sceneList[I].materialList[G].materialType=="input"){var H=JSON.parse(T.sceneList[I].materialList[G].content);$("#nr .editWrapper .editArea").children("li").eq(G).find("input").attr("type",H.type);$("#nr .editWrapper .editArea").children("li").eq(G).find("input").attr("placeholder",H.placeholder);$("#nr .editWrapper .editArea").children("li").eq(G).attr("style",T.sceneList[I].materialList[G].css);$("#nr .editWrapper .editArea").children("li").eq(G).find(".elementBox").attr("style",T.sceneList[I].materialList[G].cssExt);var L=$("#nr .editWrapper .editArea").children("li").eq(G).height();var x=$("#nr .editWrapper .editArea").children("li").eq(G).width();$("#nr .editWrapper .editArea").children("li").eq(G).find(".elementBox").css({"width":x,"height":L})}else{}}}}}}}}}}if(T.sceneList[I].materialList!=undefined){var S=T.sceneList[I].materialList.length;for(var G=0;G<S;G++){rotate($("#nr .editWrapper .editArea").children("li").eq(G).find(".bar-rotate"));draggable($("#nr .editWrapper .editArea").children("li").eq(G).find(".draggable").get(0));resizeW($("#nr .editWrapper .editArea").children("li").eq(G).find(".bar-w").children(".bar-radius"));
resizeE($("#nr .editWrapper .editArea").children("li").eq(G).find(".bar-e").children(".bar-radius"));resizeN($("#nr .editWrapper .editArea").children("li").eq(G).find(".bar-n").children(".bar-radius"));resizeS($("#nr .editWrapper .editArea").children("li").eq(G).find(".bar-s").children(".bar-radius"));var C=writeAnimModal();$(".animModal").append(C);if(T.sceneList[I].materialList[G].animation!=undefined){R=JSON.parse(T.sceneList[I].materialList[G].animation).length}if(R>0){var r="";for(var J=0;J<R;J++){var v=J+1;r+="<li>动画-"+v+"</li>"}$(".animModal .animModalDrag").eq(G).find(".animTab").empty().append(r);var p="";for(var J=0;J<R;J++){var N=JSON.parse(T.sceneList[I].materialList[G].animation);p+="<li>";p+='<form action="" style="margin:auto 0;">';p+='<div class="form-item"><label for="time">动画持续:</label><input type="text" class="time" name="time" value="'+N[J].animationDuration+'" placeholder="请输入动画时间"/></div>';p+='<div class="form-item"><label for="delay">动画延迟:</label><input type="text" class="delay" name="delay" value="'+N[J].animationDelay+'" placeholder="请输入延迟时间"/></div>';p+='<div class="form-item"><label for="times">动画次数:</label><input type="text" class="times" name="times" value="'+N[J].animationIterationCount+'" placeholder="请输入动画次数"/></div>';p+='<div class="form-item"><label for="method">是否循环:</label><label><input name="animCircle" type="radio" value="infinite" />是 </label> <label><input name="animCircle" type="radio" value=""/>否 </label></div>';p+='<div class="form-item"><label for="method">动画方式:</label><label><input name="animMethod" type="radio" value="fadeIn" />淡入 </label> <label><input name="animMethod" type="radio" value="fadeInRight" />从右移入 </label> <label><input name="animMethod" type="radio" value="fadeInLeft" />从左移入 </label><label><input name="animMethod" type="radio" value="fadeInUp" />从下移入 </label><label><input name="animMethod" type="radio" value="fadeInDown" />从上移入 </label><label><input name="animMethod" type="radio" value="zoomIn" />中心放大</label><label><input name="animMethod" type="radio" value="wobble" />摇摆 </label><label style=""><input name="animMethod" type="radio" value="rotateIn" />旋转 </label><label><input name="animMethod" type="radio" value="swing" />悬摆 </label><label><input name="animMethod" type="radio" value="flipOutY" />翻转消失 </label><label><input name="animMethod" type="radio" value="fadeOut" />淡出 </label> <label><input name="animMethod" type="radio" value="none" />无 </label> </div>';p+="</form>";p+="</li>"}$(".animModal .animModalDrag").eq(G).find(".animCont").empty().append(p);for(var J=0;J<R;J++){if(N[J].animationIterationCount=="infinite"){$(".animModal .animModalDrag").eq(G).find(".animCont li").eq(J).find("input[name=animCircle]").eq(0).get(0).checked=true}else{$(".animModal .animModalDrag").eq(G).find(".animCont li").eq(J).find("input[name=animCircle]").eq(1).get(0).checked=true}var P=$(".animModal .animModalDrag").eq(G).find(".animCont li").eq(J).find("input[name=animMethod]").length;if(N[J].animationName!=undefined){for(var U=0;U<P;U++){if($(".animModal .animModalDrag").eq(G).find(".animCont").eq(J).find("input[name=animMethod]").eq(U).val()==N[J].animationName){$(".animModal .animModalDrag").eq(G).find(".animCont").eq(J).find("input[name=animMethod]").eq(U)[0].checked=true}}}}}draggable($(".animModal .modalHeader"))}}}else{var q="";n+=addContByType(R,q);if(R=="background-image"){var G=$("#nr .editWrapper .editArea").children("li").length;var u=true;for(var K=0;K<G;K++){if($(".editArea").children("li").eq(K).hasClass("background")){$(".editArea").css("background","url("+O+") top center no-repeat");$(".editArea").css("backgroundSize","99.5% 100%");$(".background .materialId").html(M);u=false}}if(u){$(".editArea").append(n);$(".editArea").css("background","url("+O+") top center no-repeat");$(".background .materialId").html(M);$(".editArea").css("backgroundSize","99.5% 100%");$(".bgToggle").show()}}else{if(R=="text"){$(".editArea").append(n);var G=$("#nr .editWrapper .editArea").children("li").length;$("#nr .editWrapper .editArea").children("li").eq(G-1).css({"width":80+"%","height":50,"left":10+"%","top":5+"%",});var L=$("#nr .editWrapper .editArea").children("li").eq(G-1).height();var x=$("#nr .editWrapper .editArea").children("li").eq(G-1).width();$("#nr .editWrapper .editArea").children("li").eq(G-1).find(".elementBox").css({"width":x,"height":L})}else{if(R=="image"){$(".editArea").append(n);var G=$("#nr .editWrapper .editArea").children("li").length;$("#nr .editWrapper .editArea").children("li").eq(G-1).find(".elementBox").attr("src",O);$("#nr .editWrapper .editArea").children("li").eq(G-1).find(".materialId").html(M);var x=$("#nr .editWrapper .editArea").children("li").eq(G-1).width();$("#nr .editWrapper .editArea").children("li").eq(G-1).find(".elementBox").css("width",x)}else{if(R=="video"){$(".editArea").append(n);var G=$("#nr .editWrapper .editArea").children("li").length;$("#nr .editWrapper .editArea").children("li").eq(G-1).find(".elementBox").children("source").attr("src",O);
$("#nr .editWrapper .editArea").children("li").eq(G-1).find(".materialId").html(M)}else{if(R=="music"){var G=$("#nr .editWrapper .editArea").children("li").length;var Q=true;for(var K=0;K<G;K++){if($(".editArea").children("li").eq(K).hasClass("music")){$(".editArea").children("li").eq(K).find("audio").attr("src",O);$(".music .materialId").html(M);Q=false}}if(Q){$(".editArea").append(n);var G=$("#nr .editWrapper .editArea").children("li").length;$(".editArea").children("li").eq(G-1).find("audio").attr("src",O);$(".music .materialId").html(M);$(".musicToggle").show()}$("#audio_btn").show();if($(".editArea").children("li").eq(G-1).find("audio").attr("autoplay")=="autoplay"){$("#audio_btn").removeClass("off").addClass("play_yinfu");$("#yinfu").addClass("rotateMusic")}}else{if(R=="collection"){var G=$("#nr .editWrapper .editArea").children("li").length;var D=true;for(var K=0;K<G;K++){if($(".editArea").children("li").eq(K).hasClass("collection")){swal("对不起，一个页面只能创建一个图集！图集右键可以更改图片切换方式或删除原有图集！");D=false}}if(D){$(".editArea").append(n);var E=O.split(",").length;var A="";$(".collection .materialId").html(M);for(var K=0;K<E;K++){A+='<li style="position:relative;"><a href=""><img src=""  data-description="" /></a></li>'}$(".editArea").children("li").eq(G).find(".html5zoo-slides").append(A);$(".editArea").children("li").eq(G).append("");for(var K=0;K<E;K++){$(".editArea").children("li").eq(G).find(".html5zoo-slides li").eq(K).find("img").attr("src","/static/documentFile/open/"+O.split(",")[K])}variousSlide($(".editArea").children("li").eq(G).attr("id"))}}else{if(R=="input"){var o=O.parent().siblings().find("input[name='inputType']:checked").val();var s=O.parent().siblings().find(".inputName").val();if(o==undefined){$(".inputmsg").show()}else{if($(".inputModalType").html()=="-1"){$(".editArea").append(n);var G=$("#nr .editWrapper .editArea").children("li").length;$("#nr .editWrapper .editArea").children("li").eq(G-1).find("input").attr("type",o);$("#nr .editWrapper .editArea").children("li").eq(G-1).find("input").attr("placeholder",s);$("#nr .editWrapper .editArea").children("li").eq(G-1).css({"width":80+"%","height":50,"left":10+"%","top":5+"%",});var L=$("#nr .editWrapper .editArea").children("li").eq(G-1).height();var x=$("#nr .editWrapper .editArea").children("li").eq(G-1).width();$("#nr .editWrapper .editArea").children("li").eq(G-1).find(".elementBox").css({"width":x,"height":L});$(".inputModal").fadeOut(1000)}else{$("#nr .editWrapper .editArea").children("li").eq($(".inputModalType").html()).find("input").attr("type",o);$("#nr .editWrapper .editArea").children("li").eq($(".inputModalType").html()).find("input").attr("placeholder",s);$(".inputModal").fadeOut(1000);O.parent().siblings().find(".inputName").val("");O.parent().siblings().find("input[name='inputType']:checked").removeAttr("checked")}}}else{if(R=="button"){var V=O.parent().siblings().find(".buttonName").val();if(V==""){$(".buttonmsg").show()}else{if($(".buttonModalType").html()=="-1"){$(".editArea").append(n);var G=$("#nr .editWrapper .editArea").children("li").length;$("#nr .editWrapper .editArea").children("li").eq(G-1).find("button").html(V);$("#nr .editWrapper .editArea").children("li").eq(G-1).css({"width":"80%","height":50,"left":"10%","top":"5%",});var L=$("#nr .editWrapper .editArea").children("li").eq(G-1).height();var x=$("#nr .editWrapper .editArea").children("li").eq(G-1).width();$("#nr .editWrapper .editArea").children("li").eq(G-1).find(".elementBox").css({"width":x,"height":L});$(".buttonModal").fadeOut(1000)}else{$("#nr .editWrapper .editArea").children("li").eq($(".buttonModalType").html()).find("button").html(V);$(".buttonModal").fadeOut(1000)}}}}}}}}}}var G=$("#nr .editWrapper .editArea").children("li").length;for(var K=0;K<G;K++){rotate($("#nr .editWrapper .editArea").children("li").eq(K).find(".bar-rotate"));draggable($("#nr .editWrapper .editArea").children("li").eq(K).find(".draggable").get(0));resizeW($("#nr .editWrapper .editArea").children("li").eq(K).find(".bar-w").children(".bar-radius"));resizeE($("#nr .editWrapper .editArea").children("li").eq(K).find(".bar-e").children(".bar-radius"));resizeN($("#nr .editWrapper .editArea").children("li").eq(K).find(".bar-n").children(".bar-radius"));resizeS($("#nr .editWrapper .editArea").children("li").eq(K).find(".bar-s").children(".bar-radius"))}var C=writeAnimModal();$(".animModal").append(C);draggable($(".animModal .modalHeader"))}if($("#nr .editWrapper .editArea").children("li").length>0){var y=writeToolbar();$(".btn-toolbar").empty().append(y);$(".btn-toolbar").css("position","absolute");$(".btn-toolbar").css("z-index","99");var z=writePopMenu();$("#popMenu").empty().append(z);$("#popMenu").css("position","absolute");$("#popMenu").css("z-index","99");var F=writeStyleModal();$(".styleModal").empty().append(F);draggable($(".styleModal .modalHeader").get(0))}$("body").on("click","#nr .editWrapper .editArea li",function(){$(".bar").css("display","none");$(".bar").children(".bar-radius").css("display","none");
$(this).find(".bar").css("display","block");$(this).find(".bar").children(".bar-radius").css("display","block");$("#popMenu").css("display","none")});$(".style").click(function(){var d=$(this).parent().find(".popIndex").html();var a={};if(parseFloat($(".editArea").children("li").eq(d).find(".elementBox").css("borderWidth"))==0||isNaN(parseFloat($(".editArea").children("li").eq(d).find(".elementBox").css("borderWidth")))){borderWidth=""}else{borderWidth=parseFloat($(".editArea").children("li").eq(d).find(".elementBox").css("borderWidth"))}if(parseFloat($(".editArea").children("li").eq(d).find(".elementBox").css("borderRadius"))==0||isNaN(parseFloat($(".editArea").children("li").eq(d).find(".elementBox").css("borderRadius")))){borderRadius=""}else{borderRadius=parseFloat($(".editArea").children("li").eq(d).find(".elementBox").css("borderRadius"))}a={borderWidth:borderWidth,borderStyle:$(".editArea").children("li").eq(d).find(".elementBox").css("borderStyle"),borderColor:$(".editArea").children("li").eq(d).find(".elementBox").css("borderColor"),borderRadius:borderRadius,backgroundColor:$(".editArea").children("li").eq(d).find(".elementBox").css("backgroundColor"),opacity:$(".editArea").children("li").eq(d).find(".elementBox").css("opacity"),};$(".styleModal").find("#opacity").val(a.opacity);$(".styleModal").find("#borderSize").val(a.borderWidth);$(".styleModal").find("#borderRadius").val(a.borderRadius);$(".styleModal").find("#borderColor").val(a.borderColor);$(".styleModal").find("#color").val(a.backgroundColor);$(".styleModal").find("#color").css("backgroundColor",a.backgroundColor);$(".styleModal").find("#borderColor").css("backgroundColor",a.borderColor);var h=$(".styleModal").find("input[name='borderStyle']");for(var f=0;f<h;f++){if($(".styleModal").find("input[name='borderStyle']").eq(f)==a.borderStyle){$(".styleModal").find("input[name='borderStyle']").eq(f)[0].checked=true}}$(".styleModal").fadeIn(1000);$(".dragIndex").html($(this).parent().find(".popIndex").html());$("#popMenu").hide();$(".animModal").hide();$(".bar").children(".bar-radius").css("display","none");$(".bar").css("display","none");$(".styleModal .submit").click(function(){$(".styleModal").fadeOut(1000)});$(".styleModal .modalFooter .cancel").click(function(){$(".editArea").children("li").eq(d).find(".elementBox").css("borderWidth",a.borderWidth),$(".editArea").children("li").eq(d).find(".elementBox").css("borderStyle",a.borderStyle),$(".editArea").children("li").eq(d).find(".elementBox").css("borderColor",a.borderColor),$(".editArea").children("li").eq(d).find(".elementBox").css("borderRadius",a.borderRadius),$(".editArea").children("li").eq(d).find(".elementBox").css("backgroundColor",a.backgroundColor),$(".editArea").children("li").eq(d).find(".elementBox").css("opacity",a.opacity),$(".styleModal").fadeOut(1000)});$(".styleModal .close").click(function(){$(".editArea").children("li").eq(d).find(".elementBox").css("borderWidth",a.borderWidth),$(".editArea").children("li").eq(d).find(".elementBox").css("borderStyle",a.borderStyle),$(".editArea").children("li").eq(d).find(".elementBox").css("borderColor",a.borderColor),$(".editArea").children("li").eq(d).find(".elementBox").css("borderRadius",a.borderRadius),$(".editArea").children("li").eq(d).find(".elementBox").css("backgroundColor",a.backgroundColor),$(".editArea").children("li").eq(d).find(".elementBox").css("opacity",a.opacity),$(".styleModal").fadeOut(1000)});if($("#picker").length>0){$("#picker").farbtastic(function(j){$("#color").val(j);$("#color").css("backgroundColor",j);$(".editArea").children("li").eq(d).find(".elementBox").css("backgroundColor",j);var i=rgbToHsl(j.colorRgb().split(",")[0],j.colorRgb().split(",")[1],j.colorRgb().split(",")[2])[2]>0.5?"#000":"#fff";$("#color").css("color",i)})}if($("#picker2").length>0){$("#picker2").farbtastic(function(j){$("#borderColor").val(j);$("#borderColor").css("backgroundColor",j);$(".editArea").children("li").eq(d).find(".elementBox").css("borderColor",j);var i=rgbToHsl(j.colorRgb().split(",")[0],j.colorRgb().split(",")[1],j.colorRgb().split(",")[2])[2]>0.5?"#000":"#fff";$("#borderColor").css("color",i)})}});$(".anim").click(function(){var d=$(this).parent().find(".popIndex").html();$(".animModal").fadeIn();$(".animModalDrag").css("display","none");$(".animModalDrag").eq(d).find(".animIndex").html(d);$(".animModalDrag").eq(d).fadeIn(1000);$("#popMenu").hide();$(".styleModal").hide();$(".bar").children(".bar-radius").css("display","none");$(".bar").css("display","none");var h=new Array();var a=$(".animModalDrag").eq(d).find(".animCont").length;for(var f=0;f<a;f++){if($(".animModalDrag").eq(d).find(".animCont").eq(f).find("input[name='animCircle']:checked").val()=="infinite"){animationIterationCount="infinite"}else{animationIterationCount=$(".animModalDrag").eq(d).find(".animCont").eq(f).find(".times").val()}h[f]={animationDuration:$(".animModalDrag").eq(d).find(".animCont").eq(f).find(".time").val(),animationDelay:$(".animModalDrag").eq(d).find(".animCont").eq(f).find(".delay").val(),animationName:$(".animModalDrag").eq(d).find(".animCont").eq(f).find("input[name='animMethod']:checked").val(),animationIterationCount:animationIterationCount,}
}$("body").on("click",".animModal .modalFooter .cancel",function(){var W="";for(var l=0;l<a;l++){var k=l+1;W+="<li>动画-"+k+"</li>"}$(".animModal .animModalDrag").eq(G).find(".animTab").empty().append(W);var w="";for(var l=0;l<a;l++){w+="<li>";w+='<form action="" style="margin:auto 0;">';w+='<div class="form-item"><label for="time">动画持续:</label><input type="text" class="time" name="time" value="" placeholder="请输入动画时间"/></div>';w+='<div class="form-item"><label for="delay">动画延迟:</label><input type="text" class="delay" name="delay" value="" placeholder="请输入延迟时间"/></div>';w+='<div class="form-item"><label for="times">动画次数:</label><input type="text" class="times" name="times" value="" placeholder="请输入动画次数"/></div>';w+='<div class="form-item"><label for="method">是否循环:</label><label><input name="animCircle" type="radio" value="infinite" />是 </label> <label><input name="animCircle" type="radio" value="" />否 </label></div>';w+='<div class="form-item"><label for="method">动画方式:</label><label><input name="animMethod" type="radio" value="fadeIn" />淡入 </label> <label><input name="animMethod" type="radio" value="fadeInRight" />从右移入 </label> <label><input name="animMethod" type="radio" value="fadeInLeft" />从左移入 </label><label><input name="animMethod" type="radio" value="fadeInUp" />从下移入 </label><label><input name="animMethod" type="radio" value="fadeInDown" />从上移入 </label><label><input name="animMethod" type="radio" value="zoomIn" />中心放大</label><label><input name="animMethod" type="radio" value="wobble" />摇摆 </label><label style=""><input name="animMethod" type="radio" value="rotateIn" />旋转 </label><label><input name="animMethod" type="radio" value="swing" />悬摆 </label><label><input name="animMethod" type="radio" value="flipOutY" />翻转消失 </label><label><input name="animMethod" type="radio" value="fadeOut" />淡出 </label> <label><input name="animMethod" type="radio" value="none" />无 </label> </div>';w+="</form>";w+="</li>"}$(".animModal .animModalDrag").eq(d).find(".animCont").empty().append(w);for(var m=0;m<a;m++){$(".animModalDrag").eq(d).find(".animCont").eq(m).find(".time").val(h[m].animationDuration);$(".animModalDrag").eq(d).find(".animCont").eq(m).find(".delay").val(h[m].animationDelay);var X=$(".animModalDrag").eq(d).find(".animCont").eq(m).find("input[name='animMethod']").length;for(var l=0;l<X;l++){if($(".animModalDrag").eq(d).find(".animCont").eq(m).find("input[name='animMethod']").eq(l).val()==h[m].animationName){$(".animModalDrag").eq(d).find(".animCont").eq(m).find("input[name='animMethod']").eq(l)[0].checked=true}}if(h[m].animationIterationCount=="infinite"){$(".animModalDrag").eq(d).find(".animCont").eq(m).find("input[name='animCircle']").eq(0)[0].checked=true;$(".animModalDrag").eq(d).find(".animCont").eq(m).find(".times").val("")}else{$(".animModalDrag").eq(d).find(".animCont").eq(m).find(".times").val(h[m].animationIterationCount)}}$(".animModal").fadeOut(1000)});$("body").on("click",".animModal .modalFooter .submit",function(){$(".animModal").fadeOut(1000)});$("body").on("click",".animModal .close",function(){var W="";for(var l=0;l<a;l++){var k=l+1;W+="<li>动画-"+k+"</li>"}$(".animModal .animModalDrag").eq(G).find(".animTab").empty().append(W);var w="";for(var l=0;l<a;l++){w+="<li>";w+='<form action="" style="margin:auto 0;">';w+='<div class="form-item"><label for="time">动画持续:</label><input type="text" class="time" name="time" value="" placeholder="请输入动画时间"/></div>';w+='<div class="form-item"><label for="delay">动画延迟:</label><input type="text" class="delay" name="delay" value="" placeholder="请输入延迟时间"/></div>';w+='<div class="form-item"><label for="times">动画次数:</label><input type="text" class="times" name="times" value="" placeholder="请输入动画次数"/></div>';w+='<div class="form-item"><label for="method">是否循环:</label><label><input name="animCircle" type="radio" value="infinite" />是 </label> <label><input name="animCircle" type="radio" value=""  />否 </label></div>';w+='<div class="form-item"><label for="method">动画方式:</label><label><input name="animMethod" type="radio" value="fadeIn" />淡入 </label> <label><input name="animMethod" type="radio" value="fadeInRight" />从右移入 </label> <label><input name="animMethod" type="radio" value="fadeInLeft" />从左移入 </label><label><input name="animMethod" type="radio" value="fadeInUp" />从下移入 </label><label><input name="animMethod" type="radio" value="fadeInDown" />从上移入 </label><label><input name="animMethod" type="radio" value="zoomIn" />中心放大</label><label><input name="animMethod" type="radio" value="wobble" />摇摆 </label><label style=""><input name="animMethod" type="radio" value="rotateIn" />旋转 </label><label><input name="animMethod" type="radio" value="swing" />悬摆 </label><label><input name="animMethod" type="radio" value="flipOutY" />翻转消失 </label><label><input name="animMethod" type="radio" value="fadeOut" />淡出 </label> <label><input name="animMethod" type="radio" value="none" />无 </label> </div>';w+="</form>";w+="</li>"}$(".animModal .animModalDrag").eq(d).find(".animCont").empty().append(w);
for(var m=0;m<a;m++){$(".animModalDrag").eq(d).find(".animCont").eq(m).find(".time").val(h[m].animationDuration);$(".animModalDrag").eq(d).find(".animCont").eq(m).find(".delay").val(h[m].animationDelay);var X=$(".animModalDrag").eq(d).find(".animCont").eq(m).find("input[name='animMethod']").length;for(var l=0;l<X;l++){if($(".animModalDrag").eq(d).find(".animCont").eq(m).find("input[name='animMethod']").eq(l).val()==h[m].animationName){$(".animModalDrag").eq(d).find(".animCont").eq(m).find("input[name='animMethod']").eq(l)[0].checked=true}}if(h[m].animationIterationCount=="infinite"){$(".animModalDrag").eq(d).find(".animCont").eq(m).find("input[name='animCircle']").eq(0)[0].checked=true;$(".animModalDrag").eq(d).find(".animCont").eq(m).find(".times").val("")}else{$(".animModalDrag").eq(d).find(".animCont").eq(m).find(".times").val(h[m].animationIterationCount)}}$(".animModal").fadeOut(1000)})});var B;$(".copy").click(function(){var d=$(this).parent().find(".popIndex").html();$("#nr .editWrapper .editArea").children("li").eq(d).clone(false).appendTo("#nr .editWrapper .editArea");$("#popMenu").hide();$(".animModalDrag").eq(d).clone(false).appendTo(".animModal");draggable($(".animModal .modalHeader"));B=$("#nr .editWrapper .editArea").children("li").length;var f=parseInt($("#nr .editWrapper .editArea").children("li").eq(B-1).css("top"));var a=parseInt($("#nr .editWrapper .editArea").children("li").eq(B-1).height());$("#nr .editWrapper .editArea").children("li").eq(B-1).css("top",f+a+5);rotate($("#nr .editWrapper .editArea").children("li").eq(B-1).find(".bar-rotate"));$(".animIndex").eq(B-1).html(B-1);draggable($("#nr .editWrapper .editArea").children("li").eq(B-1).children(".draggable").get(0));resizeW($("#nr .editWrapper .editArea").children("li").eq(B-1).find(".bar-w").children(".bar-radius"));resizeE($("#nr .editWrapper .editArea").children("li").eq(B-1).find(".bar-e").children(".bar-radius"));resizeN($("#nr .editWrapper .editArea").children("li").eq(B-1).find(".bar-n").children(".bar-radius"));resizeS($("#nr .editWrapper .editArea").children("li").eq(B-1).find(".bar-s").children(".bar-radius"))});$(".delete").click(function(){var a=$(this).parent().find(".popIndex").html();swal({title:"您确定要删除选中元素么？",showCancelButton:true,cancelButtonText:"取消",closeOnConfirm:true,confirmButtonText:"确定",confirmButtonColor:"#428bca",},function(){$("#nr .editWrapper .editArea").children("li").eq(a).remove(),$(".animModalDrag").eq(a).remove(),$("#popMenu").hide()});$("#popMenu").hide()});$("#color").on("input",function(){var a=$(".dragIndex").html();$("#nr .editWrapper .editArea").children("li").eq(a).find(".elementBox").css("background",$("#color").val());$("#color").css("background",$("#color").val())});$("#borderColor").on("input",function(){var a=$(".dragIndex").html();$("#nr .editWrapper .editArea").children("li").eq(a).find(".elementBox").css("borderColor",$("#borderColor").val());$("#borderColor").css("background",$("#borderColor").val())});$("input[name='borderStyle']").click(function(){var a=$(".dragIndex").html();$("#nr .editWrapper .editArea").children("li").eq(a).find(".elementBox").css("borderStyle",$(this).val());var d=parseInt($("#nr .editWrapper .editArea").children("li").eq(a).height());$("#nr .editWrapper .editArea").children("li").eq(a).find(".elementBox").css("height",d)});$("body").on("click","input[name='animMethod']",function(){var a=$(this).parents(".animModalDrag").index();$("#nr .editWrapper .editArea").children("li").eq(a).find(".elementBox").css("animation",""),$("#nr .editWrapper .editArea").children("li").eq(a).get(0).offsetWidth=$("#nr .editWrapper .editArea").children("li").eq(a).get(0).offsetWidth,$("#nr .editWrapper .editArea").children("li").eq(a).css("animation",$(this).val()+" "+$(this).parent().parent().siblings().find(".time").val()+"s ease "+$(this).parent().parent().siblings().find(".delay").val()+"s "+($(this).parent().parent().siblings().find(".times").val()?$(this).parent().parent().siblings().find(".times").val():""));if($(this).parent().parent().siblings().find("input[name='animCircle']:checked").val()=="infinite"){$("#nr .editWrapper .editArea").children("li").eq(a).css("animation-iteration-count","infinite")}});$("body").on("click",".seeAnim",function(){var h=$(this).parents(".animModalDrag").index();var d=$(this).siblings(".animCont").children("li").length;var f=$(this).siblings(".animCont").children("li");function i(a){if(a<d){S=f.eq(a).children().children("div");$("#nr .editWrapper .editArea").children("li").eq(h).find(".elementBox").css("animation",""),$("#nr .editWrapper .editArea").children("li").eq(h).get(0).offsetWidth=$("#nr .editWrapper .editArea").children("li").eq(h).get(0).offsetWidth,$("#nr .editWrapper .editArea").children("li").eq(h).find(".elementBox").css("animation",S.eq(4).find("input[name='animMethod']:checked").val()+" "+S.eq(0).find(".time").val()+"s ease "+S.eq(1).find(".delay").val()+"s "+S.eq(2).find(".times").val()).css("animation-fill-mode","backwards");if(S.eq(3).find("input[name='animCircle']:checked").val()=="infinite"){$("#nr .editWrapper .editArea").children("li").eq(h).find(".elementBox").css("animation-iteration-count","infinite")
}$("#nr .editWrapper .editArea").children("li").eq(h).find(".elementBox").one("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",function(){a++,i(a)})}}i(0)});$(".addAnim").click(function(){$(this).siblings(".animTab").find("li").removeClass("current");$(this).siblings(".animCont").find("li").hide();var a=$(this).siblings(".animTab").find("li").length+1;$(this).siblings(".animTab").append('<li class="current">动画-'+a+"</li>");var d="<li>";d+='<form action="" style="margin:auto 0;">';d+='<div class="form-item"><label for="time">动画持续:</label><input type="text" class="time" name="time" value="" placeholder="请输入动画时间"/></div>';d+='<div class="form-item"><label for="delay">动画延迟:</label><input type="text" class="delay" name="delay" value="" placeholder="请输入延迟时间"/></div>';d+='<div class="form-item"><label for="times">动画次数:</label><input type="text" class="times" name="times" value="" placeholder="请输入动画次数"/></div>';d+='<div class="form-item"><label for="method">是否循环:</label><label><input name="animCircle" type="radio" value="infinite" />是 </label> <label><input name="animCircle" type="radio" value=""/>否 </label></div>';d+='<div class="form-item"><label for="method">动画方式:</label><label><input name="animMethod" type="radio" value="fadeIn" />淡入 </label> <label><input name="animMethod" type="radio" value="fadeInRight" />从右移入 </label> <label><input name="animMethod" type="radio" value="fadeInLeft" />从左移入 </label><label><input name="animMethod" type="radio" value="fadeInUp" />从下移入 </label><label><input name="animMethod" type="radio" value="fadeInDown" />从上移入 </label><label><input name="animMethod" type="radio" value="zoomIn" />中心放大</label><label><input name="animMethod" type="radio" value="wobble" />摇摆 </label><label style=""><input name="animMethod" type="radio" value="rotateIn" />旋转 </label><label><input name="animMethod" type="radio" value="swing" />悬摆 </label><label><input name="animMethod" type="radio" value="flipOutY" />翻转消失 </label><label><input name="animMethod" type="radio" value="fadeOut" />淡出 </label> <label><input name="animMethod" type="radio" value="none" />无 </label> </div>';d+="</form>";d+="</li>";$(this).siblings(".animCont").append(d)});$("body").on("click",".animTab li",function(){$(".animTab li").removeClass("current");$(".animCont li").css("display","none");var a=$(this).parent().parent().siblings(".animIndex").html();var d=$(".animModalDrag").eq(a).find(".modalBody .animTab li").index(this);$(this).addClass("current");$(".animModalDrag").eq(a).find(".modalBody .animCont li").eq(d).css("display","block")});$(".bgColor").click(function(){$("#picker").toggleClass("block");$("#picker2").removeClass("block");var a=$(".dragIndex").html();$("#nr .editWrapper .editArea").children("li").eq(a).find(".elementBox").css("background",$("#color").val())});$(".borderColorBtn").click(function(){$("#picker").removeClass("block");$("#picker2").toggleClass("block");var a=$(".dragIndex").html();$("#nr .editWrapper .editArea").children("li").eq(a).find(".elementBox").css("borderColor",$("#borderColor").val())});$("#borderSize").on("input",function(){var a=$(".dragIndex").html();$("#nr .editWrapper .editArea").children("li").eq(a).find(".elementBox").css("borderWidth",$("#borderSize").val());var d=parseInt($("#nr .editWrapper .editArea").children("li").eq(a).height());$("#nr .editWrapper .editArea").children("li").eq(a).find(".elementBox").css("height",d)});$("#borderRadius").on("input",function(){var a=$(".dragIndex").html();$("#nr .editWrapper .editArea").children("li").eq(a).find(".elementBox").css("borderRadius",$("#borderRadius").val()+"px");var d=parseInt($("#nr .editWrapper .editArea").children("li").eq(a).height());$("#nr .editWrapper .editArea").children("li").eq(a).find(".elementBox").css("height",d)});$("#opacity").on("input",function(){var a=$(".dragIndex").html();$("#nr .editWrapper .editArea").children("li").eq(a).find(".elementBox").css("opacity",$("#opacity").val())});$("#nr .editWrapper .editArea").children("li").resize(function(){if(window.getSelection){window.getSelection().removeAllRanges()}else{if(document.selection){document.selection.empty()}}});$("body").on("click","#nr .editWrapper .editArea li",function(){var a=$(this).index()-1;$(".dragIndex").html(a);$(".animModalDrag").css("display","none");$(".animModalDrag").eq(a).css("display","block");$(".inputModalType").html(a);$(".buttonModalType").html(a)});$("body").on("click","#popMenu .edit",function(){var k=$(this).parent().children(".popIndex").html();if($("#nr .editWrapper .editArea").children("li").eq(k).hasClass("text")){$("#nr .editWrapper .editArea").children("li").eq(k).children(".draggable").children(".elementBox").attr("contenteditable","true");$("#nr .editWrapper .editArea").children("li").eq(k).children(".draggable").children(".elementBox").attr("id","editor");$("#nr .editWrapper .editArea").children("li").eq(k).children(".draggable").children(".elementBox").css("cursor","text");if(typeof userSelect==="string"){return document.documentElement.style[userSelect]="text"
}document.unselectable="off";document.onselectstart=null;e=parseInt($("#nr .editWrapper .editArea").children("li").eq(k).css("top"));O=$(".editArea").width();M=parseInt($(".editArea").offset().left);$(".btn-toolbar").css("display","block");$(".btn-toolbar").css("top",e-90);$(".btn-toolbar").css("background","#fff");$(".btn-toolbar").css("box-shadow","+0 1px 2px rgba(0,0,0,.5)+");$(".btn-toolbar").css("left",0);$(".btn-toolbar").css("width",O);$("#nr .editWrapper .editArea").children("li").eq(k).children().children(".elementBox").wysiwyg();var m=$("#nr .editWrapper .editArea").children("li").eq(k).find(".elementBox").height();var a=$("#nr .editWrapper .editArea").children("li").eq(k).find(".elementBox").width();$("#nr .editWrapper .editArea").children("li").eq(k).css({"width":a,"height":m});$("#nr .editWrapper .editArea").children("li").eq(k).children().children(".elementBox").focus();$("#popMenu").css("display","none")}else{if($("#nr .editWrapper .editArea").children("li").eq(k).hasClass("input")){var l=$("#nr .editWrapper .editArea").children("li").eq(k).find("input").attr("type");var W=$("#nr .editWrapper .editArea").children("li").eq(k).find("input").attr("placeholder");$(".inputModal .inputModalType").html(k);for(var f=0;f<2;f++){if($(".inputModal").find("input[name='inputType']").eq(f).val()==l){$(".inputModal").find("input[name='inputType']").eq(f)[0].checked=true}}$(".inputModal").find(".inputName").val(W);$(".inputmsg").hide();$(".inputModal").fadeIn(1000);draggable($(".inputModal .modalHeader"));$("#popMenu").css("display","none")}else{if($("#nr .editWrapper .editArea").children("li").eq(k).hasClass("button")){var d=$("#nr .editWrapper .editArea").children("li").eq(k).find("button").html();$(".buttonModal .buttonModalType").html(k);$(".buttonModal").find(".buttonName").val(d);$(".buttonmsg").hide();$(".buttonModal").fadeIn(1000);draggable($(".buttonModal .modalHeader"));$("#popMenu").css("display","none")}else{if($("#nr .editWrapper .editArea").children("li").eq(k).attr("ctype")=="collection"){$(".collectionModal .collectionModalType").html(k);$(".collectionModal").fadeIn(1000);draggable($(".collectionModal .modalHeader"));$("#popMenu").css("display","none")}}}}});$("body").on("mousedown","#nr .editWrapper .editArea li",function(d){if(d.which==null&&(d.charCode!=null||d.keyCode!=null)){d.which=d.charCode!=null?d.charCode:d.keyCode}G=$(".editWrapper").offset().left;t=$(".editWrapper").offset().top;if(d.which==3){if($(this).children(".draggable").children(".elementBox").attr("contenteditable")!="true"){$("#popMenu").css("display","block");$("#popMenu").css("top",d.pageY-t);$("#popMenu").css("left",d.pageX-G);if($(this).attr("ctype")=="image"){$("#popMenu .edit").hide()}else{$("#popMenu .edit").show()}if($(this).attr("ctype")=="collection"){$("#popMenu .copy").hide()}else{$("#popMenu .copy").show()}var a=$(this).index()-1;$("#popMenu .popIndex").html(a)}$(this).bind("contextmenu",function(f){if($(this).children(".draggable").children(".elementBox").attr("contenteditable")!="true"){return false}else{return true}})}});$(window).resize(function(){O=$(".editArea").width();$(".btn-toolbar").css("width",O)});$("#nr .editWrapper .editArea .phoneContBg").click(function(){$("#nr .editWrapper .editArea li .bar").css("display","none");$(".btn-toolbar").css("display","none");$("#nr .editWrapper .editArea li .bar .bar-radius").css("display","none");$(".elementBox").attr("contenteditable","false");$(".elementBox").attr("id","");$("#popMenu").css("display","none")})}function draggable(f){var d=false;var j,i;var k,h;$(f).mousedown(function(a){if(a.which==1){if($(f).children(".elementBox").attr("contenteditable")!="true"||$(f).children(".elementBox").attr("ctype")=="image"){d=true;if(window.getSelection){window.getSelection().removeAllRanges()}else{if(document.selection){document.selection.empty()}}document.onselectstart=function(){return false}}if($(f).siblings(".bar").length&&$(f).siblings().children(".bar-radius").length!=0){$(".bar").hide();$(".bar").children(".bar-radius").hide();$(f).siblings(".bar").css("display","block");$(f).siblings().children(".bar-radius").css("display","block");j=a.pageX-parseInt($(f).parent().position().left);i=a.pageY-parseInt($(f).parent().position().top)}else{j=a.pageX-$(f).parent().parent().offset().left+$("body").scrollLeft();i=a.pageY-$(f).parent().parent().offset().top+$("body").scrollTop();k=$("body").scrollLeft();h=$("body").scrollTop()}}});$(document).mousemove(function(o){if(d){var r=o.pageX-j;var p=o.pageY-i;if($(f).siblings(".bar").length&&$(f).siblings().children(".bar-radius").length!=0){var s=$(".editArea").width();var m=$(".editArea").height();$(f).children(".elementBox").attr("contenteditable","false");var n=$(f).parent().width();var q=$(f).parent().height();if(r<0){r=0}else{if(r>s-n){r=s-n}}if(p<0){p=0}else{if(p>m-q){p=m-q}}$(f).parent().css({"top":p,"left":r});if($(f).parent().find("img")[0]!=undefined){length=$(f).parent().find("img").length;for(var l=0;l<length;l++){$(f).parent().find("img")[l].ondragstart=imgdragstart
}}}else{if($(f).parent().parent().hasClass("ModalIframe")){var a=$(".ModalIframe").width();var s=$(window).width();var m=$(window).height();var n=$(f).parent().parent().width();var q=$(f).parent().parent().height();if(r<0){r=0}else{if(r>s-n-2){r=s-n-2}}if(p<52){p=52}else{if(p>m-q-36){p=m-q-36}}r=r+0.4*s;$(document).scrollLeft(k);$(document).scrollTop(h);$(f).parent().parent().css({"top":p,"left":r})}else{if($(f).hasClass("modalHeader")){var a=$(".Modal").width();var s=$(window).width();var m=$(window).height();var n=$(f).parent().parent().width();var q=$(f).parent().parent().height();if(r<0){r=0}else{if(r>s-n-2){r=s-n-2}}if(p<52){p=52}else{if(p>m-q-36){p=m-q-36}}r=r+0.1*s;$(document).scrollLeft(k);$(document).scrollTop(h);$(f).parent().parent().css({"top":p,"left":r})}}}$("ul").css("cursor","move");$(f).css("cursor","move")}}).mouseup(function(){d=false;$("ul").css("cursor","auto")})}function rotate(d){var i=false;var h,f;d.mousedown(function(a){i=true;if(window.getSelection){window.getSelection().removeAllRanges()}else{if(document.selection){document.selection.empty()}}document.onselectstart=function(){return false};$(".elementBox").attr("contenteditable","false");$(".btn-toolbar").css("display","none");d.parent().siblings(".draggable").find(".elementBox").attr("id","");h=parseInt(d.parent().css("left"))+$(".editArea").offset().left+d.parent().width()/2;f=parseInt(d.parent().css("top"))+$(".editArea").offset().top+d.parent().height()/2;$("ul").css("cursor",'url(/theme/basic/images/rotateLeft.cur),"defaut"');$(".draggable").css("cursor",'url(/theme/basic/images/rotateLeft.cur),"defaut"')});$(document).mousemove(function(l){if(i){var a=l.pageX;var m=l.pageY;var j=(a-h)/(m-f);c=a-h;g=m-f;var k=Math.atan(Math.abs(j))*360/(2*Math.PI);c>0&&0>g?k=360+k:c>0&&g>0?k=180-k:0>c&&g>0?k=180+k:0>c&&0>g&&(k=360-k),k>360&&(k-=360);d.parent().css({"transform":"rotateZ("+k+"deg)"});d.parent().find(".rotateDeg").html(k)}}).mouseup(function(){i=false;$("ul").css("cursor","auto");$(".draggable").css("cursor","auto")})}function resizeW(i){var l=false;var j;var d;var f;var k;i.mousedown(function(a){l=true;if(window.getSelection){window.getSelection().removeAllRanges()}else{if(document.selection){document.selection.empty()}}document.onselectstart=function(){return false};j=i.parent().parent().find(".elementBox").width();k=i.parent().parent().find(".elementBox").height();if($(i).parent().parent().find("div[class^='html5zoo-swipe-box']").find("img")[0]!=undefined){j=i.parent().parent().find("div[class^='html5zoo-swipe-box']").find("img").eq(0).width();k=i.parent().parent().find("div[class^='html5zoo-swipe-box']").find("img").eq(0).height()}d=parseFloat(i.parent().parent().position().left);f=$(".editArea").width();$(this).parent().parent().find(".bar").css("display","block");$(this).parent().parent().find(".bar").children(".bar-radius").css("display","block");$(".elementBox").attr("contenteditable","false");$(".elementBox").attr("readOnly","true");$(".btn-toolbar").css("display","none");i.parent().siblings(".draggable").find(".elementBox").attr("id","");i.parent().siblings(".draggable").find(".elementBox").css("cursor","move");$("ul").css("cursor","w-resize")});$(document).mousemove(function(n){if(l){if(window.getSelection){window.getSelection().removeAllRanges()}else{if(document.selection){document.selection.empty()}}document.onselectstart=function(){return false};var a=n.pageX-$(".editArea").offset().left;var m=j+d-a;i.parent().parent().css("width",m);i.parent().parent().find(".draggable").css("width",m);i.parent().parent().find(".elementBox").css("width",m);i.parent().parent().css("height",k);i.parent().parent().find(".draggable").css("height",k);i.parent().parent().find(".elementBox").css("height",k);if(i.parent().parent().find("div[class^='html5zoo-swipe-box']").find("img")[0]!=undefined){length=i.parent().parent().find("div[class^='html5zoo-swipe-box']").find("img").length;for(var h=0;h<length;h++){i.parent().parent().find("div[class^='html5zoo-swipe-box']").find("img").eq(h).css("width",m)}i.parent().parent().find("div[class^='html5zoo-img']").find("img").css("width",m);i.parent().parent().find("div[class^='html5zoo-img']").find("img").css("height",k)}i.parent().parent().css("min-width",30);i.parent().parent().find(".elementBox").css("min-width",30);if(m<=30){i.parent().parent().css("width",30);i.parent().parent().find(".elementBox").css("width",30);i.parent().parent().css("left",j+d-30)}else{a>0?i.parent().parent().css("left",a):(i.parent().parent().css("left",0),i.parent().parent().css("width",j+d),i.parent().parent().find(".draggable").css("width",j+d),i.parent().parent().find(".elementBox").css("width",j+d))}$("ul").css("cursor","w-resize")}}).mouseup(function(){l=false;$("ul").css("cursor","auto");$(".elementBox").removeAttr("readOnly")})}function resizeE(i){var j=false;var d;var f;var k;i.mousedown(function(a){j=true;if(window.getSelection){window.getSelection().removeAllRanges()}else{if(document.selection){document.selection.empty()
}}document.onselectstart=function(){return false};d=parseFloat(i.parent().parent().position().left);k=i.parent().parent().find(".elementBox").height();if($(i).parent().parent().find("div[class^='html5zoo-swipe-box']").find("img")[0]!=undefined){}f=$(".editArea").width();$(this).parent().parent().find(".bar").css("display","block");$(this).parent().parent().find(".bar").children(".bar-radius").css("display","block");$(".elementBox").attr("contenteditable","false");$(".elementBox").attr("readOnly","true");$(".btn-toolbar").css("display","none");i.parent().siblings(".draggable").find(".elementBox").attr("id","");i.parent().siblings(".draggable").find(".elementBox").css("cursor","move");$("ul").css("cursor","e-resize")});$(document).mousemove(function(m){if(j){if(window.getSelection){window.getSelection().removeAllRanges()}else{if(document.selection){document.selection.empty()}}document.onselectstart=function(){return false};var a=m.pageX-$(".editArea").offset().left;var l=a-d;i.parent().parent().css("width",l);i.parent().parent().find(".elementBox").css("width",l);i.parent().parent().find(".draggable").css("width",l);i.parent().parent().css("height",k);i.parent().parent().find(".draggable").css("height",k);i.parent().parent().find(".elementBox").css("height",k);if(i.parent().parent().find("div[class^='html5zoo-swipe-box']").find("img")[0]!=undefined){length=i.parent().parent().find("div[class^='html5zoo-swipe-box']").find("img").length;for(var h=0;h<length;h++){i.parent().parent().find("div[class^='html5zoo-swipe-box']").find("img").eq(h).css("width",l);i.parent().parent().find("div[class^='html5zoo-swipe-box']").find("img").eq(h).css("height",k)}i.parent().parent().find("div[class^='html5zoo-img']").find("img").css("width",l);i.parent().parent().find("div[class^='html5zoo-img']").find("img").css("height",k)}i.parent().parent().css("min-width",30);i.parent().parent().find(".elementBox").css("min-width",30);i.parent().parent().css("max-width",f-d);if(l<=30){i.parent().parent().css("width",30);i.parent().parent().find(".elementBox").css("width",30)}else{if(a>=f){i.parent().parent().css("width",f-d);i.parent().parent().find(".elementBox").css("width",f-d)}}$("ul").css("cursor","e-resize")}}).mouseup(function(){j=false;$("ul").css("cursor","auto");$(".elementBox").removeAttr("readOnly")})}function load(){window.document.designMode="On"}function resizeN(f){var k=false;var j;var l;var i;var d;f.mousedown(function(a){k=true;if(window.getSelection){window.getSelection().removeAllRanges()}else{if(document.selection){document.selection.empty()}}document.onselectstart=function(){return false};j=f.parent().parent().height();l=parseFloat(f.parent().parent().position().top);i=$(".editArea").height();d=f.parent().parent().find(".elementBox").width();if($(f).parent().parent().find("div[class^='html5zoo-swipe-box']").find("img")[0]!=undefined){d=f.parent().parent().find("div[class^='html5zoo-swipe-box']").find("img").eq(0).width();j=f.parent().parent().find("div[class^='html5zoo-swipe-box']").find("img").eq(0).height()}$(this).parent().parent().find(".bar").css("display","block");$(this).parent().parent().find(".bar").children(".bar-radius").css("display","block");$(".elementBox").attr("contenteditable","false");$(".elementBox").attr("readOnly","true");$(".btn-toolbar").css("display","none");f.parent().siblings(".draggable").find(".elementBox").attr("id","");f.parent().siblings(".draggable").find(".elementBox").css("cursor","move");$("ul").css("cursor","n-resize")});$(document).mousemove(function(o){if(k){if(window.getSelection){window.getSelection().removeAllRanges()}else{if(document.selection){document.selection.empty()}}document.onselectstart=function(){return false};var a=o.pageY-$(".editArea").offset().top;var n=j+l-a;var m=2*parseInt(f.parent().parent().find(".elementBox").css("borderWidth"));f.parent().parent().css("height",n);f.parent().parent().find(".elementBox").css("height",n);if(f.parent().parent().find("div[class^='html5zoo-swipe-box']").find("img")[0]!=undefined){length=f.parent().parent().find("div[class^='html5zoo-swipe-box']").find("img").length;for(var h=0;h<length;h++){f.parent().parent().find("div[class^='html5zoo-swipe-box']").find("img").eq(h).css("height",n);f.parent().parent().find("div[class^='html5zoo-swipe-box']").find("img").eq(h).css("width",d)}f.parent().parent().find("div[class^='html5zoo-img']").find("img").css("height",n);f.parent().parent().find("div[class^='html5zoo-swipe-box']").find("img").css("width",d)}f.parent().parent().find(".elementBox").css("min-height",30);f.parent().parent().css("min-height",30);f.parent().parent().css("max-height",j+l);if(n<=30){f.parent().parent().find(".elementBox").css("height",30).css("display","block");f.parent().parent().css("height",30);f.parent().parent().css("top",j+l-30)}else{a>0?f.parent().parent().css("top",a):(f.parent().parent().css("top",0),f.parent().parent().css("height",j+l),f.parent().parent().find(".elementBox").css("height",j+l))}$("ul").css("cursor","n-resize")
}}).mouseup(function(){k=false;$("ul").css("cursor","auto");$(".elementBox").removeAttr("readOnly")})}function resizeS(i){var f=false;var k;var j;var d;i.mousedown(function(a){f=true;if(window.getSelection){window.getSelection().removeAllRanges()}else{if(document.selection){document.selection.empty()}}document.onselectstart=function(){return false};k=parseFloat(i.parent().parent().position().top);j=$(".editArea").height();d=i.parent().parent().find(".elementBox").width();if($(i).parent().parent().find("div[class^='html5zoo-swipe-box']").find("img")[0]!=undefined){d=i.parent().parent().find("div[class^='html5zoo-swipe-box']").find("img").eq(0).width()}$(this).parent().parent().find(".bar").css("display","block");$(this).parent().parent().find(".bar").children(".bar-radius").css("display","block");$(".elementBox").attr("contenteditable","false");$(".elementBox").attr("readOnly","true");$(".btn-toolbar").css("display","none");i.parent().siblings(".draggable").find(".elementBox").attr("id","");i.parent().siblings(".draggable").find(".elementBox").css("cursor","move");$("ul").css("cursor","s-resize")});$(document).mousemove(function(n){if(f){if(window.getSelection){window.getSelection().removeAllRanges()}else{if(document.selection){document.selection.empty()}}document.onselectstart=function(){return false};var a=n.pageY-$(".editArea").offset().top;var m=a-k;var l=2*parseInt(i.parent().parent().find(".elementBox").css("borderWidth"));i.parent().parent().css("top",k);i.parent().parent().css("height",m);if(i.parent().parent().find("div[class^='html5zoo-swipe-box']").find("img")[0]!=undefined){length=i.parent().parent().find("div[class^='html5zoo-swipe-box']").find("img").length;for(var h=0;h<length;h++){i.parent().parent().find("div[class^='html5zoo-swipe-box']").find("img").eq(h).css("height",m);i.parent().parent().find("div[class^='html5zoo-swipe-box']").find("img").eq(h).css("width",d)}i.parent().parent().find("div[class^='html5zoo-img']").find("img").css("height",m);i.parent().parent().find("div[class^='html5zoo-swipe-box']").find("img").css("width",d)}i.parent().parent().find(".elementBox").css("height",m);i.parent().parent().find(".elementBox").css("min-height",30);i.parent().parent().css("min-height",30);i.parent().parent().css("max-height",j-k);$("ul").css("cursor","s-resize");if(m<=30){i.parent().parent().find(".elementBox").css("height",30).css("display","block");i.parent().parent().css("height",30)}else{if(j-k<m){i.parent().parent().find(".elementBox").css("height",j-k).css("display","block");i.parent().parent().css("height",j-k)}}}}).mouseup(function(){f=false;$("ul").css("cursor","auto");$(".elementBox").removeAttr("readOnly")})}function writeTxt(){var a="";a+='<li class="rotate resize text" ctype="text" title="拖拽模式右击鼠标出现功能菜单，点击编辑可以进入编辑模式(编辑模式使用工具栏编辑时须选中文字)，点击页面空白处重回拖拽模式">';a+='<div class="bar bar-rotate bar-radius" style="display:none;"  ></div>';a+='<div class="bar bar-line" style="display:none;"  ></div>';a+='<div class="draggable" style="width:100%;height:100%;">';a+='<span class="rotateDeg" style="display:none;"></span>';a+='<div class="elementBox" id="elementBox" style="outline:0;height:100%;width:100%;box-sizing:border-box;" onload="load()">';a+="请输入</div>";a+="</div>";a+='<div class="bar bar-n" style="display:none;" ><div class="bar-radius" style="display:none;" ></div></div>';a+='<div class="bar bar-s"  style="display:none;" ><div class="bar-radius" style="display:none;" ></div></div>';a+='<div class="bar bar-e"  style="display:none;" ><div class="bar-radius" style="display:none;" ></div></div>';a+='<div class="bar bar-w" style="display:none;" ><div class="bar-radius" style="display:none;" ></div></div>';a+='<div class="bar bar-ne bar-radius" style="display:none;"  ></div>';a+='<div class="bar bar-nw bar-radius" style="display:none;" ></div>';a+='<div class="bar bar-se bar-radius"  style="display:none;" ></div>';a+='<div class="bar bar-sw bar-radius"  style="display:none;" ></div>';a+="</li>";return a}function writeBg(){var a="";a+='<li class="background" style="display:none;" ctype="background-image">';a+='<span class="materialId" style="display:none;"></span>';a+="</li>";return a}function writeMusic(){var a="";a+='<li class="music" style="display:none;" ctype="music">';a+='<audio id="music" class="musicAudio" src="" loop="loop"></audio>';a+='<span class="materialId" style="display:none;"></span>';a+="</li>";return a}function writeVideo(){var a="";a+='<li class="video" style="" ctype="video" >';a+='<span class="materialId" style="display:none;"></span>';a+='<span class="rotateDeg" style="display:none;"></span>';a+='<div class="bar bar-rotate bar-radius" style="display:none;"  ></div>';a+='<div class="bar bar-line" style="display:none;"  ></div>';a+='<div class="draggable" style="width:100%;height:100%;">';a+='<video id="my-video" class="video-js elementBox" controls preload="auto" width="100%"   poster="" data-setup="{}" style="margin-left:1.2px;">';a+='<source src="" >';a+="</video>";a+="</div>";
a+='<div class="bar bar-n" style="display:none;" ><div class="bar-radius" style="display:none;" ></div></div>';a+='<div class="bar bar-s"  style="display:none;" ><div class="bar-radius" style="display:none;" ></div></div>';a+='<div class="bar bar-e"  style="display:none;" ><div class="bar-radius" style="display:none;" ></div></div>';a+='<div class="bar bar-w" style="display:none;" ><div class="bar-radius" style="display:none;" ></div></div>';a+='<div class="bar bar-ne bar-radius" style="display:none;"  ></div>';a+='<div class="bar bar-nw bar-radius" style="display:none;" ></div>';a+='<div class="bar bar-se bar-radius"  style="display:none;" ></div>';a+='<div class="bar bar-sw bar-radius"  style="display:none;" ></div>';a+="</li>";return a}function writePic(){var a="";a+='<li class="rotate resize picture"  style="display:block;max-width:100%;" ctype="image" >';a+='<span class="materialId" style="display:none;"></span>';a+='<span class="rotateDeg" style="display:none;"></span>';a+='<div class="bar bar-rotate bar-radius" style="display:none;"  ></div>';a+='<div class="bar bar-line" style="display:none;"  ></div>';a+='<div class="draggable" style="width:100%;height:100%;">';a+='<img class="elementBox" id="elementBox" style="display:block;outline:0;max-width:100%;" src=""/>';a+="</div>";a+='<div class="bar bar-n" style="display:none;" ><div class="bar-radius" style="display:none;" ></div></div>';a+='<div class="bar bar-s"  style="display:none;" ><div class="bar-radius" style="display:none;" ></div></div>';a+='<div class="bar bar-e"  style="display:none;" ><div class="bar-radius" style="display:none;" ></div></div>';a+='<div class="bar bar-w" style="display:none;" ><div class="bar-radius" style="display:none;" ></div></div>';a+='<div class="bar bar-ne bar-radius" style="display:none;"  ></div>';a+='<div class="bar bar-nw bar-radius" style="display:none;" ></div>';a+='<div class="bar bar-se bar-radius"  style="display:none;" ></div>';a+='<div class="bar bar-sw bar-radius"  style="display:none;" ></div>';a+="</li>";return a}function writeCollection(){var a="";a+='<li class="rotate resize collection"  id="slide" style="display:block;" ctype="collection" >';a+='<span class="materialId" style="display:none;"></span>';a+='<span class="rotateDeg" style="display:none;"></span>';a+='<div class="bar bar-rotate bar-radius" style="display:none;"  ></div>';a+='<div class="bar bar-line" style="display:none;"  ></div>';a+='<div class="draggable" style="width:100%;height:100%;">';a+='<div class="elementBox" style="margin:0px auto;">';a+='<div id="html5zoo-1" style="display:block;position:relative;margin:0px auto 60px;">';a+='<ul class="html5zoo-slides" style="display:none;">';a+="</ul>";a+="</div>";a+="</div>";a+="</div>";a+='<div class="bar bar-n" style="display:none;" ><div class="bar-radius" style="display:none;" ></div></div>';a+='<div class="bar bar-s"  style="display:none;" ><div class="bar-radius" style="display:none;" ></div></div>';a+='<div class="bar bar-e"  style="display:none;" ><div class="bar-radius" style="display:none;" ></div></div>';a+='<div class="bar bar-w" style="display:none;" ><div class="bar-radius" style="display:none;" ></div></div>';a+='<div class="bar bar-ne bar-radius" style="display:none;"  ></div>';a+='<div class="bar bar-nw bar-radius" style="display:none;" ></div>';a+='<div class="bar bar-se bar-radius"  style="display:none;" ></div>';a+='<div class="bar bar-sw bar-radius"  style="display:none;" ></div>';a+="</li>";return a}function writeInput(){var a="";a+='<li class="rotate resize input" ctype="input" title="拖拽模式右击鼠标出现功能菜单，点击编辑可以进入编辑模式(编辑模式使用工具栏编辑时须选中文字)，点击页面空白处重回拖拽模式">';a+='<span class="rotateDeg" style="display:none;"></span>';a+='<div class="bar bar-rotate bar-radius" style="display:none;)"  ></div>';a+='<div class="bar bar-line" style="display:none;"  ></div>';a+='<div class="draggable" style="width:100%;height:100%;">';a+='<div class="elementBox" id="elementBox" style="display:block;height:100%;width:100%;outline:0;" >';a+='<input style="display:block;outline:0;height:100%;background:transparent;width:100%;border:none;resize:none;padding-left:10px;"  value=""/>';a+="</div>";a+="</div>";a+='<div class="bar bar-n" style="display:none;" ><div class="bar-radius" style="display:none;" ></div></div>';a+='<div class="bar bar-s"  style="display:none;" ><div class="bar-radius" style="display:none;" ></div></div>';a+='<div class="bar bar-e"  style="display:none;" ><div class="bar-radius" style="display:none;" ></div></div>';a+='<div class="bar bar-w" style="display:none;" ><div class="bar-radius" style="display:none;" ></div></div>';a+='<div class="bar bar-ne bar-radius" style="display:none;"  ></div>';a+='<div class="bar bar-nw bar-radius" style="display:none;" ></div>';a+='<div class="bar bar-se bar-radius"  style="display:none;" ></div>';a+='<div class="bar bar-sw bar-radius"  style="display:none;" ></div>';a+="</li>";return a}function writeButton(){var a="";a+='<li class="rotate resize button" ctype="button" title="拖拽模式右击鼠标出现功能菜单，点击编辑可以进入编辑模式(编辑模式使用工具栏编辑时须选中文字)，点击页面空白处重回拖拽模式">';
a+='<span class="rotateDeg" style="display:none;"></span>';a+='<div class="bar bar-rotate bar-radius" style="display:none;)"  ></div>';a+='<div class="bar bar-line" style="display:none;"  ></div>';a+='<div class="draggable" style="width:100%;height:100%;">';a+='<div class="elementBox" id="elementBox" style="display:block;height:100%;width:100%;outline:0;background:#f1f1f1;">';a+='<button style="display:block;outline:0;height:100%;background:transparent;width:100%;border:none;text-align:center"></button>';a+="</div>";a+="</div>";a+='<div class="bar bar-n" style="display:none;" ><div class="bar-radius" style="display:none;" ></div></div>';a+='<div class="bar bar-s"  style="display:none;" ><div class="bar-radius" style="display:none;" ></div></div>';a+='<div class="bar bar-e"  style="display:none;" ><div class="bar-radius" style="display:none;" ></div></div>';a+='<div class="bar bar-w" style="display:none;" ><div class="bar-radius" style="display:none;" ></div></div>';a+='<div class="bar bar-ne bar-radius" style="display:none;"  ></div>';a+='<div class="bar bar-nw bar-radius" style="display:none;" ></div>';a+='<div class="bar bar-se bar-radius"  style="display:none;" ></div>';a+='<div class="bar bar-sw bar-radius"  style="display:none;" ></div>';a+="</li>";return a}function writeToolbar(){var i=["#000000","#7e2412","#ff5400","#225801","#0c529e","#333333","#b61b52","#f4711f","#3bbc1e","#23a3d3","#888888","#d34141","#f7951e","#29b16a","#97daf3","#cccccc","#ec7c7c","#fdea02","#79c450","#563679","#ffffff","#ffcccc","#d9ef7f","#c3f649"];var f="";f+='<div class="btn-group">';f+='<a class="btn dropdown-toggle" data-toggle="dropdown" title="文字颜色"><i class="glyphicon glyphicon-font color-btn"></i><b class="caret"></b></a>';f+='<ul class="dropdown-menu color-menu">';for(var d=0;d<i.length;d++){f+='<li><a dropdown-toggle class="btn" data-edit="foreColor '+i[d]+'" style="background-color: '+i[d]+'"></a></li>'}f+="</ul>";f+="</div>";f+='<div class="btn-group">';f+='<a class="btn dropdown-toggle" data-toggle="dropdown" title="字体大小"><i class="icon-text-height"></i>&nbsp;<b class="caret"></b></a>';f+='<ul class="dropdown-menu">';f+='<li><a data-edit="fontSize 5"><font size="5">Huge</font></a></li>';f+='<li><a data-edit="fontSize 3"><font size="3">Normal</font></a></li>';f+='<li><a data-edit="fontSize 1"><font size="1">Small</font></a></li>';f+="</ul>";f+=" </div>";f+=' <div class="btn-group">';f+=' <a class="btn" data-edit="bold" title="加粗(Ctrl/Cmd+B)"><i class="icon-bold"></i></a>';f+="</div>";f+=' <div class="btn-group">';f+=' <a class="btn" data-edit="italic" title="斜体(Ctrl/Cmd+I)"><i class="icon-italic"></i></a>';f+="</div>";f+=' <div class="btn-group">';f+='<a class="btn" data-edit="underline" title="下划线(Ctrl/Cmd+U)"><i class="icon-underline"></i></a>';f+="</div>";f+='<div class="btn-group">';f+=' <a class="btn" data-edit="justifyleft" title="左对齐(Ctrl/Cmd+L)"><i class="icon-align-left"></i></a>';f+='<a class="btn" data-edit="justifycenter" title="居中(Ctrl/Cmd+E)"><i class="icon-align-center"></i></a>';f+='<a class="btn" data-edit="justifyright" title="右对齐(Ctrl/Cmd+R)"><i class="icon-align-right"></i></a>';f+="</div>";f+='<div class="btn-group">';f+='<a class="btn dropdown-toggle" data-toggle="dropdown" title="Hyperlink"><i class="icon-link"></i></a>';f+='<div class="dropdown-menu input-append" style="overflow:hidden;text-align:center;">';f+='<input class="span2" placeholder="URL" type="text" data-edit="createLink" style="width:90%;" />';f+='<button class="btn" type="button" style="float:right;margin-right:5px;">增加</button>';f+="</div>";f+='<a class="btn" data-edit="unlink" title="Remove Hyperlink"><i class="icon-cut"></i></a>';f+="</div>";return f}function writePopMenu(){var a="";a+='<li class="edit" role="presentation"><a role="menuitem" tabindex="-1"><div class="glyphicon glyphicon-edit" style="color: #08a1ef;"></div>&nbsp;&nbsp;编辑</a></li>';a+='<li class="style" role="presentation"><a role="menuitem" "tabindex="-1"><div class="fa fa-pencil" style="color: #08a1ef;"></div>&nbsp;&nbsp;样式</a></li>';a+='<li class="anim" role="presentation"><a role="menuitem" tabindex="-1"><div class="fa fa-video-camera" style="color: #08a1ef;"></div>&nbsp;&nbsp;动画</a></li>';a+='<li class="copy" role="presentation"><a role="menuitem" tabindex="-1"><div class="fa fa-copy" style="color: #08a1ef;"></div>&nbsp;&nbsp;复制</a></li>';a+='<li class="delete" role="presentation"><a role="menuitem" tabindex="-1"><div class="glyphicon glyphicon-trash" style="color: #08a1ef;"></div>&nbsp;&nbsp;删除</a></li>';a+='<div class="popIndex" style="display:none;"></div>';return a}function writeStyleModal(){var a="";a+='<div class="modalDrag">';a+='<div class=dragIndex style="display:none;"></div>';a+='<div class="modalHeader">';a+='<a class="close" >×</a>';a+="<span>样式</span>";a+="</div>";a+='<div class="modalBody">';a+='<form action="" style="margin:auto 0;">';a+='<div class="form-item"><label for="opacity">&nbsp;&nbsp;&nbsp;&nbsp;透明度:</label><input type="text" id="opacity" name="opacity" value="" placeholder="请输入0-1的透明度值"/></div>';
a+='<div class="form-item"><label for="borderSize">边框尺寸:</label><input type="text" id="borderSize" name="borderSize" value="" placeholder="请输入0-20的边框值（单位px）"/></div>';a+='<div class="form-item"><label for="borderRadius">边框弧度:</label><input type="text" id="borderRadius" name="borderRadius" value="" placeholder="请输入一定量的圆角边框值（单位px）"/></div>';a+='<div class="form-item"><label for="borderStyle">边框类型:</label><label><input name="borderStyle" type="radio" value="solid" />实心 </label> <label><input name="borderStyle" type="radio" value="dashed" />虚线 </label> <label><input name="borderStyle" type="radio" value="dotted" />点线</label><label><input name="borderStyle" type="radio" value="none" />空 </label> </div>';a+='<div class="form-item"><label for="borderColor">边框颜色:</label><input type="text" id="borderColor" name="borderColor" value="#222" /><div class="chooseBtn borderColorBtn">取色</div></div>';a+='<div id="picker2" class="hidePicker"></div>';a+='<div class="form-item"><label for="color">背景颜色:</label><input type="text" id="color" name="color" value="#fff" /><div class="chooseBtn bgColor">取色</div></div>';a+='<div id="picker" class="hidePicker"></div>';a+="<p>注：字体颜色在双击元素后编辑模式的工具栏里调。</p>";a+="</form>";a+="</div>";a+='<div class="modalFooter">';a+='<a href=javascript:void(0); class="btn submit">确定</a>';a+='<a href=javascript:void(0); class="btn cancel">取消</a>';a+="</div>";a+="</div>";return a}function writeAnimModal(){var a="";a+='<div class="modalDrag animModalDrag" style="display:none;">';a+='<div class=animIndex style="display:none;"></div>';a+='<div class="modalHeader">';a+='<a class="close" >×</a>';a+="<span>动画</span>";a+="</div>";a+='<div class="modalBody">';a+='<ul class="animTab">';a+='<li class="current">动画-1</li>';a+="</ul>";a+='<ul class="animCont">';a+="<li>";a+='<form action="" style="margin:auto 0;">';a+='<div class="form-item"><label for="time">动画持续:</label><input type="text" class="time" name="time" value="" placeholder="请输入动画时间"/></div>';a+='<div class="form-item"><label for="delay">动画延迟:</label><input type="text" class="delay" name="delay" value="" placeholder="请输入延迟时间"/></div>';a+='<div class="form-item"><label for="times">动画次数:</label><input type="text" class="times" name="times" value="" placeholder="请输入动画次数"/></div>';a+='<div class="form-item"><label for="method">是否循环:</label><label><input name="animCircle" type="radio" value="infinite" />是 </label> <label><input name="animCircle" type="radio" value=""  />否 </label></div>';a+='<div class="form-item"><label for="method">动画方式:</label><label><input name="animMethod" type="radio" value="fadeIn" />淡入 </label> <label><input name="animMethod" type="radio" value="fadeInRight" />从右移入 </label> <label><input name="animMethod" type="radio" value="fadeInLeft" />从左移入 </label><label><input name="animMethod" type="radio" value="fadeInUp" />从下移入 </label><label><input name="animMethod" type="radio" value="fadeInDown" />从上移入 </label><label><input name="animMethod" type="radio" value="zoomIn" />中心放大</label><label><input name="animMethod" type="radio" value="wobble" />摇摆 </label><label style=""><input name="animMethod" type="radio" value="rotateIn" />旋转 </label><label><input name="animMethod" type="radio" value="swing" />悬摆 </label><label><input name="animMethod" type="radio" value="flipOutY" />翻转消失 </label><label><input name="animMethod" type="radio" value="fadeOut" />淡出 </label> <label><input name="animMethod" type="radio" value="none" />无 </label> </div>';a+="</form>";a+="</li>";a+="</ul>";a+='<a href=javascript:void(0); class="btn seeAnim">预览动画</a>';a+='<a href=javascript:void(0); class="btn addAnim">增加动画</a>';a+='<div style="clear:both"></div>';a+='<p align="justify">注：请先选好动画参数，点击相应动画方式（预览当前元素当前动画）或预览动画（预览当前元素全部动画）。</p>';a+="</div>";a+='<div class="modalFooter">';a+='<a href=javascript:void(0); class="btn submit">确定</a>';a+='<a href=javascript:void(0); class="btn cancel">取消</a>';a+="</div>";a+="</div>";return a}function addContByType(f,d){var h="";switch(f){case"text":h+=writeTxt();break;case"background-image":h+=writeBg();break;case"music":h+=writeMusic();break;case"image":h+=writePic();break;case"input":h+=writeInput();break;case"button":h+=writeButton();break;case"video":h+=writeVideo();break;case"collection":h+=writeCollection();break;default:}return h}$(function(){$("#text").click(function(){changePhoneCont(0,0,"text",1,"");var h=$(".editWrapper .editArea").find(".currentEditArea").index();$(".rightBody .pagin li").eq(h).addClass("currentPage")});var d=$(".ModalIframe .modalHeader").height();var a=$(".ModalIframe .modalFooter").height();var f=$(".ModalIframe").height();$(".ModalIframe .modalBody").css("height",0.9*f-a-d);$(window).resize(function(){var i=$(".ModalIframe .modalHeader").height();var h=$(".ModalIframe .modalFooter").height();var j=$(".ModalIframe").height();$(".ModalIframe .modalBody").css("height",0.9*j-h-i)});$("#bgd").click(function(){$(".Modal").hide();$(".ModalIframe").hide();$(".bgdCont").html('<iframe   src="/materialModel.shtml?materialType=background-image&display=mini"  frameborder=0 id="iframeBg">');
$(".bgdModal").fadeIn(1000);$("#popMenu").hide();draggable($(".bgdModal .modalHeader"))});$(".bgdModal .modalFooter .submit").click(function(){var i=$("#iframeBg")[0].contentWindow.$("#checkedCont").html();var h=$("#iframeBg")[0].contentWindow.$("#materialId").html();$(".editArea").css("backgroundSize","99.5% 100%");$(".bgToggle").show();changePhoneCont(0,0,"background-image",1,i,h);$(".bgdModal").fadeOut(1000)});$(".bgdModal .modalFooter .cancel").click(function(){$(".bgdModal").fadeOut(1000)});$(".bgdModal .modalHeader .close").click(function(){$(".bgdModal").fadeOut(1000)});$("#picture").click(function(){$(".Modal").hide();$(".ModalIframe").hide();$(".picCont").html('<iframe   src="/materialModel.shtml?materialType=image&display=mini"  frameborder=0 id="iframePic">');$(".picModal").fadeIn(1000);$("#popMenu").hide();draggable($(".picModal .modalHeader"))});$(".picModal .modalFooter .submit").click(function(){var i=$("#iframePic")[0].contentWindow.$("#checkedCont").html();var h=$("#iframePic")[0].contentWindow.$("#materialId").html();changePhoneCont(0,0,"image",1,i,h);$(".picModal").fadeOut(1000)});$(".picModal .modalFooter .cancel").click(function(){$(".picModal").fadeOut(1000)});$(".picModal .modalHeader .close").click(function(){$(".picModal").fadeOut(1000)});$("#video").click(function(){$(".Modal").hide();$(".ModalIframe").hide();$(".videoCont").html('<iframe   src="/materialModel.shtml?materialType=video&display=mini"  frameborder=0 id="iframeVideo">');$(".videoModal").fadeIn(1000);$("#popMenu").hide();draggable($(".videoModal .modalHeader"))});$(".videoModal .modalFooter .submit").click(function(){var i=$("#iframeVideo")[0].contentWindow.$("#checkedCont").html();var h=$("#iframeVideo")[0].contentWindow.$("#materialId").html();changePhoneCont(0,0,"video",1,i,h);$(".videoModal").fadeOut(1000)});$(".videoModal .modalFooter .cancel").click(function(){$(".videoModal").fadeOut(1000)});$(".videoModal .modalHeader .close").click(function(){$(".videoModal").fadeOut(1000)});$("#music").click(function(){$(".Modal").hide();$(".ModalIframe").hide();$(".musicCont").html('<iframe   src="/materialModel.shtml?materialType=music&display=mini"  frameborder=0 id="iframeMusic">');$(".musicModal").fadeIn(1000);$("#popMenu").hide();draggable($(".musicModal .modalHeader"))});$(".musicModal .modalFooter .submit").click(function(){var i=$("#iframeMusic")[0].contentWindow.$("#checkedCont").html();var h=$("#iframeMusic")[0].contentWindow.$("#materialId").html();changePhoneCont(0,0,"music",1,i,h);$(".musicModal").fadeOut(1000)});$(".musicModal .modalFooter .cancel").click(function(){$(".musicModal").fadeOut(1000)});$(".musicModal .modalHeader .close").click(function(){$(".musicModal").fadeOut(1000)});$("#pics").click(function(){$(".Modal").hide();$(".ModalIframe").hide();$(".colCont").html('<iframe   src="/materialModel.shtml?materialType=collection&display=mini"  frameborder=0 id="iframeCollection">');$(".colModal").fadeIn(1000);$("#popMenu").hide();draggable($(".colModal .modalHeader"))});$(".colModal .modalFooter .submit").click(function(){var i=$("#iframeCollection")[0].contentWindow.$("#checkedCont").html();var h=$("#iframeCollection")[0].contentWindow.$("#materialId").html();changePhoneCont(0,0,"collection",1,i,h);$(".colModal").fadeOut(1000)});$(".colModal .modalFooter .cancel").click(function(){$(".colModal").fadeOut(1000)});$(".colModal .modalHeader .close").click(function(){$(".colModal").fadeOut(1000)});$("#input").click(function(){$(".Modal").hide();$(".ModalIframe").hide();$(".inputModalType").html("-1");$(".inputModal").find(".inputName").val("");$(".inputModal").find("input[name='inputType']:checked").removeAttr("checked");$(".inputmsg").hide();$(".inputModal").fadeIn(1000);$("#popMenu").hide();draggable($(".inputModal .modalHeader"))});$(".inputModal .modalFooter .submit").click(function(){changePhoneCont(0,0,"input",1,$(".inputModal .modalFooter .submit"));var h=$(".editWrapper .editArea").find(".currentEditArea").index();$(".rightBody .pagin li").eq(h).addClass("currentPage")});$(".inputModal .modalFooter .cancel").click(function(){$(".inputModal").fadeOut(1000)});$(".inputModal .modalHeader .close").click(function(){$(".inputModal").fadeOut(1000)});$(".inputModal").find("input[name='inputType']").click(function(){$(".inputmsg").hide()});$("#button").click(function(){$(".Modal").hide();$(".ModalIframe").hide();$(".buttonModalType").html("-1");$(".buttonModal").find(".buttonName").val("");$(".buttonmsg").hide();$(".buttonModal").fadeIn(1000);$("#popMenu").hide();draggable($(".buttonModal .modalHeader"))});$(".buttonModal .modalFooter .submit").click(function(){changePhoneCont(0,0,"button",1,$(".buttonModal .modalFooter .submit"));var h=$(".editWrapper .editArea").find(".currentEditArea").index();$(".rightBody .pagin li").eq(h).addClass("currentPage")});$(".buttonModal").find(".buttonName").on("input",function(){$(".buttonmsg").hide()});$(".buttonModal .modalFooter .cancel").click(function(){$(".buttonModal").fadeOut(1000)
});$(".buttonModal .modalHeader .close").click(function(){$(".buttonModal").fadeOut(1000)});$(".collectionModal .modalFooter .submit").click(function(){if($(".collectionModalType").html()!="-1"){var h=$("input[name='collectionType']:checked").val();if(h==undefined){$(".collectionmsg").show()}else{$(".editArea").children("li").eq($(".collectionModalType").html()).attr("id",h);variousSlide($(".editArea").children("li").eq($(".collectionModalType").html()).attr("id"));$(".collectionModal").fadeOut(1000)}}});$(".collectionModal").find(".buttonName").on("input",function(){$(".collectionmsg").hide()});$(".collectionModal .modalFooter .cancel").click(function(){$(".collectionModal").fadeOut(1000)});$(".collectionModal .modalHeader .close").click(function(){$(".collectionModal").fadeOut(1000)});$(".bgToggle a").click(function(){$(".editWrapper ul").css("backgroundImage","none");closeBgToggle()});$(".musicToggle a").click(function(){$(".musicAudio").remove();$("#audio_btn").hide();$(".musicToggle").hide()});$("#save").click(function(){var C=new String();var y=new Array();scene={currentStatus:100001,materialList:y,title:"",background:"",tags:new Array(),sceneId:parseInt($(".sceneId").val()),};var A=$(".editWrapper .editArea").children("li").length;scene.title=$(".sceneName").val();var q=$(".dowebok input:checked").length;for(var G=0;G<q;G++){scene.tags[G]=$(".dowebok input:checked")[G].value}if($(".otherTagName").val()!=""){scene.tags[q]=$(".otherTagName").val()}for(var F=0;F<A;F++){scene.materialList[F]={css:new String(),cssExt:new String(),materialType:$(".editWrapper ul").children("li").eq(F).attr("ctype"),materialModelId:$(".editWrapper ul").children("li").eq(F).children(".materialId").html(),content:"",id:F+1,index:F,animation:new Array(),};if(scene.materialList[F].materialType=="background-image"){var J=$(".editWrapper ul").css("backgroundImage").split("/");var E=J.length;var J=J[E-1];scene.background=J.split(")")[0].split('"')[0]}else{if(scene.materialList[F].materialType=="text"){scene.materialList[F].content=base64encode(utf16to8($(".editWrapper ul").children("li").eq(F).find(".elementBox").html()))}else{if(scene.materialList[F].materialType=="button"){scene.materialList[F].content=$(".editWrapper ul").children("li").eq(F).find("button").html()}else{if(scene.materialList[F].materialType=="input"){scene.materialList[F].content=JSON.stringify({type:$(".editWrapper ul").children("li").eq(F).find("input").attr("type"),placeholder:$(".editWrapper ul").children("li").eq(F).find("input").attr("placeholder")})}else{if(scene.materialList[F].materialType=="image"){scene.materialList[F].content=$(".editWrapper ul").children("li").eq(F).find("img").attr("src")}else{if(scene.materialList[F].materialType=="music"){scene.materialList[F].content=$(".editWrapper ul").children("li").eq(F).find("audio").attr("src")}else{if(scene.materialList[F].materialType=="video"){scene.materialList[F].content=$(".editWrapper ul").children("li").eq(F).find("source").attr("src")}else{if(scene.materialList[F].materialType=="collection"){var u=$(".editWrapper ul").children("li").eq(F).find(".html5zoo-slides img").length;var p=$(".editWrapper ul").children("li").eq(F).find(".html5zoo-slides img").eq(0).attr("src");for(var D=1;D<u;D++){p+=","+$(".editWrapper ul").children("li").eq(F).find(".html5zoo-slides img").eq(D).attr("src")}var I="";if($(".editWrapper ul").children("li").eq(F).attr("id")!=undefined){I=$(".editWrapper ul").children("li").eq(F).attr("id")}scene.materialList[F].content=JSON.stringify({src:p,colType:I})}}}}}}}}var H=$(".editWrapper ul").height();var r=$(".editWrapper ul").width();var x=$(".editWrapper ul").children("li").eq(F).height();var z=$(".editWrapper ul").children("li").eq(F).width();var o=$(".editWrapper ul").children("li").eq(F).position().left;var v=$(".editWrapper ul").children("li").eq(F).position().top;if(hasPercent(o)){o=o}else{o=(Math.round(parseInt(o)*100/r)+"%")}if(hasPercent(v)){v=v}else{v=(Math.round(parseInt(v)*100/H)+"%")}if(hasPercent(x)){x=x}else{x=(Math.round(x*100/H)+"%")}if(hasPercent(z)){z=z}else{z=(Math.round(z*100/r)+"%")}var n=$(".editWrapper ul").children("li").eq(F).find(".elementBox").css("borderRadius");if(n!=undefined){if(hasRem(n)){n=n}else{n=parseInt(n)*10/r+"rem"}}scene.materialList[F].css="left:"+o+";top:"+v+";height:"+x+";width:"+z+";transform:rotateZ("+$(".editWrapper ul").children("li").eq(F).find(".rotateDeg").html()+"deg);";scene.materialList[F].cssExt="border-width:"+$(".editWrapper ul").children("li").eq(F).find(".elementBox").css("borderTopWidth")+";border-style:"+$(".editWrapper ul").children("li").eq(F).find(".elementBox").css("borderTopStyle")+";border-color:"+removeSpace($(".editWrapper ul").children("li").eq(F).find(".elementBox").css("borderTopColor"))+";border-radius:"+n+";background-color:"+removeSpace($(".editWrapper ul").children("li").eq(F).find(".elementBox").css("backgroundColor"))+";opacity:"+$(".editWrapper ul").children("li").eq(F).find(".elementBox").css("opacity")+";";
var B=$(".animModal").children(".animModalDrag").eq(F).find(".animCont li").length;for(var D=0;D<B;D++){scene.materialList[F].animation[D]={animationName:$(".animModal").children(".animModalDrag").eq(F).find(".animCont li").eq(D).find("input[name=animMethod]:checked").val(),animationDuration:$(".animModal").children(".animModalDrag").eq(F).find(".animCont li").eq(D).find(".time").val(),animationDelay:$(".animModal").children(".animModalDrag").eq(F).find(".animCont li").eq(D).find(".delay").val(),animationIterationCount:null,};if($(".animModal").children(".animModalDrag").eq(F).find(".animCont li").eq(D).find("input[name=animCircle]:checked").val()=="infinite"){scene.materialList[F].animation[D].animationIterationCount="infinite"}else{scene.materialList[F].animation[D].animationIterationCount=$(".animModal").children(".animModalDrag").eq(F).find(".animCont li").eq(D).find(".times").val()}}scene.materialList[F].animation=JSON.stringify(scene.materialList[F].animation)}if(scene.tags.length==0){swal({confirmButtonColor:"#428bca",title:"请选择或输入标签类型！",showCancelButton:false,closeOnConfirm:true,confirmButtonText:"确定",confirmButtonColor:"#428bca",})}else{if(scene.title==""){swal({confirmButtonColor:"#428bca",title:"请输入场景名称！",showCancelButton:false,closeOnConfirm:true,confirmButtonText:"确定",confirmButtonColor:"#428bca",})}else{if($(".sceneId").val()==0){$.ajax({type:"POST",url:"/scene/create.json",data:JSON.stringify(scene),contentType:"application/json; charset=utf-8",dataType:"json",success:function(h){swal("新增成功！["+h.scene.sceneId+"]");$(".sceneId").val(h.scene.sceneId)},})}else{$.ajax({type:"POST",url:"/scene/update.json",data:JSON.stringify(scene),contentType:"application/json; charset=utf-8",dataType:"json",success:function(h){swal("更新成功！["+h.scene.sceneId+"]")},})}}}});$(".previewAll").click(function(){var i=$(".animModal").find(".animModalDrag").length;for(var l=0;l<i;l++){var h=$(".animModal").find(".animModalDrag").eq(l).find(".animCont li").length;function k(n,m){if(n<h){b=$(".animModal").find(".animModalDrag").eq(m).find(".animCont li").eq(n).children().children("div");$("#nr .editWrapper .editArea").children("li").eq(m).find(".elementBox").css("animation",""),$("#nr .editWrapper .editArea").children("li").eq(0).get(0).offsetWidth=$("#nr .editWrapper .editArea").children("li").eq(0).get(0).offsetWidth,$("#nr .editWrapper .editArea").children("li").eq(m).find(".elementBox").css("animation",b.eq(4).find("input[name='animMethod']:checked").val()+" "+b.eq(0).find(".time").val()+"s ease "+b.eq(1).find(".delay").val()+"s "+b.eq(2).find(".times").val()).css("animation-fill-mode","backwards");if(b.eq(3).find("input[name='animCircle']:checked").val()=="infinite"){$("#nr .editWrapper .editArea").children("li").eq(m).find(".elementBox").css("animation-iteration-count","infinite")}$("#nr .editWrapper .editArea").children("li").eq(m).find(".elementBox").one("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",function(){n++,k(n,m)})}}k(0,l)}});$("#audio_btn").click(function(){var h=$(".musicAudio").get(0);if($("#audio_btn").hasClass("off")){h.play();$("#audio_btn").removeClass("off").addClass("play_yinfu");$("#yinfu").addClass("rotateMusic")}else{h.pause();$("#audio_btn").addClass("off").removeClass("play_yinfu");$("#yinfu").removeClass("rotateMusic")}})});function hasPercent(f){var a=/%+/;var d;if(a.test(f)){d=true}else{d=false}return d}function hasRem(a){var f="rem";var d;if(a.indexOf(f)>0){d=true}else{d=false}return d}function closeBgToggle(){var a=$(".editWrapper .editArea").length;var f=0;for(var d=0;d<a;d++){if($(".editWrapper .editArea").eq(d).css("backgroundImage")!="none"){f++}}if(f>0){$(".bgToggle").css("display","block")}else{$(".bgToggle").hide()}}function changePagination(){var a=$(".editWrapper .editArea").length;var d="";for(var f=0;f<a;f++){var h=f+1;d+="<li>第"+h+"页</li>"}$(".rightBody .pagin").empty().append(d)}function addPage(){$("editWrapper ul").removeClass("currentEditArea");$(".editWrapper").append('<ul class="editArea currentEditArea" style="overflow:hidden; position:relative;width:100%;height:100%;">'+'<div class="phoneContBg" style="position:absolute;width:100%;height:100%;z-index:1;opacity:0;"></div>'+"</ul>");changePagination();var a=$(".editWrapper .editArea").find(".currentEditArea").index();$(".rightBody .pagin li").eq(a).addClass("currentPage")}function copyPage(){$(".editWrapper").find(".currentEditArea").clone(false).appendTo(".editWrapper");changePagination();$("editWrapper ul").removeClass("currentEditArea");var a=$(".editWrapper .editArea").length;$("editWrapper ul").eq(a-1).addClass("currentEditArea");var d=$(".editWrapper .editArea").find(".currentEditArea").index();$(".rightBody .pagin li").eq(d).addClass("currentPage")}function refreshAnimModal(h,f,i,d){}$("a").bind("focus",function(){if(this.blur){this.blur()}});function rgbToHsl(a,k,n){a/=255,k/=255,n/=255;var o=Math.max(a,k,n),i=Math.min(a,k,n);var j,p,f=(o+i)/2;if(o==i){j=p=0}else{var m=o-i;p=f>0.5?m/(2-o-i):m/(o+i);
switch(o){case a:j=(k-n)/m+(k<n?6:0);break;case k:j=(n-a)/m+2;break;case n:j=(a-k)/m+4;break}j/=6}return[j,p,f]}function zero_fill_hex(a,f){var d=a.toString(16);while(d.length<f){d="0"+d}return d}function rgb2hex(d){if(d.charAt(0)=="#"){return d}var f=d.split(/\D+/);var a=Number(f[1])*65536+Number(f[2])*256+Number(f[3]);if(d!="rgb(0, 0, 0, 0)"){return"#"+zero_fill_hex(a,6)}else{return"transparent"}}function removeSpace(h){if(h==""||h==undefined){return h}h=h.split(" ");var a=h.length;var f="";for(var d=0;d<a;d++){f+=h[d]}return f}function html_encode(d){var a="";if(d.length==0){return""}a=d.replace(/&/g,"&gt;");a=a.replace(/</g,"&lt;");a=a.replace(/>/g,"&gt;");a=a.replace(/ /g,"&nbsp;");a=a.replace(/\'/g,"&#39;");a=a.replace(/\"/g,"&quot;");a=a.replace(/\n/g,"<br>");return a}function html_decode(d){var a="";if(d.length==0){return""}a=d.replace(/&gt;/g,"&");a=a.replace(/&lt;/g,"<");a=a.replace(/&gt;/g,">");a=a.replace(/&nbsp;/g," ");a=a.replace(/&#39;/g,"'");a=a.replace(/&quot;/g,'"');a=a.replace(/<br>/g,"\n");return a}var base64EncodeChars="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";var base64DecodeChars=new Array(-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,-1,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,-1,-1,-1,-1,-1);function base64encode(l){var f,j,a;var k,h,d;a=l.length;j=0;f="";while(j<a){k=l.charCodeAt(j++)&255;if(j==a){f+=base64EncodeChars.charAt(k>>2);f+=base64EncodeChars.charAt((k&3)<<4);f+="==";break}h=l.charCodeAt(j++);if(j==a){f+=base64EncodeChars.charAt(k>>2);f+=base64EncodeChars.charAt(((k&3)<<4)|((h&240)>>4));f+=base64EncodeChars.charAt((h&15)<<2);f+="=";break}d=l.charCodeAt(j++);f+=base64EncodeChars.charAt(k>>2);f+=base64EncodeChars.charAt(((k&3)<<4)|((h&240)>>4));f+=base64EncodeChars.charAt(((h&15)<<2)|((d&192)>>6));f+=base64EncodeChars.charAt(d&63)}return f}function base64decode(m){var l,k,h,d;var j,a,f;a=m.length;j=0;f="";while(j<a){do{l=base64DecodeChars[m.charCodeAt(j++)&255]}while(j<a&&l==-1);if(l==-1){break}do{k=base64DecodeChars[m.charCodeAt(j++)&255]}while(j<a&&k==-1);if(k==-1){break}f+=String.fromCharCode((l<<2)|((k&48)>>4));do{h=m.charCodeAt(j++)&255;if(h==61){return f}h=base64DecodeChars[h]}while(j<a&&h==-1);if(h==-1){break}f+=String.fromCharCode(((k&15)<<4)|((h&60)>>2));do{d=m.charCodeAt(j++)&255;if(d==61){return f}d=base64DecodeChars[d]}while(j<a&&d==-1);if(d==-1){break}f+=String.fromCharCode(((h&3)<<6)|d)}return f}function utf16to8(h){var d,f,a,j;d="";a=h.length;for(f=0;f<a;f++){j=h.charCodeAt(f);if((j>=1)&&(j<=127)){d+=h.charAt(f)}else{if(j>2047){d+=String.fromCharCode(224|((j>>12)&15));d+=String.fromCharCode(128|((j>>6)&63));d+=String.fromCharCode(128|((j>>0)&63))}else{d+=String.fromCharCode(192|((j>>6)&31));d+=String.fromCharCode(128|((j>>0)&63))}}}return d}function utf8to16(k){var d,h,a,l;var j,f;d="";a=k.length;h=0;while(h<a){l=k.charCodeAt(h++);switch(l>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:d+=k.charAt(h-1);break;case 12:case 13:j=k.charCodeAt(h++);d+=String.fromCharCode(((l&31)<<6)|(j&63));break;case 14:j=k.charCodeAt(h++);f=k.charCodeAt(h++);d+=String.fromCharCode(((l&15)<<12)|((j&63)<<6)|((f&63)<<0));break}}return d};