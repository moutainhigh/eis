$(document).ready(function(){jQuery.validator.addMethod("mobile",function(e,r){var s=/^1[3|4|5|7|8]\d{9}$/;return this.optional(r)||s.test(e)},"手机格式不对"),$("#member_upForm").validate({rules:{username:{required:!0,mobile:!0,remote:{url:"/user/exist.json",type:"POST",dataType:"json",data:{username:function(){return $("#member_upForm input[id=username]").val()}}}},oldPassword:{required:!0,minlength:6,maxlength:16},newPassword:{required:!0,minlength:6,maxlength:16},newPassword2:{required:!0,minlength:6,maxlength:16,equalTo:"#newPassword"}},messages:{username:{required:"请输入用户名",remote:"没有这个用户!"},oldPassword:{required:"请输入密码",minlength:"密码不能小于6个字符",maxlength:"密码不能大于16个字符"},newPassword:{required:"请再输入新密码",minlength:"新密码不能小于6个字符",maxlength:"新密码不能大于16个字符"},newPassword2:{required:"请再输入新密码",minlength:"新密码不能小于6个字符",maxlength:"新密码不能大于16个字符",equalTo:"两次输入密码不一致"}},errorPlacement:function(e,r){e.insertAfter(r.parent("p"))},success:function(e){e.addClass("valid").text("")},submitHandler:function(){$.ajax({type:"POST",url:"/usr/update/security.json",data:{username:$("#member_upForm input[id=username]").val(),oldPassword:$("#member_upForm input[id=oldPassword]").val(),newPassword:$("#member_upForm input[id=newPassword]").val(),newPassword2:$("#member_upForm input[id=newPassword2]").val()},async:!1,dataType:"json",success:function(e){return e.message.operateCode!=operateResultSuccess?(alert(e.message.message),!1):(alert(e.message.message),void(location.href="/content/user/login.shtml"))},error:function(){alert("系统繁忙,请稍后再试")}})}})});