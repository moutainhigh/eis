var errorNoRelatedNode = 500001,
errorNoWorkflow = 500002,
errorObjectNotEditable = 500003,
errorObjectIsNull = 500004,
errorAuthFailed = 500005,
errorAccessDenied = 500006,
errorUnsupportedFileName = 500008,
errorBillAlreadyExist = 500009,
errorChargeToAccountNotExist = 500010,
errorBillUpdateFailed = 500011,
errorMoneyUpdateFailed = 500012,
errorDataUpdateFailed = 500013,
errorVersionUnSupported = 500014,
errorUnknownError = 500015,
errorVerifyError = 500016,
errorCanNotParseObject = 500017,
errorObjectAlreadyExist = 500018,
errorAccountLocked = 500019,
errorParentAccountLocked = 500020,
errorBillCreateFailed = 500021,
errorBillNotExist = 500022,
errorDataFormatError = 500023,
errorAccountError = 500024,
errorAccountNotExist = 500025,
errorMoneyRangeError = 500026,
errorActiveSignNotFound = 500027,
errorMailBindSignNotFound = 500028,
errorPhoneBindSignNotFound = 500029,
errorFindPasswordSignNotFound = 500030,
errorUserNotFoundInSession = 500031,
errorRequiredDataNotFound = 500032,
errorSystemInMaintenance = 500033,
errorSystemUpgrade = 500034,
errorBillDuplicate = 500035,
errorDataError = 500036,
errorNoMatchedPrivilege = 500037,
errorFlowWorkRouteCountError = 500038,
errorChargeToPeerError = 500039,
errorPaySuccessButChargeToPeerError = 500040,
errorMailAlreadyBinded = 500041,
errorUserNotFoundInRequest = 500042,
errorMailBindSignNotFoundInRequest = 500043,
errorMailBindSignNotFoundInSystem = 500044,
errorMailBindSignNotMatch = 500045,
errorDataUniqueConflict = 500046,
errorDataGlobalUniqueConflict = 500047,
errorFindPasswordSignNotFoundInSystem = 500048,
errorTransactionObjectNotMatch = 500049,
errorMoneyAccountNotExist = 500050,
errorMoneyNotEnough = 500051,
errorCartIsNull = 500052,
errorCartIsEmpty = 500053,
errorTransactionProcessorNotFound = 500053,
errorAddToCartFail = 500054,
errorPayMethodIsNull = 500055,
errorPayProcessorIsNull = 500056,
errorSupplierNotFound = 500057,
errorUserNotFoundInSystem = 500058,
errorDataVerifyFail = 500059,
activityClosed = 500072,
activityMissedShot = 500073,
activityLimited = 500074,
captchaTimeOut = 500086,
transSuccess = 710010,
transFailed = 710011,
transCompleted = 710012,
transInProcess = 710013,
transCompletedPaySuccessChargeFailed = 710014,
transCompletedButUpdateFailed = 710015,
transCompletedPaySuccessChargeNotProcess = 710016,
transTimeout = 710017,
transInCart = 710018,
transWaitingPay = 710019,
transCartHalfComplete = 710020,
transNewOrder = 710021,
operateResultAccept = 102005,
operateResultDeny = 102006,
operateResultFailed = 102007,
operateResultSuccess = 102008,
operateStatusNew = 102009,
operateJump = 102124,
authSuccess = 175001,
userFromSuggest = 120005,
systemName = "以先",
loginUrl = "/user/login",
registerSubmitUrl = "/user/register",
userHost = "",
payHost = "",
apiHost = "",
suffix = ".shtml";
var Cookie = {
    setCookie: function(e, r, o, t, n) {
        document.cookie = e + "=" + escape(r) + (o ? ";expires=" + o.toGMTString() : "") + (t ? ";path=" + t: "") + (n ? ";domain=" + n: "")
    },
    getCookie: function(e) {
        var r = document.cookie.match(new RegExp("(^| )" + e + "=([^;]*)(;|$)"));
        return null != r ? decodeURIComponent(r[2]).replace(/^\"|\"$/g, "") : null
    },
    delCookie: function(e) {
        var r, o = new Date;
        o.setTime(o.getTime() - 1e4);
        var t = document.domain,
        n = new Array;
        n = t.split("."),
        n.length >= 3 && "com" != n[1] ? (n.splice(0, 1), r = n.join(".")) : r = t,
        this.setCookie(e, Cookie.getCookie(e), o, "/", r),
        this.setCookie("eis_passport_f", Cookie.getCookie("eis_passport_f"), o, "/", r)
    }
};
$(document).ready(function() {
	init();
    $(".dhed").click(function() {
        null != Cookie.getCookie("eis_username") ? location.href = "/content/user/pcenter.shtml": (location.href = "/content/user/login.shtml", Cookie.delCookie("eis_username"))
    });
	// $("#headerInput").focus(function(){
		// location.href="/content/default/20170726115149.shtml";
	// });
	$("#hanbao").click(function(){
		$("#erweimaCode").toggle();
	});
	$(".list_hot .addToCart").click(function(e){
		e.preventDefault(); 
		$.ajax({
            type:"POST",
            url:"/buy/add.json",
            data:{
                productCode:$(this).parent().find("#productCode").val(),
                count:1
            },
            dataType:'json',
            success:function (data) {
                switch (data.message.operateCode) {                 
                    case operateResultSuccess:
                        malert(data.message.message+"",1000);
						//location.reload();
						break
                    case errorUserNotFoundInRequest:
					case errorUserNotFoundInSession:
                        malert(data.message.message+"",1000);
                        location.href='/content/user/login.shtml';
                        break;
					default:
						malert(data.message.message+"",1000);
                }				
            },
            error:function (data) {
                malert("系统繁忙,请稍后再试","1000");
                return false;
            }
        });
	})
	$(".productList li a .addToCart").click(function(e){
		e.preventDefault(); 
		$.ajax({
            type:"POST",
            url:"/buy/add.json",
            data:{
                productCode:$(this).parent().find("#productCode").val(),
                count:1
            },
            dataType:'json',
            success:function (data) {
                switch (data.message.operateCode) {                 
                    case operateResultSuccess:
                        malert(data.message.message+"",1000);
						//location.reload();
						break
                    case errorUserNotFoundInRequest:
					case errorUserNotFoundInSession:
                        malert(data.message.message+"",1000);
                        location.href='/content/user/login.shtml';
                        break;
					default:
						malert(data.message.message+"",1000);
                }				
            },
            error:function (data) {
                malert("系统繁忙,请稍后再试",1000);
                return false;
            }
        });
	})
});
function init(){
	decodeURI(Cookie.getCookie("eis_username"));
	$("img.lazy").lazyload({
		effect: "fadeIn"
	});
	var iWidth = document.documentElement.clientWidth;
	document.getElementsByTagName('html')[0].style.fontSize = iWidth/10+'px';
	$(window).resize(function(){
		var iWidth = document.documentElement.clientWidth;
		document.getElementsByTagName('html')[0].style.fontSize = iWidth/10+'px';
	})	
	placeholderSupport() || $("[placeholder]").focus(function() {
        var e = $(this);
        e.val() == e.attr("placeholder") && (e.val(""), e.css("color", "#f9e6bf"), e.css("height", "40px"), e.css("line-height", "40px"), e.removeClass("placeholder"))
    }).blur(function() {
        var e = $(this); ("" == e.val() || e.val() == e.attr("placeholder")) && (e.addClass("placeholder"), e.css("color", "#f9e6bf"), e.css("height", "40px"), e.css("line-height", "40px"), e.val(e.attr("placeholder")))
    }).blur();
}
var JsonUti = {
    n: "\n",
    t: "	",
    convertToString: function(e) {
        return JsonUti.__writeObj(e, 1)
    },
    __writeObj: function(e, r, o) {
        if (null == e) return "null";
        if (e.constructor == Number || e.constructor == Date || e.constructor == String || e.constructor == Boolean) {
            var t = e.toString(),
            n = o ? JsonUti.__repeatStr(JsonUti.t, r - 1) : "";
            return e.constructor == String || e.constructor == Date ? n + ('"' + t + '"') : e.constructor == Boolean ? n + t.toLowerCase() : n + t
        }
        var s = [];
        for (var a in e) {
            var i = [],
            u = JsonUti.__repeatStr(JsonUti.t, r);
            i.push(u),
            i.push(a + " : ");
            var l = e[a];
            if (null == l) i.push("null");
            else {
                var c = l.constructor;
                if (c == Array) {
                    i.push(JsonUti.n + u + "[" + JsonUti.n);
                    for (var d = r + 2,
                    p = [], g = 0; g < l.length; g++) p.push(JsonUti.__writeObj(l[g], d, !0));
                    i.push(p.join("," + JsonUti.n)),
                    i.push(JsonUti.n + u + "]")
                } else i.push(c == Function ? "[Function]": JsonUti.__writeObj(l, r + 1))
            }
            s.push(i.join(""))
        }
        return (r > 1 && !o ? JsonUti.n: "") + JsonUti.__repeatStr(JsonUti.t, r - 1) + "{" + JsonUti.n + s.join("," + JsonUti.n) + JsonUti.n + JsonUti.__repeatStr(JsonUti.t, r - 1) + "}"
    },
    __isArray: function(e) {
        return e ? e.constructor == Array: !1
    },
    __repeatStr: function(e, r) {
        var o = [];
        if (r > 0) for (var t = 0; r > t; t++) o.push(e);
        return o.join("")
    }
};
function UrlDecode(str) {
    var ret = "";
    for (var i = 0; i < str.length; i++) {
        var chr = str.charAt(i);
        if (chr == "+") {
            ret += " ";
        } else if (chr == "%") {
            var asc = str.substring(i + 1, i + 3);
            if (parseInt("0x" + asc) > 0x7f) {
                ret += asc2str(parseInt("0x" + asc + str.substring(i + 4, i + 6)));
                i += 5;
            } else {
                ret += asc2str(parseInt("0x" + asc));
                i += 2;
            }
        } else {
            ret += chr;
        }
    }
    return ret;
}
function str2asc(str) {
    return str.charCodeAt(0).toString(16);
}
function asc2str(str) {
    return String.fromCharCode(str);
}
function logout() {
    $.ajax({
        type: "GET",
        url: "/user/logout.json",
        success: function() {
            setTimeout("location.href='/content/user/login.shtml'", "1000")
        },
        error: function(e) {

}
    });
}
function collection(objectId) {
    if (Cookie.getCookie("eis_username") == null) {
        alert("您还没有登录");
        location.href = "/content/user/login.shtml";
    } else {
        $.ajax({
            type: "POST",
            url: '/userRelation/add.json',
            data: {
                objectId: objectId,
                objectType: 'document',
                relationType: 'favorite',
            },
            dataType: 'json',
            success: function(data) {
                switch (data.message.operateCode) {
                case 102008:
                    location.reload();
                    break;
                default:
                    alert(data.message.message);
                }
            },
            error: function(data) {
                alert("系统繁忙,请稍后再试");
                return false;
            }
        });
    }
}
function uncollection(objectId) {
    if (Cookie.getCookie("eis_username") == null) {
        alert("您还没有登录");
        location.href = "/content/user/login.shtml";
    } else {
        $.ajax({
            type: "POST",
            url: '/userRelation/delete.json',
            data: {
                objectId: objectId,
                objectType: 'document',
                relationType: 'favorite',
            },
            dataType: 'json',
            success: function(data) {
                switch (data.message.operateCode) {
                case 102008:
                    location.reload();
                    break;
                default:
                    alert(data.message.message);
                }
            },
            error: function(data) {
                alert("系统繁忙,请稍后再试");
                return false;
            }
        });
    }
}
function like(objectId) {
    if (Cookie.getCookie("eis_username") == null) {
        alert("您还没有登录");
        location.href = "/content/user/login.shtml";
    } else {
        $.ajax({
            type: "POST",
            url: '/userRelation/add.json',
            data: {
                objectId: objectId,
                objectType: 'document',
                relationType: 'praise',
            },
            dataType: 'json',
            success: function(data) {
                switch (data.message.operateCode) {
                case 102008:
                    location.reload();
                    break;
                default:
                    alert(data.message.message);
                }
            },
            error: function(data) {
                alert("系统繁忙,请稍后再试");
                return false;
            }
        });
    }
}
function unlike(objectId) {
    if (Cookie.getCookie("eis_username") == null) {
        alert("您还没有登录");
        location.href = "/content/user/login.shtml";
    } else {
        $.ajax({
            type: "POST",
            url: '/userRelation/delete.json',
            data: {
                objectId: objectId,
                objectType: 'document',
                relationType: 'praise',
            },
            dataType: 'json',
            success: function(data) {
                switch (data.message.operateCode) {
                case 102008:
                    location.reload();
                    break;
                default:
                    alert(data.message.message);
                }
            },
            error: function(data) {
                alert("系统繁忙,请稍后再试");
                return false;
            }
        });
    }
}
function publishSubmit() {
    if (Cookie.getCookie("eis_username") == null) {
        alert("您还没有登录");
        location.href = "/content/user/login.shtml";
    } else {
        $.ajax({
            type: "POST",
            url: '/comment/submit.json',
            data: {
                objectType: "document",
                objectId: $("#udid").val(),
                content: $("#suggestContent").val()
            },
            dataType: 'json',
            success: function(data) {
                if (data.message.operateCode == 102008) {
                    alert("评论成功");
                    window.location.reload();
                } else if (data.message.operateCode == 102007) {
                    alert("您已评论过了，无需再次评论");
                }

            },
            error: function(XMLResponse) {
                alert("操作失败:" + XMLResponse.responseText);
            },
        });
    }
}

function testUrl(testkey) {
    var t = "";
    var url = window.location.search;
    if (url.indexOf("?") != -1) {
        var str = url.substr(1),strs = str.split("&");
        var key = new Array(strs.length);
        var value = new Array(strs.length);
        for (i = 0; i < strs.length; i++) {
            key[i] = strs[i].split("=")[0];
			value[i] = unescape(strs[i].split("=")[1]);
            if (key[i] == testkey) {
                t = value[i];
            }
        }
    }
    return t;
}
function goBack() {
    var e = $("#detail").val();
    switch (isWeiXin()) {
    case ! 0 : history.length > 0 && ("detail" != e ? history.back() : location.href = "/");
        break;
    case ! 1 : history.length > 0 ? history.back() : location.href = "/"
    }
}
function isWeiXin() {
    var e = window.navigator.userAgent.toLowerCase();
    return "micromessenger" == e.match(/MicroMessenger/i) ? !0 : !1
}
function getUrlParam(e) {
    var r = new RegExp("(^|&)" + e + "=([^&]*)(&|$)"),
    o = window.location.search.substr(1).match(r);
    return null != o ? unescape(o[2]) : null
}
function placeholderSupport() {
    return "placeholder" in document.createElement("input")
}
function checkPrice(e) {
    return /^(([1-9]\d*)|\d)(\.\d{1,2})?$/.test(e.toString())
}
function getByteVal(e, r) {
    var o = "",
    t = 0;
    if (null != e && "" != e) {
        for (var n = 0; n < e.length; n++) {
            var s = e.charAt(n);
            if (t += null != s.match(/[^x00-xff]/gi) ? 2 : 1, t > r) break;
            o += s
        }
        return t > r ? o.substring(0, o.length - 1) + "..": o
    }
    return ""
}
function AutoResizeImage(e, r, o) {
    var t = new Image;
    t.src = o.src;
    var n, s, a = 1,
    i = t.width,
    u = t.height;
    s = e / i,
    n = r / u,
    0 == e && 0 == r ? a = 1 : 0 == e ? 1 > n && (a = n) : 0 == r ? 1 > s && (a = s) : (1 > s || 1 > n) && (a = n >= s ? s: n),
    1 > a && (i *= a, u *= a),
    o.height = u,
    o.width = i
}
function subString(e, r, o) {
    for (var t = 0,
    n = "",
    s = /[^\x00-\xff]/g,
    a = "",
    i = e.replace(s, "**").length, u = 0; i > u && (a = e.charAt(u).toString(), null != a.match(s) ? t += 2 : t++, !(t > r)); u++) n += a;
    return o && i > r && (n += "..."),
    n
}
// function collection(e) {
//     null == Cookie.getCookie("eis_username") ? location.href = "/content/user/login.shtml": $.ajax({
//         type: "POST",
//         url: "/user/favorites.json",
//         data: {
//             documentCode: e
//         },
//         dataType: "json",
//         success: function(e) {
//             switch (e.message.operateCode) {
//             case 0:
//                 $("#fav").attr("class", "nofav"),
//                 history.back();
//                 break;
//             case 1:
//                 $("#fav").attr("class", "fav"),
//                 history.back()
//             }
//         },
//         error: function() {
//             return jAlert("系统繁忙,请稍后再试", "提示信息"),
//             !1
//         }
//     })
// }
function loginuser() {
    $.ajax({
        type: "POST",
        url: userHost + "/user/login.json",
        data: {
            username: $("#Useral input[id=username]").val(),
            userPassword: $("#Useral input[id=userPassword]").val(),
            userRememberName: $("#Useral input[id=userRememberName]").val()
        },
        dataType: "json",
        success: function(e) {
            $(".notifyOk").fadeIn(1e3,
            function() {
                $(".notifyOk").text(e.message.message)
            }),
            e.message.operateCode == operateResultSuccess ? ($(".notifyOk").text("登录成功"), window.location.reload()) : ($(".notifyOk").show(), $(".notifyOk").text(e.message.message))
        },
        error: function() {
            return jAlert("系统繁忙,请稍后再试", "提示信息"),
            !1
        }
    })
}
function login() {
    $.ajax({
        type: "POST",
        url: userHost + "/user/login.json?randID=" + parseInt(1e6 * Math.random()),
        data: {
            username: $("#regLogTab0 input[id=username]").val(),
            userPassword: $("#regLogTab0 input[id=userPassword]").val(),
            userRememberName: $("#regLogTab0 input[id=userRememberName]").val()
        },
        dataType: "json",
        success: function(e) {
            if ($("#loginOk").text(e.message.message), $("#loginOk").show(), e.message.operateCode != operateResultSuccess && ui.error(e.message.message, 3), e.message.operateCode == operateResultSuccess) {
                $(".notifyOk").text("登录成功"),
                ui.success("登录成功", 3),
                setTimeout(function() {
                    window.location.href = "/"
                },
                500),
                htmladd = "",
                noplay = "",
                e.recentServer = "",
                e.suggestServer = ""
            }
        },
        error: function() {
            return jAlert("系统繁忙,请稍后再试", "提示信息"),
            !1
        }
    })
}
function loginClient() {
    return null == $(".login input[id=username]").val() || "" == $(".login input[id=username]").val() ? (ui.error("请输入用户名", 2), !1) : null == $(".login input[id=userPassword]").val() || "" == $(".login input[id=userPassword]").val() ? (ui.error("请输入密码", 2), !1) : void $.ajax({
        type: "POST",
        url: userHost + "/user/login.json?randID=" + parseInt(1e6 * Math.random()),
        data: {
            username: $(".login input[id=username]").val(),
            userPassword: $(".login input[id=userPassword]").val()
        },
        dataType: "json",
        success: function(e) {
            e.message.operateCode != operateResultSuccess && ui.error(e.message.message, 2),
            e.message.operateCode == operateResultSuccess && ($(".notifyOk").text("登录成功"), ui.success("登录成功", 3), setTimeout(function() {
                window.location.href = "miniServer.shtml"
            },
            500))
        },
        error: function() {
            return jAlert("系统繁忙,请稍后再试", "提示信息"),
            !1
        }
    })
}
function showList(){
	$("footer #footer-btn-group").toggle();
}
function malert(str,time){
	this.str=str;
	this.div='<div class="msg">'+this.str+'</div>';
	$("body").append(this.div);
	setTimeout(function(){
		$(".msg").remove();
	},time)
}
function MLoading(){
	this.load='<div class="loading"></div>';
	$("body").append(this.load);
}
MLoading.prototype.beRemoved=function(){
	$('.loading').remove();
}
var _hmt = _hmt || []; (function() {
    var hm = document.createElement("script");
    hm.src = "https://hm.baidu.com/hm.js?d2a1a610189ccada91fa1fca8472cddb";
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(hm, s);
})();